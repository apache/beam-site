

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>apache_beam.dataframe.frames module &mdash; Apache Beam 2.60.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/documentation_options.js?v=1bc0be70"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="apache_beam.dataframe.io module" href="apache_beam.dataframe.io.html" />
    <link rel="prev" title="apache_beam.dataframe.frame_base module" href="apache_beam.dataframe.frame_base.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Apache Beam
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="apache_beam.coders.html">apache_beam.coders package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="apache_beam.dataframe.html">apache_beam.dataframe package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="apache_beam.dataframe.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.convert.html">apache_beam.dataframe.convert module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.doctests.html">apache_beam.dataframe.doctests module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.expressions.html">apache_beam.dataframe.expressions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.frame_base.html">apache_beam.dataframe.frame_base module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">apache_beam.dataframe.frames module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries"><code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame"><code class="docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.io.html">apache_beam.dataframe.io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.pandas_top_level_functions.html">apache_beam.dataframe.pandas_top_level_functions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.partitionings.html">apache_beam.dataframe.partitionings module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.schemas.html">apache_beam.dataframe.schemas module</a></li>
<li class="toctree-l3"><a class="reference internal" href="apache_beam.dataframe.transforms.html">apache_beam.dataframe.transforms module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.io.html">apache_beam.io package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.metrics.html">apache_beam.metrics package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.ml.html">apache_beam.ml package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.options.html">apache_beam.options package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.portability.html">apache_beam.portability package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.runners.html">apache_beam.runners package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.testing.html">apache_beam.testing package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.transforms.html">apache_beam.transforms package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.typehints.html">apache_beam.typehints package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.utils.html">apache_beam.utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.yaml.html">apache_beam.yaml package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.error.html">apache_beam.error module</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.pipeline.html">apache_beam.pipeline module</a></li>
<li class="toctree-l1"><a class="reference internal" href="apache_beam.pvalue.html">apache_beam.pvalue module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Apache Beam</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="apache_beam.dataframe.html">apache_beam.dataframe package</a></li>
      <li class="breadcrumb-item active">apache_beam.dataframe.frames module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/apache_beam.dataframe.frames.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-apache_beam.dataframe.frames">
<span id="apache-beam-dataframe-frames-module"></span><h1>apache_beam.dataframe.frames module<a class="headerlink" href="#module-apache_beam.dataframe.frames" title="Link to this heading">¶</a></h1>
<p>Analogs for <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> and <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Series</span></code></a>:
<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code></a> and <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a>.</p>
<p>These classes are effectively wrappers around a <a class="reference external" href="https://beam.apache.org/documentation/programming-guide/#what-is-a-schema">schema-aware</a>
<a class="reference internal" href="apache_beam.pvalue.html#apache_beam.pvalue.PCollection" title="apache_beam.pvalue.PCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCollection</span></code></a> that provide a set of operations
compatible with the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> API.</p>
<p>Note that we aim for the Beam DataFrame API to be completely compatible with
the pandas API, but there are some features that are currently unimplemented
for various reasons. Pay particular attention to the <strong>‘Differences from
pandas’</strong> section for each operation to understand where we diverge.</p>
<dl class="py class">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apache_beam.dataframe.frames.</span></span><span class="sig-name descname"><span class="pre">DeferredSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredDataFrameOrSeries</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.name" title="Link to this definition">¶</a></dt>
<dd><p>Return the name of the Series.</p>
<p>The name of a Series becomes its index or column name if it is used
to form a DataFrame. It is also used whenever displaying the Series
using the interpreter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the DeferredSeries, also the column name if part of a DeferredDataFrame.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>label (hashable object)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rename" title="apache_beam.dataframe.frames.DeferredSeries.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rename</span></code></a></dt><dd><p>Sets the DeferredSeries name when given a scalar input.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.name</span></code></dt><dd><p>Corresponding Index property.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">The Series name can be set initially when calling the constructor.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Numbers&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">Name: Numbers, dtype: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Integers&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">Name: Integers, dtype: int64</span>

<span class="go">The name of a Series within a DataFrame is its column name.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Odd Numbers&quot;</span><span class="p">,</span> <span class="s2">&quot;Even Numbers&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   Odd Numbers  Even Numbers</span>
<span class="go">0            1             2</span>
<span class="go">1            3             4</span>
<span class="go">2            5             6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Even Numbers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;Even Numbers&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.hasnans">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hasnans</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.hasnans" title="Link to this definition">¶</a></dt>
<dd><p>Return True if there are any NaNs.</p>
<p>Enables various performance speedups.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1.0</span>
<span class="go">1    2.0</span>
<span class="go">2    3.0</span>
<span class="go">3    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">hasnans</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.dtype" title="Link to this definition">¶</a></dt>
<dd><p>Return the dtype object of the underlying data.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;int64&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtypes</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.dtypes" title="Link to this definition">¶</a></dt>
<dd><p>Return the dtype object of the underlying data.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;int64&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.keys" title="Link to this definition">¶</a></dt>
<dd><p>Return alias for index.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Index of the DeferredSeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index">Index</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">Index([0, 1, 2], dtype=&#39;int64&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.T">
<span class="sig-name descname"><span class="pre">T</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.T" title="Link to this definition">¶</a></dt>
<dd><p>Return the transpose, which is by definition self.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">For Series:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Ant&#39;</span><span class="p">,</span> <span class="s1">&#39;Bear&#39;</span><span class="p">,</span> <span class="s1">&#39;Cow&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0     Ant</span>
<span class="go">1    Bear</span>
<span class="go">2     Cow</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">T</span>
<span class="go">0     Ant</span>
<span class="go">1    Bear</span>
<span class="go">2     Cow</span>
<span class="go">dtype: object</span>

<span class="go">For Index:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span><span class="o">.</span><span class="n">T</span>
<span class="go">Index([1, 2, 3], dtype=&#39;int64&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.transpose" title="Link to this definition">¶</a></dt>
<dd><p>Return the transpose, which is by definition self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>%(klass)s</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.shape" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.shape()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_append</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify_integrity</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.append"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.append" title="Link to this definition">¶</a></dt>
<dd><p>This method has been removed in the current version of Pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.align">
<span class="sig-name descname"><span class="pre">align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.align" title="Link to this definition">¶</a></dt>
<dd><p>Align two objects on their axes with the specified join method.</p>
<p>Join method is specified for each axis Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>)</p></li>
<li><p><strong>join</strong> (<em>{'outer'</em><em>, </em><em>'inner'</em><em>, </em><em>'left'</em><em>, </em><em>'right'}</em><em>, </em><em>default 'outer'</em>) – <p>Type of alignment to be performed.</p>
<ul>
<li><p>left: use only keys from left frame, preserve key order.</p></li>
<li><p>right: use only keys from right frame, preserve key order.</p></li>
<li><p>outer: use union of keys from both frames, sort keys lexicographically.</p></li>
<li><p>inner: use intersection of keys from both frames,
preserve the order of the left keys.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>allowed axis</em><em> of </em><em>the other object</em><em>, </em><em>default None</em>) – Align on index (0), columns (1), or both (None).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>level name</em><em>, </em><em>default None</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Always returns new objects. If copy=False and no reindexing is
required then original objects are returned.</p></li>
<li><p><strong>fill_value</strong> (<em>scalar</em><em>, </em><em>default np.nan</em>) – Value to use for missing values. Defaults to NaN, but can be any
“compatible” value.</p></li>
<li><p><strong>method</strong> (<em>{'backfill'</em><em>, </em><em>'bfill'</em><em>, </em><em>'pad'</em><em>, </em><em>'ffill'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Method to use for filling holes in reindexed DeferredSeries:</p>
<ul>
<li><p>pad / ffill: propagate last valid observation forward to next valid.</p></li>
<li><p>backfill / bfill: use NEXT valid observation to fill gap.</p></li>
</ul>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default None</em>) – <p>If method is specified, this is the maximum number of consecutive
NaN values to forward/backward fill. In other words, if there is
a gap with more than this number of consecutive NaNs, it will only
be partially filled. If method is not specified, this is the
maximum number of entries along the entire axis where NaNs will be
filled. Must be greater than 0 if not None.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>fill_axis</strong> (<em>{0</em><em> or </em><em>'index'} for DeferredSeries</em><em>, </em><em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'} for DeferredDataFrame</em><em>, </em><em>default 0</em>) – <p>Filling axis, method and limit.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>broadcast_axis</strong> (<em>{0</em><em> or </em><em>'index'} for DeferredSeries</em><em>, </em><em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'} for DeferredDataFrame</em><em>, </em><em>default None</em>) – <p>Broadcast values along this axis, if aligning two objects of
different dimensions.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aligned objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of (DeferredSeries/DeferredDataFrame, <a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)">type</a> of other)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Aligning per-level is not yet supported. Only the default,
<code class="docutils literal notranslate"><span class="pre">level=None</span></code>, is allowed.</p>
<p>Filling NaN values via <code class="docutils literal notranslate"><span class="pre">method</span></code> is not supported, because it is
<a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>.
Only the default, <code class="docutils literal notranslate"><span class="pre">method=None</span></code>, is allowed.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   D  B  E  A</span>
<span class="go">1  1  2  3  4</span>
<span class="go">2  6  7  8  9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">    A    B    C    D</span>
<span class="go">2   10   20   30   40</span>
<span class="go">3   60   70   80   90</span>
<span class="go">4  600  700  800  900</span>

<span class="go">Align on columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">   A  B   C  D  E</span>
<span class="go">1  4  2 NaN  1  3</span>
<span class="go">2  9  7 NaN  6  8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">    A    B    C    D   E</span>
<span class="go">2   10   20   30   40 NaN</span>
<span class="go">3   60   70   80   90 NaN</span>
<span class="go">4  600  700  800  900 NaN</span>

<span class="go">We can also align on the index:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">    D    B    E    A</span>
<span class="go">1  1.0  2.0  3.0  4.0</span>
<span class="go">2  6.0  7.0  8.0  9.0</span>
<span class="go">3  NaN  NaN  NaN  NaN</span>
<span class="go">4  NaN  NaN  NaN  NaN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">    A      B      C      D</span>
<span class="go">1    NaN    NaN    NaN    NaN</span>
<span class="go">2   10.0   20.0   30.0   40.0</span>
<span class="go">3   60.0   70.0   80.0   90.0</span>
<span class="go">4  600.0  700.0  800.0  900.0</span>

<span class="go">Finally, the default `axis=None` will align on both index and columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">     A    B   C    D    E</span>
<span class="go">1  4.0  2.0 NaN  1.0  3.0</span>
<span class="go">2  9.0  7.0 NaN  6.0  8.0</span>
<span class="go">3  NaN  NaN NaN  NaN  NaN</span>
<span class="go">4  NaN  NaN NaN  NaN  NaN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">       A      B      C      D   E</span>
<span class="go">1    NaN    NaN    NaN    NaN NaN</span>
<span class="go">2   10.0   20.0   30.0   40.0 NaN</span>
<span class="go">3   60.0   70.0   80.0   90.0 NaN</span>
<span class="go">4  600.0  700.0  800.0  900.0 NaN</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.argsort">
<span class="sig-name descname"><span class="pre">argsort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.argsort" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.argsort.html#pandas.Series.argsort" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.argsort()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.array" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.array()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.get" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.get.html#pandas.Series.get" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.get()</span></code></a> is not yet supported in the Beam DataFrame API because the columns in the output DataFrame depend on the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-columns">https://s.apache.org/dataframe-non-deferred-columns</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.ravel">
<span class="sig-name descname"><span class="pre">ravel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.ravel" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.ravel()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.slice_shift">
<span class="sig-name descname"><span class="pre">slice_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.slice_shift" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.slice_shift()</span></code> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.tshift">
<span class="sig-name descname"><span class="pre">tshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.tshift" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.tshift()</span></code> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rename">
<span class="sig-name descname"><span class="pre">rename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rename" title="Link to this definition">¶</a></dt>
<dd><p>Alter Series index labels or name.</p>
<p>Function / dict values must be unique (1-to-1). Labels not contained in
a dict / Series will be left as-is. Extra labels listed don’t throw an
error.</p>
<p>Alternatively, change <code class="docutils literal notranslate"><span class="pre">Series.name</span></code> with a scalar value.</p>
<p>See the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/basics.html#basics-rename" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">user guide</span></a> for more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>scalar</em><em>, </em><em>hashable sequence</em><em>, </em><em>dict-like</em><em> or </em><em>function optional</em>) – Functions or dict-like are transformations to apply to
the index.
Scalar or hashable sequence-like will alter the <code class="docutils literal notranslate"><span class="pre">DeferredSeries.name</span></code>
attribute.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Also copy underlying data.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to return a new DeferredSeries. If True the value of copy is ignored.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>level name</em><em>, </em><em>default None</em>) – In case of MultiIndex, only rename labels in the specified level.</p></li>
<li><p><strong>errors</strong> (<em>{'ignore'</em><em>, </em><em>'raise'}</em><em>, </em><em>default 'ignore'</em>) – If ‘raise’, raise <cite>KeyError</cite> when a <cite>dict-like mapper</cite> or
<cite>index</cite> contains labels that are not present in the index being transformed.
If ‘ignore’, existing keys will be renamed and extra keys will be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredSeries with index labels or name altered or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename" title="apache_beam.dataframe.frames.DeferredDataFrame.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.rename</span></code></a></dt><dd><p>Corresponding DeferredDataFrame method.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rename_axis" title="apache_beam.dataframe.frames.DeferredSeries.rename_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rename_axis</span></code></a></dt><dd><p>Set the name of the axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">dtype: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;my_name&quot;</span><span class="p">)</span>  <span class="c1"># scalar, changes Series.name</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">Name: my_name, dtype: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># function, changes labels</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">4    3</span>
<span class="go">dtype: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>  <span class="c1"># mapping, changes labels</span>
<span class="go">0    1</span>
<span class="go">3    2</span>
<span class="go">5    3</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.between">
<span class="sig-name descname"><span class="pre">between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.between" title="Link to this definition">¶</a></dt>
<dd><p>Return boolean Series equivalent to left &lt;= series &lt;= right.</p>
<p>This function returns a boolean vector containing <cite>True</cite> wherever the
corresponding Series element is between the boundary values <cite>left</cite> and
<cite>right</cite>. NA values are treated as <cite>False</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> (<em>scalar</em><em> or </em><em>list-like</em>) – Left boundary.</p></li>
<li><p><strong>right</strong> (<em>scalar</em><em> or </em><em>list-like</em>) – Right boundary.</p></li>
<li><p><strong>inclusive</strong> (<em>{&quot;both&quot;</em><em>, </em><em>&quot;neither&quot;</em><em>, </em><em>&quot;left&quot;</em><em>, </em><em>&quot;right&quot;}</em>) – <p>Include boundaries. Whether to set each bound as closed or open.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.3.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredSeries representing whether each element is between left and
right (inclusive).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.gt" title="apache_beam.dataframe.frames.DeferredSeries.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.gt</span></code></a></dt><dd><p>Greater than of series and other.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.lt" title="apache_beam.dataframe.frames.DeferredSeries.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.lt</span></code></a></dt><dd><p>Less than of series and other.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function is equivalent to <code class="docutils literal notranslate"><span class="pre">(left</span> <span class="pre">&lt;=</span> <span class="pre">ser)</span> <span class="pre">&amp;</span> <span class="pre">(ser</span> <span class="pre">&lt;=</span> <span class="pre">right)</span></code></p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>

<span class="go">Boundary values are included by default:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">With `inclusive` set to ``&quot;neither&quot;`` boundary values are excluded:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">inclusive</span><span class="o">=</span><span class="s2">&quot;neither&quot;</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2    False</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">`left` and `right` can be any scalar value:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Carol&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="s1">&#39;Anna&#39;</span><span class="p">,</span> <span class="s1">&#39;Daniel&#39;</span><span class="p">)</span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.add_suffix">
<span class="sig-name descname"><span class="pre">add_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.add_suffix" title="Link to this definition">¶</a></dt>
<dd><p>Suffix labels with string <cite>suffix</cite>.</p>
<p>For Series, the row labels are suffixed.
For DataFrame, the column labels are suffixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The string to add after each label.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Axis to add suffix on</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New DeferredSeries or DeferredDataFrame with updated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.add_prefix" title="apache_beam.dataframe.frames.DeferredSeries.add_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.add_prefix</span></code></a></dt><dd><p>Prefix row labels with string <cite>prefix</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_prefix" title="apache_beam.dataframe.frames.DeferredDataFrame.add_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add_prefix</span></code></a></dt><dd><p>Prefix column labels with string <cite>prefix</cite>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s1">&#39;_item&#39;</span><span class="p">)</span>
<span class="go">0_item    1</span>
<span class="go">1_item    2</span>
<span class="go">2_item    3</span>
<span class="go">3_item    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  1  3</span>
<span class="go">1  2  4</span>
<span class="go">2  3  5</span>
<span class="go">3  4  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s1">&#39;_col&#39;</span><span class="p">)</span>
<span class="go">     A_col  B_col</span>
<span class="go">0       1       3</span>
<span class="go">1       2       4</span>
<span class="go">2       3       5</span>
<span class="go">3       4       6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.add_prefix">
<span class="sig-name descname"><span class="pre">add_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.add_prefix" title="Link to this definition">¶</a></dt>
<dd><p>Prefix labels with string <cite>prefix</cite>.</p>
<p>For Series, the row labels are prefixed.
For DataFrame, the column labels are prefixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The string to add before each label.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Axis to add prefix on</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New DeferredSeries or DeferredDataFrame with updated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.add_suffix" title="apache_beam.dataframe.frames.DeferredSeries.add_suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.add_suffix</span></code></a></dt><dd><p>Suffix row labels with string <cite>suffix</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_suffix" title="apache_beam.dataframe.frames.DeferredDataFrame.add_suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add_suffix</span></code></a></dt><dd><p>Suffix column labels with string <cite>suffix</cite>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;item_&#39;</span><span class="p">)</span>
<span class="go">item_0    1</span>
<span class="go">item_1    2</span>
<span class="go">item_2    3</span>
<span class="go">item_3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  1  3</span>
<span class="go">1  2  4</span>
<span class="go">2  3  5</span>
<span class="go">3  4  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;col_&#39;</span><span class="p">)</span>
<span class="go">     col_A  col_B</span>
<span class="go">0       1       3</span>
<span class="go">1       2       4</span>
<span class="go">2       3       5</span>
<span class="go">3       4       6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.info" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.info()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.idxmin">
<span class="sig-name descname"><span class="pre">idxmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.idxmin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="Link to this definition">¶</a></dt>
<dd><p>Return the row label of the minimum value.</p>
<p>If multiple values equal the minimum, the first row label with that
value is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire DeferredSeries is NA, the result
will be NA.</p></li>
<li><p><strong>*args</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Label of the minimum value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index">Index</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the DeferredSeries is empty.</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.argmin.html#numpy.argmin" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.argmin</span></code></a></dt><dd><p>Return indices of the minimum values along the given axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return index of first occurrence of minimum over requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return index <em>label</em> of the first occurrence of maximum of values.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method is the DeferredSeries version of <code class="docutils literal notranslate"><span class="pre">ndarray.argmin</span></code>. This method
returns the label of the minimum, while <code class="docutils literal notranslate"><span class="pre">ndarray.argmin</span></code> returns
the position. To get the position, use <code class="docutils literal notranslate"><span class="pre">series.values.argmin()</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">A    1.0</span>
<span class="go">B    NaN</span>
<span class="go">C    4.0</span>
<span class="go">D    1.0</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="go">&#39;A&#39;</span>

<span class="go">If `skipna` is False and there is an NA value in the data,</span>
<span class="go">the function returns ``nan``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.idxmax">
<span class="sig-name descname"><span class="pre">idxmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.idxmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="Link to this definition">¶</a></dt>
<dd><p>Return the row label of the maximum value.</p>
<p>If multiple values equal the maximum, the first row label with that
value is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire DeferredSeries is NA, the result
will be NA.</p></li>
<li><p><strong>*args</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Label of the maximum value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index">Index</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the DeferredSeries is empty.</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.argmax.html#numpy.argmax" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.argmax</span></code></a></dt><dd><p>Return indices of the maximum values along the given axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return index of first occurrence of maximum over requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return index <em>label</em> of the first occurrence of minimum of values.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method is the DeferredSeries version of <code class="docutils literal notranslate"><span class="pre">ndarray.argmax</span></code>. This method
returns the label of the maximum, while <code class="docutils literal notranslate"><span class="pre">ndarray.argmax</span></code> returns
the position. To get the position, use <code class="docutils literal notranslate"><span class="pre">series.values.argmax()</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">A    1.0</span>
<span class="go">B    NaN</span>
<span class="go">C    4.0</span>
<span class="go">D    3.0</span>
<span class="go">E    4.0</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="go">&#39;C&#39;</span>

<span class="go">If `skipna` is False and there is an NA value in the data,</span>
<span class="go">the function returns ``nan``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.explode">
<span class="sig-name descname"><span class="pre">explode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.explode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.explode" title="Link to this definition">¶</a></dt>
<dd><p>Transform each element of a list-like to a row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If True, the resulting index will be labeled 0, 1, …, n - 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exploded lists to rows; index will be duplicated for these rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.str.split</span></code></dt><dd><p>Split string values on specified separator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.unstack</span></code></dt><dd><p>Unstack, a.k.a. pivot, DeferredSeries with MultiIndex to produce DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.melt" title="apache_beam.dataframe.frames.DeferredDataFrame.melt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.melt</span></code></a></dt><dd><p>Unpivot a DeferredDataFrame from wide format to long format.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.explode" title="apache_beam.dataframe.frames.DeferredDataFrame.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.explode</span></code></a></dt><dd><p>Explode a DeferredDataFrame from list-like columns to long format.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This routine will explode list-likes including lists, tuples, sets,
DeferredSeries, and np.ndarray. The result dtype of the subset rows will
be object. Scalars will be returned unchanged, and empty list-likes will
result in a np.nan for that row. In addition, the ordering of elements in
the output will be non-deterministic when exploding sets.</p>
<p>Reference <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping-explode" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more examples.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    [1, 2, 3]</span>
<span class="go">1          foo</span>
<span class="go">2           []</span>
<span class="go">3       [3, 4]</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">explode</span><span class="p">()</span>
<span class="go">0      1</span>
<span class="go">0      2</span>
<span class="go">0      3</span>
<span class="go">1    foo</span>
<span class="go">2    NaN</span>
<span class="go">3      3</span>
<span class="go">3      4</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.dot" title="Link to this definition">¶</a></dt>
<dd><p>Compute the matrix multiplication between the DataFrame and other.</p>
<p>This method computes the matrix product between the DataFrame and the
values of an other Series, DataFrame or a numpy array.</p>
<p>It can also be called using <code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">&#64;</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em> or </em><em>array-like</em>) – The other object to compute the matrix product with.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If other is a DeferredSeries, return the matrix product between self and
other as a DeferredSeries. If other is a DeferredDataFrame or a numpy.array, return
the matrix product of self and other in a DeferredDataFrame of a np.array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">other</span></code> must be a <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code></a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a>
instance. Computing the dot product with an array-like is not supported
because it is order-sensitive.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dot" title="apache_beam.dataframe.frames.DeferredSeries.dot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dot</span></code></a></dt><dd><p>Similar method for DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The dimensions of DeferredDataFrame and other must be compatible in order to
compute the matrix multiplication. In addition, the column names of
DeferredDataFrame and the index of other must contain the same values, as they
will be aligned prior to the multiplication.</p>
<p>The dot method for DeferredSeries computes the inner product, instead of the
matrix product here.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Here we multiply a DataFrame with a Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">0    -4</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>

<span class="go">Here we multiply a DataFrame with another DataFrame.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">Note that the dot method give the same result as @</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">@</span> <span class="n">other</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">The dot method works also if other is an np.array.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">Note how shuffling of the objects does not change the result.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">0    -4</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.nunique">
<span class="sig-name descname"><span class="pre">nunique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.nunique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.nunique" title="Link to this definition">¶</a></dt>
<dd><p>Return number of unique elements in the object.</p>
<p>Excludes NA values by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Don’t include NaN in the count.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nunique" title="apache_beam.dataframe.frames.DeferredDataFrame.nunique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.nunique</span></code></a></dt><dd><p>Method nunique for DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.count" title="apache_beam.dataframe.frames.DeferredSeries.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.count</span></code></a></dt><dd><p>Count non-NA/null observations in the DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    3</span>
<span class="go">2    5</span>
<span class="go">3    7</span>
<span class="go">4    7</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.quantile">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.quantile" title="Link to this definition">¶</a></dt>
<dd><p>Return value at the given quantile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default 0.5</em><em> (</em><em>50% quantile</em><em>)</em>) – The quantile(s) to compute, which can lie in range: 0 &lt;= q &lt;= 1.</p></li>
<li><p><strong>interpolation</strong> (<em>{'linear'</em><em>, </em><em>'lower'</em><em>, </em><em>'higher'</em><em>, </em><em>'midpoint'</em><em>, </em><em>'nearest'}</em>) – <p>This optional parameter specifies the interpolation method to use,
when the desired quantile lies between two data points <cite>i</cite> and <cite>j</cite>:</p>
<blockquote>
<div><ul>
<li><p>linear: <cite>i + (j - i) * fraction</cite>, where <cite>fraction</cite> is the
fractional part of the index surrounded by <cite>i</cite> and <cite>j</cite>.</p></li>
<li><p>lower: <cite>i</cite>.</p></li>
<li><p>higher: <cite>j</cite>.</p></li>
<li><p>nearest: <cite>i</cite> or <cite>j</cite> whichever is nearest.</p></li>
<li><p>midpoint: (<cite>i</cite> + <cite>j</cite>) / 2.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">q</span></code> is an array, a DeferredSeries will be returned where the
index is <code class="docutils literal notranslate"><span class="pre">q</span></code> and the values are the quantiles, otherwise
a float will be returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>quantile is not parallelizable. See
<a class="reference external" href="https://github.com/apache/beam/issues/20933">Issue 20933</a> tracking
the possible addition of an approximate, parallelizable implementation of
quantile.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.Rolling.quantile</span></code></dt><dd><p>Calculate the rolling quantile.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.percentile.html#numpy.percentile" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.percentile</span></code></a></dt><dd><p>Returns the q-th percentile(s) of the array elements.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span>
<span class="go">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">])</span>
<span class="go">0.25    1.75</span>
<span class="go">0.50    2.50</span>
<span class="go">0.75    3.25</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.std" title="Link to this definition">¶</a></dt>
<dd><p>Return sample standard deviation over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> (if level specified)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Notes</p>
<p>To have the same behaviour as <cite>numpy.std</cite>, use <cite>ddof=0</cite> (instead of the
default <cite>ddof=1</cite>)</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.87</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">]}</span>
<span class="gp">... </span>                  <span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;person_id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           age  height</span>
<span class="go">person_id</span>
<span class="go">0           21    1.61</span>
<span class="go">1           25    1.87</span>
<span class="go">2           62    1.49</span>
<span class="go">3           43    2.01</span>

<span class="go">The standard deviation of the columns can be found as follows:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="go">age       18.786076</span>
<span class="go">height     0.237417</span>
<span class="go">dtype: float64</span>

<span class="go">Alternatively, `ddof=0` can be set to normalize by N instead of N-1:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">age       16.269219</span>
<span class="go">height     0.205609</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skipna</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.mean" title="Link to this definition">¶</a></dt>
<dd><p>Return the mean of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.mean()</span>
<span class="go">            2.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.mean()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.mean(axis=1)</span>
<span class="go">            tiger   1.5</span>
<span class="go">            zebra   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">            getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.mean(numeric_only=True)</span>
<span class="go">            a   1.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.mean()</span>
<span class="go">        2.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.mean()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.mean(axis=1)</span>
<span class="go">        tiger   1.5</span>
<span class="go">        zebra   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">        getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.mean(numeric_only=True)</span>
<span class="go">        a   1.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddof</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.var" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased variance over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> (if level specified)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.87</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">]}</span>
<span class="gp">... </span>                 <span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;person_id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           age  height</span>
<span class="go">person_id</span>
<span class="go">0           21    1.61</span>
<span class="go">1           25    1.87</span>
<span class="go">2           62    1.49</span>
<span class="go">3           43    2.01</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="go">age       352.916667</span>
<span class="go">height      0.056367</span>
<span class="go">dtype: float64</span>

<span class="go">Alternatively, ``ddof=0`` can be set to normalize by N instead of N-1:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">age       264.687500</span>
<span class="go">height      0.042275</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.corr">
<span class="sig-name descname"><span class="pre">corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_periods</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.corr" title="Link to this definition">¶</a></dt>
<dd><p>Compute correlation with <cite>other</cite> Series, excluding missing values.</p>
<p>The two <cite>Series</cite> objects are not required to be the same length and will be
aligned internally before the correlation function is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – DeferredSeries with which to compute the correlation.</p></li>
<li><p><strong>method</strong> (<em>{'pearson'</em><em>, </em><em>'kendall'</em><em>, </em><em>'spearman'}</em><em> or </em><em>callable</em>) – <p>Method used to compute correlation:</p>
<ul>
<li><p>pearson : Standard correlation coefficient</p></li>
<li><p>kendall : Kendall Tau correlation coefficient</p></li>
<li><p>spearman : Spearman rank correlation</p></li>
<li><p>callable: Callable with input two 1d ndarrays and returning a float.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the returned matrix from corr will have 1 along the
diagonals and will be symmetric regardless of the callable’s
behavior.</p>
</div>
</p></li>
<li><p><strong>min_periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Minimum number of observations needed to have a valid result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Correlation with other.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">method='pearson'</span></code> is currently parallelizable.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.corr" title="apache_beam.dataframe.frames.DeferredDataFrame.corr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.corr</span></code></a></dt><dd><p>Compute pairwise correlation between columns.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.corrwith" title="apache_beam.dataframe.frames.DeferredDataFrame.corrwith"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.corrwith</span></code></a></dt><dd><p>Compute pairwise correlation with another DeferredDataFrame or DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Pearson, Kendall and Spearman correlation are currently computed using pairwise complete observations.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation coefficient</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient">Kendall rank correlation coefficient</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman’s rank correlation coefficient</a></p></li>
</ul>
<p>Automatic data alignment: as with all pandas operations, automatic data alignment is performed for this method.
<code class="docutils literal notranslate"><span class="pre">corr()</span></code> automatically considers values with matching indices.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">histogram_intersection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">.3</span><span class="p">,</span> <span class="mf">.6</span><span class="p">,</span> <span class="mf">.0</span><span class="p">,</span> <span class="mf">.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">histogram_intersection</span><span class="p">)</span>
<span class="go">0.3</span>

<span class="go">Pandas auto-aligns the values with matching indices</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">-1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.skew">
<span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_only</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.skew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.skew" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased skew over requested axis.</p>
<p>Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.skew()</span>
<span class="go">            0.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [2, 3, 4], &#39;c&#39;: [1, 3, 5]},</span>
<span class="go">            ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                    a   b   c</span>
<span class="go">            tiger   1   2   1</span>
<span class="go">            zebra   2   3   3</span>
<span class="go">            cow     3   4   5</span>
<span class="go">            &gt;&gt;&gt; df.skew()</span>
<span class="go">            a   0.0</span>
<span class="go">            b   0.0</span>
<span class="go">            c   0.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.skew(axis=1)</span>
<span class="go">            tiger   1.732051</span>
<span class="go">            zebra  -1.732051</span>
<span class="go">            cow     0.000000</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">            getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;, &#39;X&#39;]},</span>
<span class="go">            ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.skew(numeric_only=True)</span>
<span class="go">            a   0.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.skew()</span>
<span class="go">        0.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [2, 3, 4], &#39;c&#39;: [1, 3, 5]},</span>
<span class="go">        ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">                a   b   c</span>
<span class="go">        tiger   1   2   1</span>
<span class="go">        zebra   2   3   3</span>
<span class="go">        cow     3   4   5</span>
<span class="go">        &gt;&gt;&gt; df.skew()</span>
<span class="go">        a   0.0</span>
<span class="go">        b   0.0</span>
<span class="go">        c   0.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.skew(axis=1)</span>
<span class="go">        tiger   1.732051</span>
<span class="go">        zebra  -1.732051</span>
<span class="go">        cow     0.000000</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">        getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;, &#39;X&#39;]},</span>
<span class="go">        ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.skew(numeric_only=True)</span>
<span class="go">        a   0.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.kurtosis">
<span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipna</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_only</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.kurtosis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.kurtosis" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased kurtosis over requested axis.</p>
<p>Kurtosis obtained using Fisher’s definition of
kurtosis (kurtosis of normal == 0.0). Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; s</span>
<span class="go">            cat    1</span>
<span class="go">            dog    2</span>
<span class="go">            dog    2</span>
<span class="go">            mouse  3</span>
<span class="go">            dtype: int64</span>
<span class="go">            &gt;&gt;&gt; s.kurt()</span>
<span class="go">            1.5</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">              cat  1   3</span>
<span class="go">              dog  2   4</span>
<span class="go">              dog  2   4</span>
<span class="go">            mouse  3   4</span>
<span class="go">            &gt;&gt;&gt; df.kurt()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   4.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            With axis=None</span>

<span class="go">            &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">            -0.988693</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">            cat   -6.0</span>
<span class="go">            dog   -6.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; s</span>
<span class="go">        cat    1</span>
<span class="go">        dog    2</span>
<span class="go">        dog    2</span>
<span class="go">        mouse  3</span>
<span class="go">        dtype: int64</span>
<span class="go">        &gt;&gt;&gt; s.kurt()</span>
<span class="go">        1.5</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">          cat  1   3</span>
<span class="go">          dog  2   4</span>
<span class="go">          dog  2   4</span>
<span class="go">        mouse  3   4</span>
<span class="go">        &gt;&gt;&gt; df.kurt()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   4.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        With axis=None</span>

<span class="go">        &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">        -0.988693</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">        cat   -6.0</span>
<span class="go">        dog   -6.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.kurt">
<span class="sig-name descname"><span class="pre">kurt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.kurt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.kurt" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased kurtosis over requested axis.</p>
<p>Kurtosis obtained using Fisher’s definition of
kurtosis (kurtosis of normal == 0.0). Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; s</span>
<span class="go">            cat    1</span>
<span class="go">            dog    2</span>
<span class="go">            dog    2</span>
<span class="go">            mouse  3</span>
<span class="go">            dtype: int64</span>
<span class="go">            &gt;&gt;&gt; s.kurt()</span>
<span class="go">            1.5</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">              cat  1   3</span>
<span class="go">              dog  2   4</span>
<span class="go">              dog  2   4</span>
<span class="go">            mouse  3   4</span>
<span class="go">            &gt;&gt;&gt; df.kurt()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   4.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            With axis=None</span>

<span class="go">            &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">            -0.988693</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">            cat   -6.0</span>
<span class="go">            dog   -6.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; s</span>
<span class="go">        cat    1</span>
<span class="go">        dog    2</span>
<span class="go">        dog    2</span>
<span class="go">        mouse  3</span>
<span class="go">        dtype: int64</span>
<span class="go">        &gt;&gt;&gt; s.kurt()</span>
<span class="go">        1.5</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">          cat  1   3</span>
<span class="go">          dog  2   4</span>
<span class="go">          dog  2   4</span>
<span class="go">        mouse  3   4</span>
<span class="go">        &gt;&gt;&gt; df.kurt()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   4.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        With axis=None</span>

<span class="go">        &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">        -0.988693</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">        cat   -6.0</span>
<span class="go">        dog   -6.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_periods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cov" title="Link to this definition">¶</a></dt>
<dd><p>Compute covariance with Series, excluding missing values.</p>
<p>The two <cite>Series</cite> objects are not required to be the same length and
will be aligned internally before the covariance is calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – DeferredSeries with which to compute the covariance.</p></li>
<li><p><strong>min_periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Minimum number of observations needed to have a valid result.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta degrees of freedom.  The divisor used in calculations
is <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">-</span> <span class="pre">ddof</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> represents the number of elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Covariance between DeferredSeries and other normalized by N-1
(unbiased estimator).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.cov" title="apache_beam.dataframe.frames.DeferredDataFrame.cov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.cov</span></code></a></dt><dd><p>Compute pairwise covariance of columns.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.90010907</span><span class="p">,</span> <span class="mf">0.13484424</span><span class="p">,</span> <span class="mf">0.62036035</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.12528585</span><span class="p">,</span> <span class="mf">0.26962463</span><span class="p">,</span> <span class="mf">0.51111198</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">-0.01685762652715874</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.dropna">
<span class="sig-name descname"><span class="pre">dropna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.dropna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="Link to this definition">¶</a></dt>
<dd><p>Return a new Series with missing values removed.</p>
<p>See the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/missing_data.html#missing-data" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">User Guide</span></a> for more on which values are
considered missing, and how to work with missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If True, do operation inplace and return None.</p></li>
<li><p><strong>how</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Not in use. Kept for compatibility.</p></li>
<li><p><strong>ignore_index</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the resulting axis will be labeled 0, 1, …, n - 1.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredSeries with NA entries dropped from it or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="apache_beam.dataframe.frames.DeferredSeries.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.isna</span></code></a></dt><dd><p>Indicate missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="apache_beam.dataframe.frames.DeferredSeries.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.notna</span></code></a></dt><dd><p>Indicate existing (non-missing) values.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.fillna</span></code></dt><dd><p>Replace missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="apache_beam.dataframe.frames.DeferredDataFrame.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dropna</span></code></a></dt><dd><p>Drop rows or columns which contain NA values.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.dropna</span></code></dt><dd><p>Drop missing indices.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    1.0</span>
<span class="go">1    2.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="go">Drop NA values from a Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="go">0    1.0</span>
<span class="go">1    2.0</span>
<span class="go">dtype: float64</span>

<span class="go">Empty strings are not considered NA values. ``None`` is considered an</span>
<span class="go">NA value.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;I stay&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0       NaN</span>
<span class="go">1         2</span>
<span class="go">2       NaT</span>
<span class="go">3</span>
<span class="go">4      None</span>
<span class="go">5    I stay</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="go">1         2</span>
<span class="go">3</span>
<span class="go">5    I stay</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.set_axis">
<span class="sig-name descname"><span class="pre">set_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.set_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.set_axis" title="Link to this definition">¶</a></dt>
<dd><p>Assign desired index to given axis.</p>
<p>Indexes for row labels can be changed by assigning
a list-like or Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list-like</em><em>, </em><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index"><em>Index</em></a>) – The values for the new index.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em><em>, </em><em>default 0</em>) – The axis to update. The value 0 identifies the rows. For <cite>DeferredSeries</cite>
this parameter is unused and defaults to 0.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – <p>Whether to make a copy of the underlying data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object of type DeferredSeries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Series.rename_axis</span></code></dt><dd><p>Alter the name of the index.</p>
</dd>
</dl>
</div>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series.rename_axis : Alter the name of the index.</span>

<span class="go">        Examples</span>
<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s</span>
<span class="go">        0    1</span>
<span class="go">        1    2</span>
<span class="go">        2    3</span>
<span class="go">        dtype: int64</span>

<span class="go">        &gt;&gt;&gt; s.set_axis([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], axis=0)</span>
<span class="go">        a    1</span>
<span class="go">        b    2</span>
<span class="go">        c    3</span>
<span class="go">        dtype: int64</span>


<span class="go">    --------</span>
<span class="go">    &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">    &gt;&gt;&gt; s</span>
<span class="go">    0    1</span>
<span class="go">    1    2</span>
<span class="go">    2    3</span>
<span class="go">    dtype: int64</span>

<span class="go">    &gt;&gt;&gt; s.set_axis([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], axis=0)</span>
<span class="go">    a    1</span>
<span class="go">    b    2</span>
<span class="go">    c    3</span>
<span class="go">    dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.isnull">
<span class="sig-name descname"><span class="pre">isnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.isnull" title="Link to this definition">¶</a></dt>
<dd><p>Detect missing values.</p>
<p>Return a boolean same-sized object indicating if the values are NA.
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, gets mapped to True
values.
Everything else gets mapped to False values. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredSeries that
indicates whether an element is an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isnull" title="apache_beam.dataframe.frames.DeferredSeries.isnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.isnull</span></code></a></dt><dd><p>Alias of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="apache_beam.dataframe.frames.DeferredSeries.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.notna</span></code></a></dt><dd><p>Boolean inverse of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="apache_beam.dataframe.frames.DeferredSeries.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="apache_beam.dataframe.frames.DeferredSeries.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isna</span></code></a></dt><dd><p>Top-level isna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">     age   born   name    toy</span>
<span class="go">0  False   True  False   True</span>
<span class="go">1  False  False  False  False</span>
<span class="go">2   True  False  False  False</span>

<span class="go">Show which entries in a Series are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.isna">
<span class="sig-name descname"><span class="pre">isna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="Link to this definition">¶</a></dt>
<dd><p>Detect missing values.</p>
<p>Return a boolean same-sized object indicating if the values are NA.
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, gets mapped to True
values.
Everything else gets mapped to False values. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredSeries that
indicates whether an element is an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isnull" title="apache_beam.dataframe.frames.DeferredSeries.isnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.isnull</span></code></a></dt><dd><p>Alias of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="apache_beam.dataframe.frames.DeferredSeries.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.notna</span></code></a></dt><dd><p>Boolean inverse of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="apache_beam.dataframe.frames.DeferredSeries.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="apache_beam.dataframe.frames.DeferredSeries.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isna</span></code></a></dt><dd><p>Top-level isna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">     age   born   name    toy</span>
<span class="go">0  False   True  False   True</span>
<span class="go">1  False  False  False  False</span>
<span class="go">2   True  False  False  False</span>

<span class="go">Show which entries in a Series are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.notnull">
<span class="sig-name descname"><span class="pre">notnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.notnull" title="Link to this definition">¶</a></dt>
<dd><p>Detect existing (non-missing) values.</p>
<p>Return a boolean same-sized object indicating if the values are not NA.
Non-missing values get mapped to True. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, get mapped to False
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredSeries that
indicates whether an element is not an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notnull" title="apache_beam.dataframe.frames.DeferredSeries.notnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.notnull</span></code></a></dt><dd><p>Alias of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="apache_beam.dataframe.frames.DeferredSeries.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.isna</span></code></a></dt><dd><p>Boolean inverse of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="apache_beam.dataframe.frames.DeferredSeries.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="apache_beam.dataframe.frames.DeferredSeries.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notna</span></code></a></dt><dd><p>Top-level notna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">     age   born  name    toy</span>
<span class="go">0   True  False  True  False</span>
<span class="go">1   True   True  True   True</span>
<span class="go">2  False   True  True   True</span>

<span class="go">Show which entries in a Series are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.notna">
<span class="sig-name descname"><span class="pre">notna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="Link to this definition">¶</a></dt>
<dd><p>Detect existing (non-missing) values.</p>
<p>Return a boolean same-sized object indicating if the values are not NA.
Non-missing values get mapped to True. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, get mapped to False
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredSeries that
indicates whether an element is not an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notnull" title="apache_beam.dataframe.frames.DeferredSeries.notnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.notnull</span></code></a></dt><dd><p>Alias of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.isna" title="apache_beam.dataframe.frames.DeferredSeries.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.isna</span></code></a></dt><dd><p>Boolean inverse of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="apache_beam.dataframe.frames.DeferredSeries.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.notna" title="apache_beam.dataframe.frames.DeferredSeries.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notna</span></code></a></dt><dd><p>Top-level notna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">     age   born  name    toy</span>
<span class="go">0   True  False  True  False</span>
<span class="go">1   True   True  True   True</span>
<span class="go">2  False   True  True   True</span>

<span class="go">Show which entries in a Series are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.items" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.items.html#pandas.Series.items" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.items()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.iteritems">
<span class="sig-name descname"><span class="pre">iteritems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.iteritems" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.iteritems()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.tolist">
<span class="sig-name descname"><span class="pre">tolist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.tolist" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.tolist()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_numpy" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_numpy.html#pandas.Series.to_numpy" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_numpy()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_string" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_string.html#pandas.Series.to_string" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_string()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.duplicated">
<span class="sig-name descname"><span class="pre">duplicated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.duplicated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.duplicated" title="Link to this definition">¶</a></dt>
<dd><p>Indicate duplicate Series values.</p>
<p>Duplicated values are indicated as <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the resulting
Series. Either all duplicates, all except the first or all except the
last occurrence of duplicates can be indicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>False}</em><em>, </em><em>default 'first'</em>) – <p>Method to handle dropping duplicates:</p>
<ul class="simple">
<li><p>’first’ : Mark duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code> except for the first
occurrence.</p></li>
<li><p>’last’ : Mark duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code> except for the last
occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> : Mark all duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredSeries indicating whether each value has occurred in the
preceding values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>]</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.duplicated</span></code></dt><dd><p>Equivalent method on pandas.Index.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.duplicated" title="apache_beam.dataframe.frames.DeferredDataFrame.duplicated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.duplicated</span></code></a></dt><dd><p>Equivalent method on pandas.DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.drop_duplicates" title="apache_beam.dataframe.frames.DeferredSeries.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.drop_duplicates</span></code></a></dt><dd><p>Remove duplicate values from DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default, for each set of duplicated values, the first occurrence is</span>
<span class="go">set on False and all others on True:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;llama&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;llama&#39;</span><span class="p">,</span> <span class="s1">&#39;beetle&#39;</span><span class="p">,</span> <span class="s1">&#39;llama&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">4     True</span>
<span class="go">dtype: bool</span>

<span class="go">which is equivalent to</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">4     True</span>
<span class="go">dtype: bool</span>

<span class="go">By using &#39;last&#39;, the last occurrence of each set of duplicated values</span>
<span class="go">is set on False and all others on True:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">By setting keep on ``False``, all duplicates are True:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">3    False</span>
<span class="go">4     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.drop_duplicates">
<span class="sig-name descname"><span class="pre">drop_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.drop_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.drop_duplicates" title="Link to this definition">¶</a></dt>
<dd><p>Return Series with duplicate values removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep</strong> ({‘first’, ‘last’, <code class="docutils literal notranslate"><span class="pre">False</span></code>}, default ‘first’) – <p>Method to handle dropping duplicates:</p>
<ul>
<li><p>’first’ : Drop duplicates except for the first occurrence.</p></li>
<li><p>’last’ : Drop duplicates except for the last occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> : Drop all duplicates.</p></li>
</ul>
</p></li>
<li><p><strong>inplace</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, performs operation inplace and returns None.</p></li>
<li><p><strong>ignore_index</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the resulting axis will be labeled 0, 1, …, n - 1.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredSeries with duplicates dropped or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.drop_duplicates</span></code></dt><dd><p>Equivalent method on Index.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates" title="apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.drop_duplicates</span></code></a></dt><dd><p>Equivalent method on DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.duplicated" title="apache_beam.dataframe.frames.DeferredSeries.duplicated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.duplicated</span></code></a></dt><dd><p>Related method on DeferredSeries, indicating duplicate DeferredSeries values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.unique" title="apache_beam.dataframe.frames.DeferredSeries.unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.unique</span></code></a></dt><dd><p>Return unique values as an array.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Generate a Series with duplicated entries.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;llama&#39;</span><span class="p">,</span> <span class="s1">&#39;cow&#39;</span><span class="p">,</span> <span class="s1">&#39;llama&#39;</span><span class="p">,</span> <span class="s1">&#39;beetle&#39;</span><span class="p">,</span> <span class="s1">&#39;llama&#39;</span><span class="p">,</span> <span class="s1">&#39;hippo&#39;</span><span class="p">],</span>
<span class="gp">... </span>              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;animal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0     llama</span>
<span class="go">1       cow</span>
<span class="go">2     llama</span>
<span class="go">3    beetle</span>
<span class="go">4     llama</span>
<span class="go">5     hippo</span>
<span class="go">Name: animal, dtype: object</span>

<span class="go">With the &#39;keep&#39; parameter, the selection behaviour of duplicated values</span>
<span class="go">can be changed. The value &#39;first&#39; keeps the first occurrence for each</span>
<span class="go">set of duplicated entries. The default value of keep is &#39;first&#39;.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="go">0     llama</span>
<span class="go">1       cow</span>
<span class="go">3    beetle</span>
<span class="go">5     hippo</span>
<span class="go">Name: animal, dtype: object</span>

<span class="go">The value &#39;last&#39; for parameter &#39;keep&#39; keeps the last occurrence for</span>
<span class="go">each set of duplicated entries.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">1       cow</span>
<span class="go">3    beetle</span>
<span class="go">4     llama</span>
<span class="go">5     hippo</span>
<span class="go">Name: animal, dtype: object</span>

<span class="go">The value ``False`` for parameter &#39;keep&#39; discards all sets of</span>
<span class="go">duplicated entries.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">1       cow</span>
<span class="go">3    beetle</span>
<span class="go">5     hippo</span>
<span class="go">Name: animal, dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.sample" title="Link to this definition">¶</a></dt>
<dd><p>Return a random sample of items from an axis of object.</p>
<p>You can use <cite>random_state</cite> for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of items from axis to return. Cannot be used with <cite>frac</cite>.
Default = 1 if <cite>frac</cite> = None.</p></li>
<li><p><strong>frac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Fraction of axis items to return. Cannot be used with <cite>n</cite>.</p></li>
<li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Allow or disallow sampling of the same row more than once.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>ndarray-like</em><em>, </em><em>optional</em>) – Default ‘None’ results in equal probability weighting.
If passed a DeferredSeries, will align with target object on index. Index
values in weights not found in sampled object will be ignored and
index values in sampled object not in weights will be assigned
weights of zero.
If called on a DeferredDataFrame, will accept the name of a column
when axis = 0.
Unless weights are a DeferredSeries, weights must be same length as axis
being sampled.
If weights do not sum to 1, they will be normalized to sum to 1.
Missing values in the weights column will be treated as zero.
Infinite values not allowed.</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>array-like</em><em>, </em><em>BitGenerator</em><em>, </em><em>np.random.RandomState</em><em>, </em><em>np.random.Generator</em><em>, </em><em>optional</em>) – <p>If int, array-like, or BitGenerator, seed for random number generator.
If np.random.RandomState or np.random.Generator, use as given.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>np.random.Generator objects now accepted</p>
</div>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – Axis to sample. Accepts axis number or name. Default is stat axis
for given data type. For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>If True, the resulting index will be labeled 0, 1, …, n - 1.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new object of same type as caller containing <cite>n</cite> items randomly
sampled from the caller object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">n</span></code> and/or <code class="docutils literal notranslate"><span class="pre">weights</span></code> may be specified.  <code class="docutils literal notranslate"><span class="pre">frac</span></code>,
<code class="docutils literal notranslate"><span class="pre">random_state</span></code>, and <code class="docutils literal notranslate"><span class="pre">replace=True</span></code> are not yet supported.
See <a class="reference external" href="https://github.com/apache/beam/issues/21010">Issue 21010</a>.</p>
<p>Note that pandas will raise an error if <code class="docutils literal notranslate"><span class="pre">n</span></code> is larger than the length
of the dataset, while the Beam DataFrame API will simply return the full
dataset in that case.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrameGroupBy.sample</span></code></dt><dd><p>Generates random samples from each group of a DeferredDataFrame object.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeriesGroupBy.sample</span></code></dt><dd><p>Generates random samples from each group of a DeferredSeries object.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.choice.html#numpy.random.choice" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.choice</span></code></a></dt><dd><p>Generates a random sample from a given 1-D numpy array.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>If <cite>frac</cite> &gt; 1, <cite>replacement</cite> should be set to <cite>True</cite>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;num_legs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;num_wings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;num_specimen_seen&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">dog            4          0                  2</span>
<span class="go">spider         8          0                  1</span>
<span class="go">fish           0          0                  8</span>

<span class="go">Extract 3 random elements from the ``Series`` ``df[&#39;num_legs&#39;]``:</span>
<span class="go">Note that we use `random_state` to ensure the reproducibility of</span>
<span class="go">the examples.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_legs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">fish      0</span>
<span class="go">spider    8</span>
<span class="go">falcon    2</span>
<span class="go">Name: num_legs, dtype: int64</span>

<span class="go">A random 50% sample of the ``DataFrame`` with replacement:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">      num_legs  num_wings  num_specimen_seen</span>
<span class="go">dog          4          0                  2</span>
<span class="go">fish         0          0                  8</span>

<span class="go">An upsample sample of the ``DataFrame`` with replacement:</span>
<span class="go">Note that `replace` parameter has to be `True` for `frac` parameter &gt; 1.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">dog            4          0                  2</span>
<span class="go">fish           0          0                  8</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">fish           0          0                  8</span>
<span class="go">dog            4          0                  2</span>
<span class="go">fish           0          0                  8</span>
<span class="go">dog            4          0                  2</span>

<span class="go">Using a DataFrame column as weights. Rows with larger value in the</span>
<span class="go">`num_specimen_seen` column are more likely to be sampled.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;num_specimen_seen&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">fish           0          0                  8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.aggregate">
<span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.aggregate" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate using one or more operations over the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – <p>Function to use for aggregating the data. If a function, must either
work when passed a DeferredSeries or when passed to DeferredSeries.apply.</p>
<p>Accepted combinations are:</p>
<ul>
<li><p>function</p></li>
<li><p>string function name</p></li>
<li><p>list of functions and/or function names, e.g. <code class="docutils literal notranslate"><span class="pre">[np.sum,</span> <span class="pre">'mean']</span></code></p></li>
<li><p>dict of axis labels -&gt; functions, function names or list of such.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>*args</strong> – Positional arguments to pass to <cite>func</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to <cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The return can be:</p>
<ul class="simple">
<li><p>scalar : when DeferredSeries.agg is called with single function</p></li>
<li><p>DeferredSeries : when DeferredDataFrame.agg is called with a single function</p></li>
<li><p>DeferredDataFrame : when DeferredDataFrame.agg is called with several functions</p></li>
</ul>
<p>Return scalar, DeferredSeries or DeferredDataFrame.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Some aggregation methods cannot be parallelized, and computing
them will require collecting all data on a single machine.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.apply" title="apache_beam.dataframe.frames.DeferredSeries.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.apply</span></code></a></dt><dd><p>Invoke function on a DeferredSeries.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.transform</span></code></dt><dd><p>Transform function producing a DeferredSeries with like indexes.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The aggregation operations are always performed over an axis, either the
index (default) or the column axis. This behavior is different from
<cite>numpy</cite> aggregation functions (<cite>mean</cite>, <cite>median</cite>, <cite>prod</cite>, <cite>sum</cite>, <cite>std</cite>,
<cite>var</cite>), where the default is to compute the aggregation of the flattened
array, e.g., <code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d)</span></code> as opposed to
<code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d,</span> <span class="pre">axis=0)</span></code>.</p>
<p><cite>agg</cite> is an alias for <cite>aggregate</cite>. Use the alias.</p>
<p>Functions that mutate the passed object can produce unexpected
behavior or errors and are not supported. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/gotchas.html#gotchas-udf-mutation" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span>Mutating with User Defined Function (UDF) methods</span></a>
for more details.</p>
<p>A passed user-defined-function will be passed a DeferredSeries for evaluation.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">])</span>
<span class="go">min   1</span>
<span class="go">max   4</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.agg">
<span class="sig-name descname"><span class="pre">agg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.agg" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate using one or more operations over the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – <p>Function to use for aggregating the data. If a function, must either
work when passed a DeferredSeries or when passed to DeferredSeries.apply.</p>
<p>Accepted combinations are:</p>
<ul>
<li><p>function</p></li>
<li><p>string function name</p></li>
<li><p>list of functions and/or function names, e.g. <code class="docutils literal notranslate"><span class="pre">[np.sum,</span> <span class="pre">'mean']</span></code></p></li>
<li><p>dict of axis labels -&gt; functions, function names or list of such.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
<li><p><strong>*args</strong> – Positional arguments to pass to <cite>func</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to <cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The return can be:</p>
<ul class="simple">
<li><p>scalar : when DeferredSeries.agg is called with single function</p></li>
<li><p>DeferredSeries : when DeferredDataFrame.agg is called with a single function</p></li>
<li><p>DeferredDataFrame : when DeferredDataFrame.agg is called with several functions</p></li>
</ul>
<p>Return scalar, DeferredSeries or DeferredDataFrame.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Some aggregation methods cannot be parallelized, and computing
them will require collecting all data on a single machine.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.apply" title="apache_beam.dataframe.frames.DeferredSeries.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.apply</span></code></a></dt><dd><p>Invoke function on a DeferredSeries.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.transform</span></code></dt><dd><p>Transform function producing a DeferredSeries with like indexes.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The aggregation operations are always performed over an axis, either the
index (default) or the column axis. This behavior is different from
<cite>numpy</cite> aggregation functions (<cite>mean</cite>, <cite>median</cite>, <cite>prod</cite>, <cite>sum</cite>, <cite>std</cite>,
<cite>var</cite>), where the default is to compute the aggregation of the flattened
array, e.g., <code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d)</span></code> as opposed to
<code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d,</span> <span class="pre">axis=0)</span></code>.</p>
<p><cite>agg</cite> is an alias for <cite>aggregate</cite>. Use the alias.</p>
<p>Functions that mutate the passed object can produce unexpected
behavior or errors and are not supported. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/gotchas.html#gotchas-udf-mutation" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span>Mutating with User Defined Function (UDF) methods</span></a>
for more details.</p>
<p>A passed user-defined-function will be passed a DeferredSeries for evaluation.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="go">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">])</span>
<span class="go">min   1</span>
<span class="go">max   4</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.axes" title="Link to this definition">¶</a></dt>
<dd><p>Return a list of the row axis labels.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.clip">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.clip" title="Link to this definition">¶</a></dt>
<dd><p>Trim values at input threshold(s).</p>
<p>Assigns values outside boundary to boundary values. Thresholds
can be singular values or array like, and in the latter case
the clipping is performed element-wise in the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default None</em>) – Minimum threshold value. All values below this
threshold will be set to it. A missing
threshold (e.g <cite>NA</cite>) will not clip the value.</p></li>
<li><p><strong>upper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default None</em>) – Maximum threshold value. All values above this
threshold will be set to it. A missing
threshold (e.g <cite>NA</cite>) will not clip the value.</p></li>
<li><p><strong>axis</strong> (<em>{{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}}</em><em>, </em><em>default None</em>) – Align object with lower and upper along the given axis.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to perform the operation in place on the data.</p></li>
<li><p><strong>*args</strong> – Additional keywords have no effect but might be accepted
for compatibility with numpy.</p></li>
<li><p><strong>**kwargs</strong> – Additional keywords have no effect but might be accepted
for compatibility with numpy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same type as calling object with the values outside the
clip boundaries replaced or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.clip" title="apache_beam.dataframe.frames.DeferredSeries.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.clip</span></code></a></dt><dd><p>Trim values at input threshold in series.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.clip" title="apache_beam.dataframe.frames.DeferredDataFrame.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.clip</span></code></a></dt><dd><p>Trim values at input threshold in dataframe.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.clip</span></code></a></dt><dd><p>Clip (limit) the values in an array.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;col_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      9     -2</span>
<span class="go">1     -3     -7</span>
<span class="go">2      0      6</span>
<span class="go">3     -1      8</span>
<span class="go">4      5     -5</span>

<span class="go">Clips per column using lower and upper thresholds:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      6     -2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      6</span>
<span class="go">3     -1      6</span>
<span class="go">4      5     -4</span>

<span class="go">Clips using specific lower and upper thresholds per column element:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">0    2</span>
<span class="go">1   -4</span>
<span class="go">2   -1</span>
<span class="go">3    6</span>
<span class="go">4    3</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      6      2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      3</span>
<span class="go">3      6      8</span>
<span class="go">4      5      3</span>

<span class="go">Clips using specific lower threshold per column element, with missing values:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">0    2.0</span>
<span class="go">1   -4.0</span>
<span class="go">2    NaN</span>
<span class="go">3    6.0</span>
<span class="go">4    3.0</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">col_0  col_1</span>
<span class="go">0      9      2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      6</span>
<span class="go">3      6      8</span>
<span class="go">4      5      3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.all">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.all" title="Link to this definition">¶</a></dt>
<dd><p>Return whether all elements are True, potentially over an axis.</p>
<p>Returns True unless there at least one element within a series or
along a Dataframe axis that is False or equivalent (e.g. zero or
empty).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default 0</em>) – <p>Indicate which axis or axes should be reduced. For <cite>DeferredSeries</cite> this parameter
is unused and defaults to 0.</p>
<ul>
<li><p>0 / ‘index’ : reduce the index, return a DeferredSeries whose index is the
original column labels.</p></li>
<li><p>1 / ‘columns’ : reduce the columns, return a DeferredSeries whose index is the
original index.</p></li>
<li><p>None : reduce all axes, return a scalar.</p></li>
</ul>
</p></li>
<li><p><strong>bool_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire row/column is NA and skipna is
True, then the result will be True, as for an empty row/column.
If skipna is False, then NA are treated as True, because these are not
equal to zero.</p></li>
<li><p><strong>**kwargs</strong> (<em>any</em><em>, </em><em>default None</em>) – Additional keywords have no effect but might be accepted for
compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If level is specified, then, DeferredSeries is returned; otherwise, scalar
is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.all" title="apache_beam.dataframe.frames.DeferredSeries.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.all</span></code></a></dt><dd><p>Return True if all elements are True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.any" title="apache_beam.dataframe.frames.DeferredDataFrame.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.any</span></code></a></dt><dd><p>Return True if one (or more) elements are True.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">**DataFrames**</span>

<span class="go">Create a dataframe from a dictionary.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col1   col2</span>
<span class="go">0  True   True</span>
<span class="go">1  True  False</span>

<span class="go">Default behaviour checks if values in each column all return True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">col1     True</span>
<span class="go">col2    False</span>
<span class="go">dtype: bool</span>

<span class="go">Specify ``axis=&#39;columns&#39;`` to check if values in each row all return True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">dtype: bool</span>

<span class="go">Or ``axis=None`` for whether every value is True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.any">
<span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.any" title="Link to this definition">¶</a></dt>
<dd><p>Return whether any element is True, potentially over an axis.</p>
<p>Returns False unless there is at least one element within a series or
along a Dataframe axis that is True or equivalent (e.g. non-zero or
non-empty).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default 0</em>) – <p>Indicate which axis or axes should be reduced. For <cite>DeferredSeries</cite> this parameter
is unused and defaults to 0.</p>
<ul>
<li><p>0 / ‘index’ : reduce the index, return a DeferredSeries whose index is the
original column labels.</p></li>
<li><p>1 / ‘columns’ : reduce the columns, return a DeferredSeries whose index is the
original index.</p></li>
<li><p>None : reduce all axes, return a scalar.</p></li>
</ul>
</p></li>
<li><p><strong>bool_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire row/column is NA and skipna is
True, then the result will be False, as for an empty row/column.
If skipna is False, then NA are treated as True, because these are not
equal to zero.</p></li>
<li><p><strong>**kwargs</strong> (<em>any</em><em>, </em><em>default None</em>) – Additional keywords have no effect but might be accepted for
compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If level is specified, then, DeferredSeries is returned; otherwise, scalar
is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.any.html#numpy.any" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.any</span></code></a></dt><dd><p>Numpy version of this method.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.any" title="apache_beam.dataframe.frames.DeferredSeries.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.any</span></code></a></dt><dd><p>Return whether any element is True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.all" title="apache_beam.dataframe.frames.DeferredSeries.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.all</span></code></a></dt><dd><p>Return whether all elements are True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.any" title="apache_beam.dataframe.frames.DeferredDataFrame.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.any</span></code></a></dt><dd><p>Return whether any element is True over requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.all" title="apache_beam.dataframe.frames.DeferredDataFrame.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.all</span></code></a></dt><dd><p>Return whether all elements are True over requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="go">For Series input, the output is a scalar indicating whether any element</span>
<span class="go">is True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">**DataFrame**</span>

<span class="go">Whether each column contains at least one True element (the default).</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B  C</span>
<span class="go">0  1  0  0</span>
<span class="go">1  2  2  0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">A     True</span>
<span class="go">B     True</span>
<span class="go">C    False</span>
<span class="go">dtype: bool</span>

<span class="go">Aggregating over the columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       A  B</span>
<span class="go">0   True  1</span>
<span class="go">1  False  2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0    True</span>
<span class="go">1    True</span>
<span class="go">dtype: bool</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       A  B</span>
<span class="go">0   True  1</span>
<span class="go">1  False  0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0    True</span>
<span class="go">1    False</span>
<span class="go">dtype: bool</span>

<span class="go">Aggregating over the entire DataFrame with ``axis=None``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">`any` for an empty DataFrame is an empty Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">Series([], dtype: bool)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.count" title="Link to this definition">¶</a></dt>
<dd><p>Return number of non-NA/null observations in the Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of non-null values in the DeferredSeries.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> (if level specified)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="apache_beam.dataframe.frames.DeferredDataFrame.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.count</span></code></a></dt><dd><p>Count non-NA cells for each column or row.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.describe" title="Link to this definition">¶</a></dt>
<dd><p>Generate descriptive statistics.</p>
<p>Descriptive statistics include those that summarize the central
tendency, dispersion and shape of a
dataset’s distribution, excluding <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.</p>
<p>Analyzes both numeric and object series, as well
as <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> column sets of mixed data types. The output
will vary depending on what is provided. Refer to the notes
below for more detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>percentiles</strong> (<em>list-like</em><em> of </em><em>numbers</em><em>, </em><em>optional</em>) – The percentiles to include in the output. All should
fall between 0 and 1. The default is
<code class="docutils literal notranslate"><span class="pre">[.25,</span> <span class="pre">.5,</span> <span class="pre">.75]</span></code>, which returns the 25th, 50th, and
75th percentiles.</p></li>
<li><p><strong>include</strong> (<em>'all'</em><em>, </em><em>list-like</em><em> of </em><em>dtypes</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em><em>, </em><em>optional</em>) – <p>A white list of data types to include in the result. Ignored
for <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>. Here are the options:</p>
<ul>
<li><p>’all’ : All columns of the input will be included in the output.</p></li>
<li><p>A list-like of dtypes : Limits the results to the
provided data types.
To limit the result to numeric types submit
<code class="docutils literal notranslate"><span class="pre">numpy.number</span></code>. To limit it instead to object columns submit
the <code class="docutils literal notranslate"><span class="pre">numpy.object</span></code> data type. Strings
can also be used in the style of
<code class="docutils literal notranslate"><span class="pre">select_dtypes</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">df.describe(include=['O'])</span></code>). To
select pandas categorical columns, use <code class="docutils literal notranslate"><span class="pre">'category'</span></code></p></li>
<li><p>None (default) : The result will include all numeric columns.</p></li>
</ul>
</p></li>
<li><p><strong>exclude</strong> (<em>list-like</em><em> of </em><em>dtypes</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em><em>, </em><em>optional</em><em>,</em>) – <p>A black list of data types to omit from the result. Ignored
for <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>. Here are the options:</p>
<ul>
<li><p>A list-like of dtypes : Excludes the provided data types
from the result. To exclude numeric types submit
<code class="docutils literal notranslate"><span class="pre">numpy.number</span></code>. To exclude object columns submit the data
type <code class="docutils literal notranslate"><span class="pre">numpy.object</span></code>. Strings can also be used in the style of
<code class="docutils literal notranslate"><span class="pre">select_dtypes</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">df.describe(exclude=['O'])</span></code>). To
exclude pandas categorical columns, use <code class="docutils literal notranslate"><span class="pre">'category'</span></code></p></li>
<li><p>None (default) : The result will exclude nothing.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summary statistics of the DeferredSeries or Dataframe provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">describe</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="apache_beam.dataframe.frames.DeferredDataFrame.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.count</span></code></a></dt><dd><p>Count number of non-NA/null observations.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Maximum of the values in the object.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Minimum of the values in the object.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mean" title="apache_beam.dataframe.frames.DeferredDataFrame.mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mean</span></code></a></dt><dd><p>Mean of the values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.std" title="apache_beam.dataframe.frames.DeferredDataFrame.std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.std</span></code></a></dt><dd><p>Standard deviation of the observations.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes" title="apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.select_dtypes</span></code></a></dt><dd><p>Subset of a DeferredDataFrame including/excluding columns based on their dtype.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For numeric data, the result’s index will include <code class="docutils literal notranslate"><span class="pre">count</span></code>,
<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code> as well as lower, <code class="docutils literal notranslate"><span class="pre">50</span></code> and
upper percentiles. By default the lower percentile is <code class="docutils literal notranslate"><span class="pre">25</span></code> and the
upper percentile is <code class="docutils literal notranslate"><span class="pre">75</span></code>. The <code class="docutils literal notranslate"><span class="pre">50</span></code> percentile is the
same as the median.</p>
<p>For object data (e.g. strings or timestamps), the result’s index
will include <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">unique</span></code>, <code class="docutils literal notranslate"><span class="pre">top</span></code>, and <code class="docutils literal notranslate"><span class="pre">freq</span></code>. The <code class="docutils literal notranslate"><span class="pre">top</span></code>
is the most common value. The <code class="docutils literal notranslate"><span class="pre">freq</span></code> is the most common value’s
frequency. Timestamps also include the <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">last</span></code> items.</p>
<p>If multiple object values have the highest count, then the
<code class="docutils literal notranslate"><span class="pre">count</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> results will be arbitrarily chosen from
among those with the highest count.</p>
<p>For mixed data types provided via a <code class="docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code>, the default is to
return only an analysis of numeric columns. If the dataframe consists
only of object and categorical data without any numeric columns, the
default is to return an analysis of both the object and categorical
columns. If <code class="docutils literal notranslate"><span class="pre">include='all'</span></code> is provided as an option, the result
will include a union of attributes of each type.</p>
<p>The <cite>include</cite> and <cite>exclude</cite> parameters can be used to limit
which columns in a <code class="docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code> are analyzed for the output.
The parameters are ignored when analyzing a <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Describing a numeric ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count    3.0</span>
<span class="go">mean     2.0</span>
<span class="go">std      1.0</span>
<span class="go">min      1.0</span>
<span class="go">25%      1.5</span>
<span class="go">50%      2.0</span>
<span class="go">75%      2.5</span>
<span class="go">max      3.0</span>
<span class="go">dtype: float64</span>

<span class="go">Describing a categorical ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count     4</span>
<span class="go">unique    3</span>
<span class="go">top       a</span>
<span class="go">freq      2</span>
<span class="go">dtype: object</span>

<span class="go">Describing a timestamp ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count                      3</span>
<span class="go">mean     2006-09-01 08:00:00</span>
<span class="go">min      2000-01-01 00:00:00</span>
<span class="go">25%      2004-12-31 12:00:00</span>
<span class="go">50%      2010-01-01 00:00:00</span>
<span class="go">75%      2010-01-01 00:00:00</span>
<span class="go">max      2010-01-01 00:00:00</span>
<span class="go">dtype: object</span>

<span class="go">Describing a ``DataFrame``. By default only numeric fields</span>
<span class="go">are returned.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;categorical&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">]),</span>
<span class="gp">... </span>                   <span class="s1">&#39;numeric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">... </span>                  <span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">       numeric</span>
<span class="go">count      3.0</span>
<span class="go">mean       2.0</span>
<span class="go">std        1.0</span>
<span class="go">min        1.0</span>
<span class="go">25%        1.5</span>
<span class="go">50%        2.0</span>
<span class="go">75%        2.5</span>
<span class="go">max        3.0</span>

<span class="go">Describing all columns of a ``DataFrame`` regardless of data type.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  
<span class="go">       categorical  numeric object</span>
<span class="go">count            3      3.0      3</span>
<span class="go">unique           3      NaN      3</span>
<span class="go">top              f      NaN      a</span>
<span class="go">freq             1      NaN      1</span>
<span class="go">mean           NaN      2.0    NaN</span>
<span class="go">std            NaN      1.0    NaN</span>
<span class="go">min            NaN      1.0    NaN</span>
<span class="go">25%            NaN      1.5    NaN</span>
<span class="go">50%            NaN      2.0    NaN</span>
<span class="go">75%            NaN      2.5    NaN</span>
<span class="go">max            NaN      3.0    NaN</span>

<span class="go">Describing a column from a ``DataFrame`` by accessing it as</span>
<span class="go">an attribute.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">numeric</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count    3.0</span>
<span class="go">mean     2.0</span>
<span class="go">std      1.0</span>
<span class="go">min      1.0</span>
<span class="go">25%      1.5</span>
<span class="go">50%      2.0</span>
<span class="go">75%      2.5</span>
<span class="go">max      3.0</span>
<span class="go">Name: numeric, dtype: float64</span>

<span class="go">Including only numeric columns in a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>
<span class="go">       numeric</span>
<span class="go">count      3.0</span>
<span class="go">mean       2.0</span>
<span class="go">std        1.0</span>
<span class="go">min        1.0</span>
<span class="go">25%        1.5</span>
<span class="go">50%        2.0</span>
<span class="go">75%        2.5</span>
<span class="go">max        3.0</span>

<span class="go">Including only string columns in a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>  
<span class="go">       object</span>
<span class="go">count       3</span>
<span class="go">unique      3</span>
<span class="go">top         a</span>
<span class="go">freq        1</span>

<span class="go">Including only categorical columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>
<span class="go">       categorical</span>
<span class="go">count            3</span>
<span class="go">unique           3</span>
<span class="go">top              d</span>
<span class="go">freq             1</span>

<span class="go">Excluding numeric columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>  
<span class="go">       categorical object</span>
<span class="go">count            3      3</span>
<span class="go">unique           3      3</span>
<span class="go">top              f      a</span>
<span class="go">freq             1      1</span>

<span class="go">Excluding object columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>  
<span class="go">       categorical  numeric</span>
<span class="go">count            3      3.0</span>
<span class="go">unique           3      NaN</span>
<span class="go">top              f      NaN</span>
<span class="go">freq             1      NaN</span>
<span class="go">mean           NaN      2.0</span>
<span class="go">std            NaN      1.0</span>
<span class="go">min            NaN      1.0</span>
<span class="go">25%            NaN      1.5</span>
<span class="go">50%            NaN      2.0</span>
<span class="go">75%            NaN      2.5</span>
<span class="go">max            NaN      3.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="Link to this definition">¶</a></dt>
<dd><p>Return the minimum of the values over the requested axis.</p>
<p>If you want the <em>index</em> of the minimum, use <code class="docutils literal notranslate"><span class="pre">idxmin</span></code>. This is the equivalent of the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> method <code class="docutils literal notranslate"><span class="pre">argmin</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="Link to this definition">¶</a></dt>
<dd><p>Return the maximum of the values over the requested axis.</p>
<p>If you want the <em>index</em> of the maximum, use <code class="docutils literal notranslate"><span class="pre">idxmax</span></code>. This is the equivalent of the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> method <code class="docutils literal notranslate"><span class="pre">argmax</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.prod">
<span class="sig-name descname"><span class="pre">prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.prod" title="Link to this definition">¶</a></dt>
<dd><p>Return the product of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default, the product of an empty or all-NA Series is ``1``</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.product">
<span class="sig-name descname"><span class="pre">product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.product" title="Link to this definition">¶</a></dt>
<dd><p>Return the product of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default, the product of an empty or all-NA Series is ``1``</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="Link to this definition">¶</a></dt>
<dd><p>Return the sum of the values over the requested axis.</p>
<p>This is equivalent to the method <code class="docutils literal notranslate"><span class="pre">numpy.sum</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">14</span>

<span class="go">By default, the sum of an empty or all-NA Series is ``0``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># min_count=0 is the default</span>
<span class="go">0.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter. For example, if</span>
<span class="go">you&#39;d like the sum of an empty series to be NaN, pass ``min_count=1``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">0.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.median">
<span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.median" title="Link to this definition">¶</a></dt>
<dd><p>Return the median of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.median()</span>
<span class="go">            2.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.median()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.median(axis=1)</span>
<span class="go">            tiger   1.5</span>
<span class="go">            zebra   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True`</span>
<span class="go">            to avoid getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.median(numeric_only=True)</span>
<span class="go">            a   1.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.median()</span>
<span class="go">        2.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.median()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.median(axis=1)</span>
<span class="go">        tiger   1.5</span>
<span class="go">        zebra   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True`</span>
<span class="go">        to avoid getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.median(numeric_only=True)</span>
<span class="go">        a   1.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">median</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.sem">
<span class="sig-name descname"><span class="pre">sem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.sem" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased standard error of the mean over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>scalar or Series (if level specified)</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">scalar or Series (if level specified)</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.sem().round(6)</span>
<span class="go">            0.57735</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.sem()</span>
<span class="go">            a   0.5</span>
<span class="go">            b   0.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.sem(axis=1)</span>
<span class="go">            tiger   0.5</span>
<span class="go">            zebra   0.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True`</span>
<span class="go">            to avoid getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.sem(numeric_only=True)</span>
<span class="go">            a   0.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.sem().round(6)</span>
<span class="go">        0.57735</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.sem()</span>
<span class="go">        a   0.5</span>
<span class="go">        b   0.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.sem(axis=1)</span>
<span class="go">        tiger   0.5</span>
<span class="go">        zebra   0.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True`</span>
<span class="go">        to avoid getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.sem(numeric_only=True)</span>
<span class="go">        a   0.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">sem</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.argmax">
<span class="sig-name descname"><span class="pre">argmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.argmax" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.argmax.html#pandas.Series.argmax" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.argmax()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.argmin">
<span class="sig-name descname"><span class="pre">argmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.argmin" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.argmin.html#pandas.Series.argmin" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.argmin()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cummax">
<span class="sig-name descname"><span class="pre">cummax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cummax" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.cummax.html#pandas.Series.cummax" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.cummax()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cummin">
<span class="sig-name descname"><span class="pre">cummin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cummin" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.cummin.html#pandas.Series.cummin" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.cummin()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cumprod">
<span class="sig-name descname"><span class="pre">cumprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cumprod" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.cumprod.html#pandas.Series.cumprod" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.cumprod()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cumsum">
<span class="sig-name descname"><span class="pre">cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cumsum" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.cumsum.html#pandas.Series.cumsum" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.cumsum()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.diff" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.diff.html#pandas.Series.diff" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.diff()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.interpolate" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.interpolate.html#pandas.Series.interpolate" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.interpolate()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.searchsorted">
<span class="sig-name descname"><span class="pre">searchsorted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.searchsorted" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.searchsorted.html#pandas.Series.searchsorted" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.searchsorted()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.shift" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.shift.html#pandas.Series.shift" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.shift()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.pct_change">
<span class="sig-name descname"><span class="pre">pct_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.pct_change" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.pct_change.html#pandas.Series.pct_change" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.pct_change()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.is_monotonic">
<span class="sig-name descname"><span class="pre">is_monotonic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.is_monotonic" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.is_monotonic()</span></code> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.is_monotonic_increasing">
<span class="sig-name descname"><span class="pre">is_monotonic_increasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.is_monotonic_increasing" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.is_monotonic_increasing()</span></code> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.is_monotonic_decreasing">
<span class="sig-name descname"><span class="pre">is_monotonic_decreasing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.is_monotonic_decreasing" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.is_monotonic_decreasing()</span></code> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.asof">
<span class="sig-name descname"><span class="pre">asof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.asof" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.asof.html#pandas.Series.asof" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.asof()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.first_valid_index">
<span class="sig-name descname"><span class="pre">first_valid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.first_valid_index" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.first_valid_index.html#pandas.Series.first_valid_index" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.first_valid_index()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.last_valid_index">
<span class="sig-name descname"><span class="pre">last_valid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.last_valid_index" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.last_valid_index.html#pandas.Series.last_valid_index" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.last_valid_index()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.autocorr">
<span class="sig-name descname"><span class="pre">autocorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.autocorr" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.autocorr.html#pandas.Series.autocorr" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.autocorr()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.iat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iat</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.iat" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.iat()</span></code> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.head">
<span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.head" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.head.html#pandas.Series.head" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.head()</span></code></a> is not yet supported in the Beam DataFrame API because it is <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>.</p>
<p>If you want to peek at a large dataset consider using interactive Beam’s <a class="reference internal" href="apache_beam.runners.interactive.interactive_beam.html#apache_beam.runners.interactive.interactive_beam.collect" title="apache_beam.runners.interactive.interactive_beam.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ib.collect</span></code></a> with <code class="docutils literal notranslate"><span class="pre">n</span></code> specified, or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sample" title="apache_beam.dataframe.frames.DeferredSeries.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>. If you want to find the N largest elements, consider using <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="apache_beam.dataframe.frames.DeferredDataFrame.nlargest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.nlargest()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.tail">
<span class="sig-name descname"><span class="pre">tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.tail" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.tail.html#pandas.Series.tail" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.tail()</span></code></a> is not yet supported in the Beam DataFrame API because it is <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>.</p>
<p>If you want to peek at a large dataset consider using interactive Beam’s <a class="reference internal" href="apache_beam.runners.interactive.interactive_beam.html#apache_beam.runners.interactive.interactive_beam.collect" title="apache_beam.runners.interactive.interactive_beam.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ib.collect</span></code></a> with <code class="docutils literal notranslate"><span class="pre">n</span></code> specified, or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sample" title="apache_beam.dataframe.frames.DeferredSeries.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>. If you want to find the N largest elements, consider using <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="apache_beam.dataframe.frames.DeferredDataFrame.nlargest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.nlargest()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.filter" title="Link to this definition">¶</a></dt>
<dd><p>Subset the dataframe rows or columns according to the specified index labels.</p>
<p>Note that this routine does not filter a dataframe on its
contents. The filter is applied to the labels of the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>list-like</em>) – Keep labels from axis which are in items.</p></li>
<li><p><strong>like</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Keep labels from axis for which “like in label == True”.</p></li>
<li><p><strong>regex</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> (</em><em>regular expression</em><em>)</em>) – Keep labels from axis for which re.search(regex, label) == True.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – The axis to filter on, expressed either as an index (int)
or axis name (str). By default this is the info axis, ‘columns’ for
DeferredDataFrame. For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>same type as input object</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.loc</span></code></dt><dd><p>Access a group of rows and columns by label(s) or a boolean array.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">like</span></code>, and <code class="docutils literal notranslate"><span class="pre">regex</span></code> parameters are
enforced to be mutually exclusive.</p>
<p><code class="docutils literal notranslate"><span class="pre">axis</span></code> defaults to the info axis that is used when indexing
with <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])),</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;rabbit&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        one  two  three</span>
<span class="go">mouse     1    2      3</span>
<span class="go">rabbit    4    5      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select columns by name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="go">         one  three</span>
<span class="go">mouse     1      3</span>
<span class="go">rabbit    4      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select columns by regular expression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;e$&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">         one  three</span>
<span class="go">mouse     1      3</span>
<span class="go">rabbit    4      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select rows containing &#39;bbi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;bbi&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">         one  two  three</span>
<span class="go">rabbit    4    5      6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.memory_usage">
<span class="sig-name descname"><span class="pre">memory_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.memory_usage" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.memory_usage.html#pandas.Series.memory_usage" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.memory_usage()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.nbytes">
<span class="sig-name descname"><span class="pre">nbytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.nbytes" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.nbytes()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_list">
<span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_list" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_list.html#pandas.Series.to_list" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_list()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.factorize">
<span class="sig-name descname"><span class="pre">factorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.factorize" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.factorize.html#pandas.Series.factorize" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.factorize()</span></code></a> is not yet supported in the Beam DataFrame API because the columns in the output DataFrame depend on the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-columns">https://s.apache.org/dataframe-non-deferred-columns</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.nlargest">
<span class="sig-name descname"><span class="pre">nlargest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.nlargest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.nlargest" title="Link to this definition">¶</a></dt>
<dd><p>Return the largest <cite>n</cite> elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 5</em>) – Return this many descending sorted values.</p></li>
<li><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>'all'}</em><em>, </em><em>default 'first'</em>) – <p>When there are duplicate values that cannot all fit in a
DeferredSeries of <cite>n</cite> elements:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first</span></code> : return the first <cite>n</cite> occurrences in order
of appearance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last</span></code> : return the last <cite>n</cite> occurrences in reverse
order of appearance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> : keep all occurrences. This can result in a DeferredSeries of
size larger than <cite>n</cite>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>n</cite> largest values in the DeferredSeries, sorted in decreasing order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.nsmallest" title="apache_beam.dataframe.frames.DeferredSeries.nsmallest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.nsmallest</span></code></a></dt><dd><p>Get the <cite>n</cite> smallest elements.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sort_values</span></code></dt><dd><p>Sort DeferredSeries by values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.head" title="apache_beam.dataframe.frames.DeferredSeries.head"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.head</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Faster than <code class="docutils literal notranslate"><span class="pre">.sort_values(ascending=False).head(n)</span></code> for small <cite>n</cite>
relative to the size of the <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code> object.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">countries_population</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Italy&quot;</span><span class="p">:</span> <span class="mi">59000000</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">:</span> <span class="mi">65000000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Malta&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span> <span class="s2">&quot;Maldives&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Brunei&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span> <span class="s2">&quot;Iceland&quot;</span><span class="p">:</span> <span class="mi">337000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Nauru&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span> <span class="s2">&quot;Tuvalu&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Anguilla&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span> <span class="s2">&quot;Montserrat&quot;</span><span class="p">:</span> <span class="mi">5200</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">countries_population</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">Italy       59000000</span>
<span class="go">France      65000000</span>
<span class="go">Malta         434000</span>
<span class="go">Maldives      434000</span>
<span class="go">Brunei        434000</span>
<span class="go">Iceland       337000</span>
<span class="go">Nauru          11300</span>
<span class="go">Tuvalu         11300</span>
<span class="go">Anguilla       11300</span>
<span class="go">Montserrat      5200</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` largest elements where ``n=5`` by default.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">()</span>
<span class="go">France      65000000</span>
<span class="go">Italy       59000000</span>
<span class="go">Malta         434000</span>
<span class="go">Maldives      434000</span>
<span class="go">Brunei        434000</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` largest elements where ``n=3``. Default `keep` value is &#39;first&#39;</span>
<span class="go">so Malta will be kept.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">France    65000000</span>
<span class="go">Italy     59000000</span>
<span class="go">Malta       434000</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` largest elements where ``n=3`` and keeping the last duplicates.</span>
<span class="go">Brunei will be kept since it is the last with value 434000 based on</span>
<span class="go">the index order.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">France      65000000</span>
<span class="go">Italy       59000000</span>
<span class="go">Brunei        434000</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` largest elements where ``n=3`` with all duplicates kept. Note</span>
<span class="go">that the returned Series has five elements due to the three duplicates.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">France      65000000</span>
<span class="go">Italy       59000000</span>
<span class="go">Malta         434000</span>
<span class="go">Maldives      434000</span>
<span class="go">Brunei        434000</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.nsmallest">
<span class="sig-name descname"><span class="pre">nsmallest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.nsmallest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.nsmallest" title="Link to this definition">¶</a></dt>
<dd><p>Return the smallest <cite>n</cite> elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 5</em>) – Return this many ascending sorted values.</p></li>
<li><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>'all'}</em><em>, </em><em>default 'first'</em>) – <p>When there are duplicate values that cannot all fit in a
DeferredSeries of <cite>n</cite> elements:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first</span></code> : return the first <cite>n</cite> occurrences in order
of appearance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last</span></code> : return the last <cite>n</cite> occurrences in reverse
order of appearance.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> : keep all occurrences. This can result in a DeferredSeries of
size larger than <cite>n</cite>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The <cite>n</cite> smallest values in the DeferredSeries, sorted in increasing order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.nlargest" title="apache_beam.dataframe.frames.DeferredSeries.nlargest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.nlargest</span></code></a></dt><dd><p>Get the <cite>n</cite> largest elements.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sort_values</span></code></dt><dd><p>Sort DeferredSeries by values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.head" title="apache_beam.dataframe.frames.DeferredSeries.head"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.head</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Faster than <code class="docutils literal notranslate"><span class="pre">.sort_values().head(n)</span></code> for small <cite>n</cite> relative to
the size of the <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code> object.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">countries_population</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Italy&quot;</span><span class="p">:</span> <span class="mi">59000000</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">:</span> <span class="mi">65000000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Brunei&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span> <span class="s2">&quot;Malta&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Maldives&quot;</span><span class="p">:</span> <span class="mi">434000</span><span class="p">,</span> <span class="s2">&quot;Iceland&quot;</span><span class="p">:</span> <span class="mi">337000</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Nauru&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span> <span class="s2">&quot;Tuvalu&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="s2">&quot;Anguilla&quot;</span><span class="p">:</span> <span class="mi">11300</span><span class="p">,</span> <span class="s2">&quot;Montserrat&quot;</span><span class="p">:</span> <span class="mi">5200</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">countries_population</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">Italy       59000000</span>
<span class="go">France      65000000</span>
<span class="go">Brunei        434000</span>
<span class="go">Malta         434000</span>
<span class="go">Maldives      434000</span>
<span class="go">Iceland       337000</span>
<span class="go">Nauru          11300</span>
<span class="go">Tuvalu         11300</span>
<span class="go">Anguilla       11300</span>
<span class="go">Montserrat      5200</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` smallest elements where ``n=5`` by default.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">()</span>
<span class="go">Montserrat    5200</span>
<span class="go">Nauru        11300</span>
<span class="go">Tuvalu       11300</span>
<span class="go">Anguilla     11300</span>
<span class="go">Iceland     337000</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` smallest elements where ``n=3``. Default `keep` value is</span>
<span class="go">&#39;first&#39; so Nauru and Tuvalu will be kept.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Montserrat   5200</span>
<span class="go">Nauru       11300</span>
<span class="go">Tuvalu      11300</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` smallest elements where ``n=3`` and keeping the last</span>
<span class="go">duplicates. Anguilla and Tuvalu will be kept since they are the last</span>
<span class="go">with value 11300 based on the index order.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">Montserrat   5200</span>
<span class="go">Anguilla    11300</span>
<span class="go">Tuvalu      11300</span>
<span class="go">dtype: int64</span>

<span class="go">The `n` smallest elements where ``n=3`` with all duplicates kept. Note</span>
<span class="go">that the returned Series has four elements due to the three duplicates.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">Montserrat   5200</span>
<span class="go">Nauru       11300</span>
<span class="go">Tuvalu      11300</span>
<span class="go">Anguilla    11300</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.is_unique">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_unique</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.is_unique" title="Link to this definition">¶</a></dt>
<dd><p>Return boolean if values in the object are unique.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">is_unique</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">is_unique</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.plot" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.plot.html#pandas.Series.plot" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.plot()</span></code></a> is not yet supported in the Beam DataFrame API because it is a plotting tool.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-plotting-tools">https://s.apache.org/dataframe-plotting-tools</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.pop" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.pop.html#pandas.Series.pop" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.pop()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rename_axis">
<span class="sig-name descname"><span class="pre">rename_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rename_axis" title="Link to this definition">¶</a></dt>
<dd><p>Set the name of the axis for the index or columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapper</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>optional</em>) – Value to set the axis name attribute.</p></li>
<li><p><strong>index</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>dict-like</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>A scalar, list-like, dict-like or functions transformations to
apply to that axis’ values.
Note that the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter is not allowed if the
object is a DeferredSeries. This parameter only apply for DeferredDataFrame
type objects.</p>
<p>Use either <code class="docutils literal notranslate"><span class="pre">mapper</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> to
specify the axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, or <code class="docutils literal notranslate"><span class="pre">index</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
</p></li>
<li><p><strong>columns</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>dict-like</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>A scalar, list-like, dict-like or functions transformations to
apply to that axis’ values.
Note that the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter is not allowed if the
object is a DeferredSeries. This parameter only apply for DeferredDataFrame
type objects.</p>
<p>Use either <code class="docutils literal notranslate"><span class="pre">mapper</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> to
specify the axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, or <code class="docutils literal notranslate"><span class="pre">index</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to rename. For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default None</em>) – Also copy underlying data.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Modifies the object directly, instead of creating a new DeferredSeries
or DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The same type as the caller or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a>, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a>, or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rename" title="apache_beam.dataframe.frames.DeferredSeries.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rename</span></code></a></dt><dd><p>Alter DeferredSeries index labels or name.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename" title="apache_beam.dataframe.frames.DeferredDataFrame.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.rename</span></code></a></dt><dd><p>Alter DeferredDataFrame index labels or name.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.rename</span></code></dt><dd><p>Set new names on index.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">DeferredDataFrame.rename_axis</span></code> supports two calling conventions</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(index=index_mapper,</span> <span class="pre">columns=columns_mapper,</span> <span class="pre">...)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(mapper,</span> <span class="pre">axis={'index',</span> <span class="pre">'columns'},</span> <span class="pre">...)</span></code></p></li>
</ul>
<p>The first calling convention will only modify the names of
the index and/or the names of the Index object that is the columns.
In this case, the parameter <code class="docutils literal notranslate"><span class="pre">copy</span></code> is ignored.</p>
<p>The second calling convention will modify the names of the
corresponding index if mapper is a list or a scalar.
However, if mapper is dict-like or a function, it will use the
deprecated behavior of modifying the axis <em>labels</em>.</p>
<p>We <em>highly</em> recommend using keyword arguments to clarify your
intent.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0       dog</span>
<span class="go">1       cat</span>
<span class="go">2    monkey</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;animal&quot;</span><span class="p">)</span>
<span class="go">animal</span>
<span class="go">0    dog</span>
<span class="go">1    cat</span>
<span class="go">2    monkey</span>
<span class="go">dtype: object</span>

<span class="go">**DataFrame**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;num_legs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;num_arms&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_arms</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;animal&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_arms</span>
<span class="go">animal</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;limbs&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">limbs   num_legs  num_arms</span>
<span class="go">animal</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>

<span class="go">**MultiIndex**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;mammal&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;monkey&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                                      <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">limbs          num_legs  num_arms</span>
<span class="go">type   name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">})</span>
<span class="go">limbs          num_legs  num_arms</span>
<span class="go">class  name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
<span class="go">LIMBS          num_legs  num_arms</span>
<span class="go">type   name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.round">
<span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.round" title="Link to this definition">¶</a></dt>
<dd><p>Round each value in a Series to the given number of decimals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decimals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – Number of decimal places to round to. If decimals is negative,
it specifies the number of positions to the left of the decimal point.</p></li>
<li><p><strong>*args</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments and keywords have no effect but might be
accepted for compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rounded values of the DeferredSeries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.around.html#numpy.around" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.around</span></code></a></dt><dd><p>Round values of an np.array.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.round" title="apache_beam.dataframe.frames.DeferredDataFrame.round"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.round</span></code></a></dt><dd><p>Round values of a DeferredDataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="go">0    0.0</span>
<span class="go">1    1.0</span>
<span class="go">2    3.0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.take">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.take" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.take.html#pandas.Series.take" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.take()</span></code></a> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_dict" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_dict.html#pandas.Series.to_dict" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_dict()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_frame">
<span class="sig-name descname"><span class="pre">to_frame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_frame" title="Link to this definition">¶</a></dt>
<dd><p>Convert Series to DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a><em>, </em><em>optional</em>) – The passed name should substitute for the series name (if it has
one).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredDataFrame representation of DeferredSeries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
<span class="gp">... </span>              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;vals&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="go">  vals</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.unique">
<span class="sig-name descname"><span class="pre">unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">as_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.unique"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.unique" title="Link to this definition">¶</a></dt>
<dd><p>Return unique values of Series object.</p>
<p>Uniques are returned in order of appearance. Hash table-based unique,
therefore does NOT sort.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The unique values returned as a NumPy array. See Notes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray or ExtensionArray</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>unique is not supported by default because it produces a
non-deferred result: an <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>. You can use the
Beam-specific argument <code class="docutils literal notranslate"><span class="pre">unique(as_series=True)</span></code> to get the result as
a <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.drop_duplicates" title="apache_beam.dataframe.frames.DeferredSeries.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.drop_duplicates</span></code></a></dt><dd><p>Return DeferredSeries with duplicate values removed.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.unique" title="apache_beam.dataframe.frames.DeferredSeries.unique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unique</span></code></a></dt><dd><p>Top-level unique method for any 1-d array-like object.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.unique</span></code></dt><dd><p>Return Index with unique values from an Index object.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Returns the unique values as a NumPy array. In case of an
extension-array backed DeferredSeries, a new
<code class="xref py py-class docutils literal notranslate"><span class="pre">ExtensionArray</span></code> of that type with just
the unique values is returned. This includes</p>
<blockquote>
<div><ul class="simple">
<li><p>Categorical</p></li>
<li><p>Period</p></li>
<li><p>Datetime with Timezone</p></li>
<li><p>Datetime without Timezone</p></li>
<li><p>Timedelta</p></li>
<li><p>Interval</p></li>
<li><p>Sparse</p></li>
<li><p>IntegerNA</p></li>
</ul>
</div></blockquote>
<p>See Examples section.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="go">array([2, 1, 3])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="go">&lt;DatetimeArray&gt;</span>
<span class="go">[&#39;2016-01-01 00:00:00&#39;]</span>
<span class="go">Length: 1, dtype: datetime64[ns]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2016-01-01&#39;</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="go">&lt;DatetimeArray&gt;</span>
<span class="go">[&#39;2016-01-01 00:00:00-05:00&#39;]</span>
<span class="go">Length: 1, dtype: datetime64[ns, US/Eastern]</span>

<span class="go">An Categorical will return categories in the order of</span>
<span class="go">appearance and with the same dtype.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;baabc&#39;</span><span class="p">)))</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="go">[&#39;b&#39;, &#39;a&#39;, &#39;c&#39;]</span>
<span class="go">Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;baabc&#39;</span><span class="p">),</span> <span class="n">categories</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="go">[&#39;b&#39;, &#39;a&#39;, &#39;c&#39;]</span>
<span class="go">Categories (3, object): [&#39;a&#39; &lt; &#39;b&#39; &lt; &#39;c&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.update" title="Link to this definition">¶</a></dt>
<dd><p>Modify Series in place using values from passed Series.</p>
<p>Uses non-NA values from passed Series to make updates. Aligns
on index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><em>object coercible into DeferredSeries</em>)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">2    6</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    d</span>
<span class="go">1    b</span>
<span class="go">2    e</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">2    6</span>
<span class="go">dtype: int64</span>

<span class="go">If ``other`` contains NaNs the corresponding values are not updated</span>
<span class="go">in the original Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    4</span>
<span class="go">1    2</span>
<span class="go">2    6</span>
<span class="go">dtype: int64</span>

<span class="go">``other`` can also be a non-Series object type</span>
<span class="go">that is coercible into a Series</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    4</span>
<span class="go">1    2</span>
<span class="go">2    6</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    9</span>
<span class="go">2    3</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.value_counts">
<span class="sig-name descname"><span class="pre">value_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.value_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.value_counts" title="Link to this definition">¶</a></dt>
<dd><p>Return a Series containing counts of unique values.</p>
<p>The resulting object will be in descending order so that the
first element is the most frequently-occurring element.
Excludes NA values by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If True then the object returned will contain the relative
frequencies of the unique values.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Sort by frequencies when True. Preserve the order of the data when False.</p></li>
<li><p><strong>ascending</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Sort in ascending order.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Rather than count values, group them into half-open bins,
a convenience for <code class="docutils literal notranslate"><span class="pre">pd.cut</span></code>, only works with numeric data.</p></li>
<li><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Don’t include counts of NaN.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">sort</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, and <code class="docutils literal notranslate"><span class="pre">sort=True</span></code> is not supported
because it imposes an ordering on the dataset which likely will not be
preserved.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">bin</span></code> is specified this operation is not parallelizable. See
[Issue 20903](<a class="reference external" href="https://github.com/apache/beam/issues/20903">https://github.com/apache/beam/issues/20903</a>) tracking the
possible addition of a distributed implementation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.count" title="apache_beam.dataframe.frames.DeferredSeries.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.count</span></code></a></dt><dd><p>Number of non-NA elements in a DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="apache_beam.dataframe.frames.DeferredDataFrame.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.count</span></code></a></dt><dd><p>Number of non-NA elements in a DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.value_counts" title="apache_beam.dataframe.frames.DeferredDataFrame.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.value_counts</span></code></a></dt><dd><p>Equivalent method on DeferredDataFrames.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="go">3.0    2</span>
<span class="go">1.0    1</span>
<span class="go">2.0    1</span>
<span class="go">4.0    1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="go">With `normalize` set to `True`, returns the relative frequency by</span>
<span class="go">dividing all values by the sum of values.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">3.0    0.4</span>
<span class="go">1.0    0.2</span>
<span class="go">2.0    0.2</span>
<span class="go">4.0    0.2</span>
<span class="go">Name: proportion, dtype: float64</span>

<span class="go">**bins**</span>

<span class="go">Bins can be useful for going from a continuous variable to a</span>
<span class="go">categorical variable; instead of counting unique</span>
<span class="go">apparitions of values, divide the index in the specified</span>
<span class="go">number of half-open bins.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(0.996, 2.0]    2</span>
<span class="go">(2.0, 3.0]      2</span>
<span class="go">(3.0, 4.0]      1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="go">**dropna**</span>

<span class="go">With `dropna` set to `False` we can also see NaN index values.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">3.0    2</span>
<span class="go">1.0    1</span>
<span class="go">2.0    1</span>
<span class="go">4.0    1</span>
<span class="go">NaN    1</span>
<span class="go">Name: count, dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.values" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.values()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.view" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.view()</span></code> is not yet supported in the Beam DataFrame API because it relies on memory-sharing semantics that are not compatible with the Beam model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.str">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">str</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.str" title="Link to this definition">¶</a></dt>
<dd><p>Vectorized string functions for Series and Index.</p>
<p>NAs stay NA unless handled otherwise by a particular method.
Patterned after Python’s string methods, with some inspiration from
R’s stringr package.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;A_Str_Series&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    A_Str_Series</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<span class="go">0    [A, Str, Series]</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="go">0    AStrSeries</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.cat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cat</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.cat" title="Link to this definition">¶</a></dt>
<dd><p>Accessor object for categorical properties of the Series values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>CategoricalIndex</em>)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abbccc&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span>
<span class="go">Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">rename_categories</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;cba&quot;</span><span class="p">))</span>
<span class="go">0    c</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    a</span>
<span class="go">4    a</span>
<span class="go">5    a</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">reorder_categories</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;cba&quot;</span><span class="p">))</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">([</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (5, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_categories</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">])</span>
<span class="go">0    NaN</span>
<span class="go">1      b</span>
<span class="go">2      b</span>
<span class="go">3    NaN</span>
<span class="go">4    NaN</span>
<span class="go">5    NaN</span>
<span class="go">dtype: category</span>
<span class="go">Categories (1, object): [&#39;b&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">([</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">remove_unused_categories</span><span class="p">()</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">set_categories</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcde&quot;</span><span class="p">))</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (5, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">as_ordered</span><span class="p">()</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;a&#39; &lt; &#39;b&#39; &lt; &#39;c&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">as_unordered</span><span class="p">()</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    b</span>
<span class="go">3    c</span>
<span class="go">4    c</span>
<span class="go">5    c</span>
<span class="go">dtype: category</span>
<span class="go">Categories (3, object): [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.dt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.mode" title="Link to this definition">¶</a></dt>
<dd><p>Return the mode(s) of the Series.</p>
<p>The mode is the value that appears most often. There can be multiple modes.</p>
<p>Always returns Series even if only one value is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Don’t consider counts of NaN/NaT.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modes of the DeferredSeries in sorted order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>mode is not currently parallelizable. An approximate,
parallelizable implementation of mode may be added in the future
(<a class="reference external" href="https://github.com/apache/beam/issues/20946">Issue 20946</a>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="go">0    2.0</span>
<span class="go">dtype: float64</span>

<span class="go">More than one mode:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="go">0    2.0</span>
<span class="go">1    4.0</span>
<span class="go">dtype: float64</span>

<span class="go">With and without considering null value:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0   NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="go">0    4.0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.apply" title="Link to this definition">¶</a></dt>
<dd><p>Invoke function on values of Series.</p>
<p>Can be ufunc (a NumPy function that applies to the entire Series)
or a Python function that only works on single values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em>) – Python function or NumPy ufunc to apply.</p></li>
<li><p><strong>convert_dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – <p>Try to find better dtype for elementwise function results. If
False, leave as dtype=object. Note that the dtype is always
preserved for some extension array dtypes, such as Categorical.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.0: </span><code class="docutils literal notranslate"><span class="pre">convert_dtype</span></code> has been deprecated. Do <code class="docutils literal notranslate"><span class="pre">ser.astype(object).apply()</span></code>
instead if you want <code class="docutils literal notranslate"><span class="pre">convert_dtype=False</span></code>.</p>
</div>
</p></li>
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – Positional arguments passed to func after the series value.</p></li>
<li><p><strong>by_row</strong> (<em>False</em><em> or </em><em>&quot;compat&quot;</em><em>, </em><em>default &quot;compat&quot;</em>) – <p>If <code class="docutils literal notranslate"><span class="pre">&quot;compat&quot;</span></code> and func is a callable, func will be passed each element of
the DeferredSeries, like <code class="docutils literal notranslate"><span class="pre">DeferredSeries.map</span></code>. If func is a list or dict of
callables, will first try to translate each func into pandas methods. If
that doesn’t work, will try call to apply again with <code class="docutils literal notranslate"><span class="pre">by_row=&quot;compat&quot;</span></code>
and if that fails, will call apply again with <code class="docutils literal notranslate"><span class="pre">by_row=False</span></code>
(backward compatible).
If False, the func will be passed the whole DeferredSeries at once.</p>
<p><code class="docutils literal notranslate"><span class="pre">by_row</span></code> has no effect when <code class="docutils literal notranslate"><span class="pre">func</span></code> is a string.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.1.0.</span></p>
</div>
</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to func.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If func returns a DeferredSeries object the result will be a DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.map" title="apache_beam.dataframe.frames.DeferredSeries.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.map</span></code></a></dt><dd><p>For element-wise operations.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.agg" title="apache_beam.dataframe.frames.DeferredSeries.agg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.agg</span></code></a></dt><dd><p>Only perform aggregating type operations.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.transform</span></code></dt><dd><p>Only perform transforming type operations.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Functions that mutate the passed object can produce unexpected
behavior or errors and are not supported. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/gotchas.html#gotchas-udf-mutation" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span>Mutating with User Defined Function (UDF) methods</span></a>
for more details.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Create a series with typical summer temperatures for each city.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">... </span>              <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Helsinki&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">London      20</span>
<span class="go">New York    21</span>
<span class="go">Helsinki    12</span>
<span class="go">dtype: int64</span>

<span class="go">Square the values by defining a function and passing it as an</span>
<span class="go">argument to ``apply()``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
<span class="go">London      400</span>
<span class="go">New York    441</span>
<span class="go">Helsinki    144</span>
<span class="go">dtype: int64</span>

<span class="go">Square the values by passing an anonymous function as an</span>
<span class="go">argument to ``apply()``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">London      400</span>
<span class="go">New York    441</span>
<span class="go">Helsinki    144</span>
<span class="go">dtype: int64</span>

<span class="go">Define a custom function that needs additional positional</span>
<span class="go">arguments and pass these additional arguments using the</span>
<span class="go">``args`` keyword.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">subtract_custom_value</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">custom_value</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">custom_value</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subtract_custom_value</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>
<span class="go">London      15</span>
<span class="go">New York    16</span>
<span class="go">Helsinki     7</span>
<span class="go">dtype: int64</span>

<span class="go">Define a custom function that takes keyword arguments</span>
<span class="go">and pass these arguments to ``apply``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">add_custom_values</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">x</span> <span class="o">+=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">month</span><span class="p">]</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">add_custom_values</span><span class="p">,</span> <span class="n">june</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">july</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">august</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="go">London      95</span>
<span class="go">New York    96</span>
<span class="go">Helsinki    87</span>
<span class="go">dtype: int64</span>

<span class="go">Use a function from the Numpy library.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
<span class="go">London      2.995732</span>
<span class="go">New York    3.044522</span>
<span class="go">Helsinki    2.484907</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.map" title="Link to this definition">¶</a></dt>
<dd><p>Map values of Series according to an input mapping or function.</p>
<p>Used for substituting each value in a Series with another value,
that may be derived from a function, a <code class="docutils literal notranslate"><span class="pre">dict</span></code> or
a <code class="xref py py-class docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arg</strong> (<em>function</em><em>, </em><em>collections.abc.Mapping subclass</em><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – Mapping correspondence.</p></li>
<li><p><strong>na_action</strong> (<em>{None</em><em>, </em><em>'ignore'}</em><em>, </em><em>default None</em>) – If ‘ignore’, propagate NaN values, without passing them to the
mapping correspondence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same index as caller.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.apply" title="apache_beam.dataframe.frames.DeferredSeries.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.apply</span></code></a></dt><dd><p>For applying more complex functions on a DeferredSeries.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.replace</span></code></dt><dd><p>Replace values given in <cite>to_replace</cite> with <cite>value</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="apache_beam.dataframe.frames.DeferredDataFrame.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.apply</span></code></a></dt><dd><p>Apply a function row-/column-wise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.map" title="apache_beam.dataframe.frames.DeferredDataFrame.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.map</span></code></a></dt><dd><p>Apply a function elementwise on a whole DeferredDataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>When <code class="docutils literal notranslate"><span class="pre">arg</span></code> is a dictionary, values in DeferredSeries that are not in the
dictionary (as keys) are converted to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. However, if the
dictionary is a <code class="docutils literal notranslate"><span class="pre">dict</span></code> subclass that defines <code class="docutils literal notranslate"><span class="pre">__missing__</span></code> (i.e.
provides a method for default values), then this default is used
rather than <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;rabbit&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0      cat</span>
<span class="go">1      dog</span>
<span class="go">2      NaN</span>
<span class="go">3   rabbit</span>
<span class="go">dtype: object</span>

<span class="go">``map`` accepts a ``dict`` or a ``Series``. Values that are not found</span>
<span class="go">in the ``dict`` are converted to ``NaN``, unless the dict has a default</span>
<span class="go">value (e.g. ``defaultdict``):</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;cat&#39;</span><span class="p">:</span> <span class="s1">&#39;kitten&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="s1">&#39;puppy&#39;</span><span class="p">})</span>
<span class="go">0   kitten</span>
<span class="go">1    puppy</span>
<span class="go">2      NaN</span>
<span class="go">3      NaN</span>
<span class="go">dtype: object</span>

<span class="go">It also accepts a function:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;I am a </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="go">0       I am a cat</span>
<span class="go">1       I am a dog</span>
<span class="go">2       I am a nan</span>
<span class="go">3    I am a rabbit</span>
<span class="go">dtype: object</span>

<span class="go">To avoid applying the function to missing values (and keep them as</span>
<span class="go">``NaN``) ``na_action=&#39;ignore&#39;`` can be used:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;I am a </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">na_action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="go">0     I am a cat</span>
<span class="go">1     I am a dog</span>
<span class="go">2            NaN</span>
<span class="go">3  I am a rabbit</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repeats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.repeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.repeat" title="Link to this definition">¶</a></dt>
<dd><p>Repeat elements of a Series.</p>
<p>Returns a new Series where each element of the current Series
is repeated consecutively a given number of times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>array</em><em> of </em><em>ints</em>) – The number of repetitions for each element. This should be a
non-negative integer. Repeating 0 times will return an empty
DeferredSeries.</p></li>
<li><p><strong>axis</strong> (<em>None</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Newly created DeferredSeries with repeated elements.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">repeats</span></code> must be an <code class="docutils literal notranslate"><span class="pre">int</span></code> or a <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a>. Lists are
not supported because they make this operation order-sensitive.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.repeat</span></code></dt><dd><p>Equivalent function for Index.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.repeat.html#numpy.repeat" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.repeat</span></code></a></dt><dd><p>Similar method for <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0    a</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
<span class="go">2    c</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">0    a</span>
<span class="go">1    b</span>
<span class="go">1    b</span>
<span class="go">2    c</span>
<span class="go">2    c</span>
<span class="go">2    c</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredSeries.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.compare" title="Link to this definition">¶</a></dt>
<dd><p>Compare to another Series and show the differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – Object to compare with.</p></li>
<li><p><strong>align_axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 1</em>) – <p>Determine which axis to align the comparison on.</p>
<ul>
<li><dl class="simple">
<dt>0, or ‘index’<span class="classifier">Resulting differences are stacked vertically</span></dt><dd><p>with rows drawn alternately from self and other.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>1, or ‘columns’<span class="classifier">Resulting differences are aligned horizontally</span></dt><dd><p>with columns drawn alternately from self and other.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>keep_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If true, all rows and columns are kept.
Otherwise, only the ones with different values are kept.</p></li>
<li><p><strong>keep_equal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If true, the result keeps values that are equal.
Otherwise, equal values are shown as NaNs.</p></li>
<li><p><strong>result_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>default</em><em> (</em><em>'self'</em><em>, </em><em>'other'</em><em>)</em>) – <p>Set the dataframes names in the comparison.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>If axis is 0 or ‘index’ the result will be a DeferredSeries.
The resulting index will be a MultiIndex with ‘self’ and ‘other’
stacked alternately at the inner level.</p>
<p>If axis is 1 or ‘columns’ the result will be a DeferredDataFrame.
It will have two columns namely ‘self’ and ‘other’.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.compare" title="apache_beam.dataframe.frames.DeferredDataFrame.compare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.compare</span></code></a></dt><dd><p>Compare with another DeferredDataFrame and show differences.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Matching NaNs will not appear as a difference.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">])</span>

<span class="go">Align the differences on columns</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">  self other</span>
<span class="go">1    b     a</span>
<span class="go">3    d     b</span>

<span class="go">Stack the differences on indices</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">align_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1  self     b</span>
<span class="go">   other    a</span>
<span class="go">3  self     d</span>
<span class="go">   other    b</span>
<span class="go">dtype: object</span>

<span class="go">Keep all original rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">keep_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  self other</span>
<span class="go">0  NaN   NaN</span>
<span class="go">1    b     a</span>
<span class="go">2  NaN   NaN</span>
<span class="go">3    d     b</span>
<span class="go">4  NaN   NaN</span>

<span class="go">Keep all original rows and also all original values</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">keep_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  self other</span>
<span class="go">0    a     a</span>
<span class="go">1    b     a</span>
<span class="go">2    c     c</span>
<span class="go">3    d     b</span>
<span class="go">4    e     e</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.add" title="Link to this definition">¶</a></dt>
<dd><p>Return Addition of series and other, element-wise (binary operator <cite>add</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">+</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.radd" title="apache_beam.dataframe.frames.DeferredSeries.radd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.radd</span></code></a></dt><dd><p>Reverse of the Addition operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    2.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.asfreq">
<span class="sig-name descname"><span class="pre">asfreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.asfreq" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.asfreq.html#pandas.Series.asfreq" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.asfreq()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘asfreq’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.at">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">at</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.at" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.at()</span></code> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘at’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.convert_dtypes">
<span class="sig-name descname"><span class="pre">convert_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.convert_dtypes" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.convert_dtypes.html#pandas.Series.convert_dtypes" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.convert_dtypes()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘convert_dtypes’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.div">
<span class="sig-name descname"><span class="pre">div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.div" title="Link to this definition">¶</a></dt>
<dd><p>Return Floating division of series and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rtruediv" title="apache_beam.dataframe.frames.DeferredSeries.rtruediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rtruediv</span></code></a></dt><dd><p>Reverse of the Floating division operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.divide">
<span class="sig-name descname"><span class="pre">divide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.divide" title="Link to this definition">¶</a></dt>
<dd><p>Return Floating division of series and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rtruediv" title="apache_beam.dataframe.frames.DeferredSeries.rtruediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rtruediv</span></code></a></dt><dd><p>Reverse of the Floating division operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.divmod">
<span class="sig-name descname"><span class="pre">divmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.divmod" title="Link to this definition">¶</a></dt>
<dd><p>Return Integer division and modulo of series and other, element-wise (binary operator <cite>divmod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">divmod(series,</span> <span class="pre">other)</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2-Tuple of <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rdivmod" title="apache_beam.dataframe.frames.DeferredSeries.rdivmod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rdivmod</span></code></a></dt><dd><p>Reverse of the Integer division and modulo operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(a    1.0</span>
<span class="go"> b    inf</span>
<span class="go"> c    inf</span>
<span class="go"> d    0.0</span>
<span class="go"> e    NaN</span>
<span class="go"> dtype: float64,</span>
<span class="go"> a    0.0</span>
<span class="go"> b    NaN</span>
<span class="go"> c    NaN</span>
<span class="go"> d    0.0</span>
<span class="go"> e    NaN</span>
<span class="go"> dtype: float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.eq">
<span class="sig-name descname"><span class="pre">eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.eq" title="Link to this definition">¶</a></dt>
<dd><p>Return Equal to of series and other, element-wise (binary operator <cite>eq</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">==</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a     True</span>
<span class="go">b    False</span>
<span class="go">c    False</span>
<span class="go">d    False</span>
<span class="go">e    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.flags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flags</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.flags" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.flags()</span></code> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘flags’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.floordiv">
<span class="sig-name descname"><span class="pre">floordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.floordiv" title="Link to this definition">¶</a></dt>
<dd><p>Return Integer division of series and other, element-wise (binary operator <cite>floordiv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">//</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rfloordiv" title="apache_beam.dataframe.frames.DeferredSeries.rfloordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rfloordiv</span></code></a></dt><dd><p>Reverse of the Integer division operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.ge">
<span class="sig-name descname"><span class="pre">ge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.ge" title="Link to this definition">¶</a></dt>
<dd><p>Return Greater than or equal to of series and other, element-wise (binary operator <cite>ge</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">&gt;=</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">e    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    2.0</span>
<span class="go">d    NaN</span>
<span class="go">f    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a     True</span>
<span class="go">b     True</span>
<span class="go">c    False</span>
<span class="go">d    False</span>
<span class="go">e     True</span>
<span class="go">f    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.gt">
<span class="sig-name descname"><span class="pre">gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.gt" title="Link to this definition">¶</a></dt>
<dd><p>Return Greater than of series and other, element-wise (binary operator <cite>gt</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">&gt;</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">e    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    2.0</span>
<span class="go">d    NaN</span>
<span class="go">f    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a     True</span>
<span class="go">b    False</span>
<span class="go">c    False</span>
<span class="go">d    False</span>
<span class="go">e     True</span>
<span class="go">f    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.infer_objects">
<span class="sig-name descname"><span class="pre">infer_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.infer_objects" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.infer_objects.html#pandas.Series.infer_objects" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.infer_objects()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘infer_objects’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.item">
<span class="sig-name descname"><span class="pre">item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.item" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.item.html#pandas.Series.item" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.item()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘item’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.le">
<span class="sig-name descname"><span class="pre">le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.le" title="Link to this definition">¶</a></dt>
<dd><p>Return Less than or equal to of series and other, element-wise (binary operator <cite>le</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">&lt;=</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">e    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    2.0</span>
<span class="go">d    NaN</span>
<span class="go">f    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    False</span>
<span class="go">b     True</span>
<span class="go">c     True</span>
<span class="go">d    False</span>
<span class="go">e    False</span>
<span class="go">f     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.lt">
<span class="sig-name descname"><span class="pre">lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.lt" title="Link to this definition">¶</a></dt>
<dd><p>Return Less than of series and other, element-wise (binary operator <cite>lt</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">&lt;</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">e    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    2.0</span>
<span class="go">d    NaN</span>
<span class="go">f    1.0</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    False</span>
<span class="go">b    False</span>
<span class="go">c     True</span>
<span class="go">d    False</span>
<span class="go">e    False</span>
<span class="go">f     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.mod">
<span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.mod" title="Link to this definition">¶</a></dt>
<dd><p>Return Modulo of series and other, element-wise (binary operator <cite>mod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">%</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rmod" title="apache_beam.dataframe.frames.DeferredSeries.rmod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rmod</span></code></a></dt><dd><p>Reverse of the Modulo operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    0.0</span>
<span class="go">b    NaN</span>
<span class="go">c    NaN</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.mul">
<span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.mul" title="Link to this definition">¶</a></dt>
<dd><p>Return Multiplication of series and other, element-wise (binary operator <cite>mul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">*</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rmul" title="apache_beam.dataframe.frames.DeferredSeries.rmul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rmul</span></code></a></dt><dd><p>Reverse of the Multiplication operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    0.0</span>
<span class="go">c    0.0</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.multiply">
<span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.multiply" title="Link to this definition">¶</a></dt>
<dd><p>Return Multiplication of series and other, element-wise (binary operator <cite>mul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">*</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rmul" title="apache_beam.dataframe.frames.DeferredSeries.rmul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rmul</span></code></a></dt><dd><p>Reverse of the Multiplication operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    0.0</span>
<span class="go">c    0.0</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.ne">
<span class="sig-name descname"><span class="pre">ne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.ne" title="Link to this definition">¶</a></dt>
<dd><p>Return Not equal to of series and other, element-wise (binary operator <cite>ne</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">!=</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    False</span>
<span class="go">b     True</span>
<span class="go">c     True</span>
<span class="go">d     True</span>
<span class="go">e     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.pow">
<span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.pow" title="Link to this definition">¶</a></dt>
<dd><p>Return Exponential power of series and other, element-wise (binary operator <cite>pow</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">**</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rpow" title="apache_beam.dataframe.frames.DeferredSeries.rpow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rpow</span></code></a></dt><dd><p>Reverse of the Exponential power operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.radd">
<span class="sig-name descname"><span class="pre">radd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.radd" title="Link to this definition">¶</a></dt>
<dd><p>Return Addition of series and other, element-wise (binary operator <cite>radd</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">+</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.add" title="apache_beam.dataframe.frames.DeferredSeries.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.add</span></code></a></dt><dd><p>Element-wise Addition, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    2.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rank" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.rank.html#pandas.Series.rank" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.rank()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘rank’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rdiv">
<span class="sig-name descname"><span class="pre">rdiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rdiv" title="Link to this definition">¶</a></dt>
<dd><p>Return Floating division of series and other, element-wise (binary operator <cite>rtruediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">/</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.truediv" title="apache_beam.dataframe.frames.DeferredSeries.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.truediv</span></code></a></dt><dd><p>Element-wise Floating division, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rdivmod">
<span class="sig-name descname"><span class="pre">rdivmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rdivmod" title="Link to this definition">¶</a></dt>
<dd><p>Return Integer division and modulo of series and other, element-wise (binary operator <cite>rdivmod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">divmod</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2-Tuple of <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.divmod" title="apache_beam.dataframe.frames.DeferredSeries.divmod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.divmod</span></code></a></dt><dd><p>Element-wise Integer division and modulo, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divmod</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(a    1.0</span>
<span class="go"> b    inf</span>
<span class="go"> c    inf</span>
<span class="go"> d    0.0</span>
<span class="go"> e    NaN</span>
<span class="go"> dtype: float64,</span>
<span class="go"> a    0.0</span>
<span class="go"> b    NaN</span>
<span class="go"> c    NaN</span>
<span class="go"> d    0.0</span>
<span class="go"> e    NaN</span>
<span class="go"> dtype: float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.reindex_like">
<span class="sig-name descname"><span class="pre">reindex_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.reindex_like" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.reindex_like.html#pandas.Series.reindex_like" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.reindex_like()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘reindex_like’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rfloordiv">
<span class="sig-name descname"><span class="pre">rfloordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rfloordiv" title="Link to this definition">¶</a></dt>
<dd><p>Return Integer division of series and other, element-wise (binary operator <cite>rfloordiv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">//</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.floordiv" title="apache_beam.dataframe.frames.DeferredSeries.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.floordiv</span></code></a></dt><dd><p>Element-wise Integer division, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">floordiv</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rmod">
<span class="sig-name descname"><span class="pre">rmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rmod" title="Link to this definition">¶</a></dt>
<dd><p>Return Modulo of series and other, element-wise (binary operator <cite>rmod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">%</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.mod" title="apache_beam.dataframe.frames.DeferredSeries.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.mod</span></code></a></dt><dd><p>Element-wise Modulo, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    0.0</span>
<span class="go">b    NaN</span>
<span class="go">c    NaN</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rmul">
<span class="sig-name descname"><span class="pre">rmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rmul" title="Link to this definition">¶</a></dt>
<dd><p>Return Multiplication of series and other, element-wise (binary operator <cite>rmul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">*</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.mul" title="apache_beam.dataframe.frames.DeferredSeries.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.mul</span></code></a></dt><dd><p>Element-wise Multiplication, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    0.0</span>
<span class="go">c    0.0</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rpow">
<span class="sig-name descname"><span class="pre">rpow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rpow" title="Link to this definition">¶</a></dt>
<dd><p>Return Exponential power of series and other, element-wise (binary operator <cite>rpow</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">**</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.pow" title="apache_beam.dataframe.frames.DeferredSeries.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.pow</span></code></a></dt><dd><p>Element-wise Exponential power, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rsub">
<span class="sig-name descname"><span class="pre">rsub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rsub" title="Link to this definition">¶</a></dt>
<dd><p>Return Subtraction of series and other, element-wise (binary operator <cite>rsub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">-</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sub" title="apache_beam.dataframe.frames.DeferredSeries.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sub</span></code></a></dt><dd><p>Element-wise Subtraction, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d   -1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.rtruediv">
<span class="sig-name descname"><span class="pre">rtruediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.rtruediv" title="Link to this definition">¶</a></dt>
<dd><p>Return Floating division of series and other, element-wise (binary operator <cite>rtruediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">/</span> <span class="pre">series</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.truediv" title="apache_beam.dataframe.frames.DeferredSeries.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.truediv</span></code></a></dt><dd><p>Element-wise Floating division, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.set_flags">
<span class="sig-name descname"><span class="pre">set_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.set_flags" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.set_flags.html#pandas.Series.set_flags" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.set_flags()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘set_flags’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.squeeze">
<span class="sig-name descname"><span class="pre">squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.squeeze" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.squeeze.html#pandas.Series.squeeze" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.squeeze()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘squeeze’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.sub">
<span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.sub" title="Link to this definition">¶</a></dt>
<dd><p>Return Subtraction of series and other, element-wise (binary operator <cite>sub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">-</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rsub" title="apache_beam.dataframe.frames.DeferredSeries.rsub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rsub</span></code></a></dt><dd><p>Reverse of the Subtraction operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d   -1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.subtract">
<span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.subtract" title="Link to this definition">¶</a></dt>
<dd><p>Return Subtraction of series and other, element-wise (binary operator <cite>sub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">-</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rsub" title="apache_beam.dataframe.frames.DeferredSeries.rsub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rsub</span></code></a></dt><dd><p>Reverse of the Subtraction operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    0.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d   -1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_clipboard">
<span class="sig-name descname"><span class="pre">to_clipboard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_clipboard" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_clipboard.html#pandas.DataFrame.to_clipboard" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_clipboard()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_clipboard’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_csv">
<span class="sig-name descname"><span class="pre">to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_csv" title="Link to this definition">¶</a></dt>
<dd><p>Write object to a comma-separated values (csv) file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_or_buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – <p>String, path object (implementing os.PathLike[str]), or file-like
object implementing a write() function. If None, the result is
returned as a string. If a non-binary file object is passed, it should
be opened with <cite>newline=’’</cite>, disabling universal newlines. If a binary
file object is passed, <cite>mode</cite> might need to contain a <cite>‘b’</cite>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Support for binary file objects was introduced.</p>
</div>
</p></li>
<li><p><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '</em><em>,</em><em>'</em>) – String of length 1. Field delimiter for the output file.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Missing data representation.</p></li>
<li><p><strong>float_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Callable</em><em>, </em><em>default None</em>) – Format string for floating point numbers. If a Callable is given, it takes
precedence over other numeric formatting parameters, like decimal.</p></li>
<li><p><strong>columns</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Columns to write.</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default True</em>) – Write out the column names. If a list of strings is given it is
assumed to be aliases for the column names.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write row names (index).</p></li>
<li><p><strong>index_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>sequence</em><em>, or </em><em>False</em><em>, </em><em>default None</em>) – Column label for index column(s) if desired. If None is given, and
<cite>header</cite> and <cite>index</cite> are True, then the index names are used. A
sequence should be given if the object uses MultiIndex. If
False do not print fields for index names. Use index_label=False
for easier importing in R.</p></li>
<li><p><strong>mode</strong> (<em>{'w'</em><em>, </em><em>'x'</em><em>, </em><em>'a'}</em><em>, </em><em>default 'w'</em>) – <p>Forwarded to either <cite>open(mode=)</cite> or <cite>fsspec.open(mode=)</cite> to control
the file opening. Typical values include:</p>
<ul>
<li><p>’w’, truncate the file first.</p></li>
<li><p>’x’, exclusive creation, failing if the file already exists.</p></li>
<li><p>’a’, append to the end of file if it exists.</p></li>
</ul>
</p></li>
<li><p><strong>encoding</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A string representing the encoding to use in the output file,
defaults to ‘utf-8’. <cite>encoding</cite> is not supported if <cite>path_or_buf</cite>
is a non-binary file object.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path_or_buf’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
<p>May be a dict with key ‘method’ as compression mode
and other entries as additional compression options if
compression mode is ‘zip’.</p>
<p>Passing compression options as keys in dict is
supported for compression modes ‘gzip’, ‘bz2’, ‘zstd’, and ‘zip’.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Compression is supported for binary file objects.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Previous versions forwarded dict entries for ‘gzip’ to
<cite>gzip.open</cite> instead of <cite>gzip.GzipFile</cite> which prevented
setting <cite>mtime</cite>.</p>
</div>
</p></li>
<li><p><strong>quoting</strong> (<em>optional constant from csv module</em>) – Defaults to csv.QUOTE_MINIMAL. If you have set a <cite>float_format</cite>
then floats are converted to strings and thus csv.QUOTE_NONNUMERIC
will treat them as non-numeric.</p></li>
<li><p><strong>quotechar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '&quot;'</em>) – String of length 1. Character used to quote fields.</p></li>
<li><p><strong>lineterminator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – <p>The newline character or character sequence to use in the output
file. Defaults to <cite>os.linesep</cite>, which depends on the OS in which
this method is called (’\n’ for linux, ‘\r\n’ for Windows, i.e.).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.5.0: </span>Previously was line_terminator, changed for consistency with
read_csv and the standard library ‘csv’ module.</p>
</div>
</p></li>
<li><p><strong>chunksize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>None</em>) – Rows to write at a time.</p></li>
<li><p><strong>date_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – Format string for datetime objects.</p></li>
<li><p><strong>doublequote</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Control quoting of <cite>quotechar</cite> inside a field.</p></li>
<li><p><strong>escapechar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – String of length 1. Character used to escape <cite>sep</cite> and <cite>quotechar</cite>
when appropriate.</p></li>
<li><p><strong>decimal</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '.'</em>) – Character recognized as decimal separator. E.g. use ‘,’ for
European data.</p></li>
<li><p><strong>errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'strict'</em>) – Specifies how encoding and decoding errors are to be handled.
See the errors argument for <a class="reference external" href="https://docs.python.org/3/library/functions.html#open" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> for a full list
of options.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If path_or_buf is None, returns the resulting csv format as a
string. Otherwise returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_csv</span></code></dt><dd><p>Load a CSV file into a DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.to_excel" title="apache_beam.dataframe.frames.DeferredSeries.to_excel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_excel</span></code></a></dt><dd><p>Write DeferredDataFrame to an Excel file.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Raphael&#39;</span><span class="p">,</span> <span class="s1">&#39;Donatello&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;mask&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;weapon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sai&#39;</span><span class="p">,</span> <span class="s1">&#39;bo staff&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;name,mask,weapon\nRaphael,red,sai\nDonatello,purple,bo staff\n&#39;</span>

<span class="go">Create &#39;out.zip&#39; containing &#39;out.csv&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">compression_opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;out.csv&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;out.zip&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">compression</span><span class="o">=</span><span class="n">compression_opts</span><span class="p">)</span>  

<span class="go">To write a csv file to a new folder or nested folder you will first</span>
<span class="go">need to create it using either Pathlib or os:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;folder/subfolder/out.csv&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>  

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;folder/subfolder&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;folder/subfolder/out.csv&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_excel">
<span class="sig-name descname"><span class="pre">to_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_excel" title="Link to this definition">¶</a></dt>
<dd><p>Write object to an Excel sheet.</p>
<p>To write a single object to an Excel .xlsx file it is only necessary to
specify a target file name. To write to multiple sheets it is necessary to
create an <cite>ExcelWriter</cite> object with a target file name, and specify a sheet
in the file to write to.</p>
<p>Multiple sheets may be written to by specifying unique <cite>sheet_name</cite>.
With all data written to the file it is necessary to save the changes.
Note that creating an <cite>ExcelWriter</cite> object with a file name that already
exists will result in the contents of the existing file being erased.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_writer</strong> (<em>path-like</em><em>, </em><em>file-like</em><em>, or </em><em>ExcelWriter object</em>) – File path or existing ExcelWriter.</p></li>
<li><p><strong>sheet_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'Sheet1'</em>) – Name of sheet which will contain DeferredDataFrame.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Missing data representation.</p></li>
<li><p><strong>float_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Format string for floating point numbers. For example
<code class="docutils literal notranslate"><span class="pre">float_format=&quot;%.2f&quot;</span></code> will format 0.1234 to 0.12.</p></li>
<li><p><strong>columns</strong> (<em>sequence</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Columns to write.</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default True</em>) – Write out the column names. If a list of string is given it is
assumed to be aliases for the column names.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write row names (index).</p></li>
<li><p><strong>index_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Column label for index column(s) if desired. If not specified, and
<cite>header</cite> and <cite>index</cite> are True, then the index names are used. A
sequence should be given if the DeferredDataFrame uses MultiIndex.</p></li>
<li><p><strong>startrow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – Upper left cell row to dump data frame.</p></li>
<li><p><strong>startcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – Upper left cell column to dump data frame.</p></li>
<li><p><strong>engine</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Write engine to use, ‘openpyxl’ or ‘xlsxwriter’. You can also set this
via the options <code class="docutils literal notranslate"><span class="pre">io.excel.xlsx.writer</span></code> or
<code class="docutils literal notranslate"><span class="pre">io.excel.xlsm.writer</span></code>.</p></li>
<li><p><strong>merge_cells</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write MultiIndex and Hierarchical Rows as merged cells.</p></li>
<li><p><strong>inf_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'inf'</em>) – Representation for infinity (there is no native representation for
infinity in Excel).</p></li>
<li><p><strong>freeze_panes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> (</em><em>length 2</em><em>)</em><em>, </em><em>optional</em>) – Specifies the one-based bottommost row and rightmost column that
is to be frozen.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>engine_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Arbitrary keyword arguments passed to excel engine.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.to_csv" title="apache_beam.dataframe.frames.DeferredSeries.to_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_csv</span></code></a></dt><dd><p>Write DeferredDataFrame to a comma-separated values (csv) file.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExcelWriter</span></code></dt><dd><p>Class for writing DeferredDataFrame objects into excel sheets.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_excel</span></code></dt><dd><p>Read an Excel file into a pandas DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_csv</span></code></dt><dd><p>Read a comma-separated values (csv) file into DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.formats.style.Styler.to_excel</span></code></dt><dd><p>Add styles to Excel sheet.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For compatibility with <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="apache_beam.dataframe.frames.DeferredDataFrame.to_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_csv()</span></code></a>,
to_excel serializes lists and dicts to strings before writing.</p>
<p>Once a workbook has been saved it is not possible to write further
data without rewriting the whole workbook.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Create, write to and save a workbook:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;row 1&#39;</span><span class="p">,</span> <span class="s1">&#39;row 2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col 1&#39;</span><span class="p">,</span> <span class="s1">&#39;col 2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;output.xlsx&quot;</span><span class="p">)</span>  

<span class="go">To specify the sheet name:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;output.xlsx&quot;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_1&#39;</span><span class="p">)</span>  

<span class="go">If you wish to write to more than one sheet in the workbook, it is</span>
<span class="go">necessary to specify an ExcelWriter object:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>  
<span class="gp">... </span>    <span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_1&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_2&#39;</span><span class="p">)</span>

<span class="go">ExcelWriter can also be used to append to an existing Excel file:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>  
<span class="gp">... </span>    <span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_3&#39;</span><span class="p">)</span>

<span class="go">To set the library that is used to write the Excel file,</span>
<span class="go">you can pass the `engine` keyword (the default engine is</span>
<span class="go">automatically chosen depending on the file extension):</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;output1.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_feather">
<span class="sig-name descname"><span class="pre">to_feather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_feather" title="Link to this definition">¶</a></dt>
<dd><p>Write a DataFrame to the binary Feather format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em>) – String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function. If a string or a path,
it will be used as Root Directory path when writing a partitioned dataset.</p></li>
<li><p><strong>**kwargs</strong> – Additional keywords passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.feather.write_feather()</span></code>.
This includes the <cite>compression</cite>, <cite>compression_level</cite>, <cite>chunksize</cite>
and <cite>version</cite> keywords.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Notes</p>
<p>This function writes the dataframe as a <a class="reference external" href="https://arrow.apache.org/docs/python/feather.html">feather file</a>. Requires a default
index. For saving the DeferredDataFrame with your custom index use a method that
supports custom indices e.g. <cite>to_parquet</cite>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s2">&quot;file.feather&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_hdf">
<span class="sig-name descname"><span class="pre">to_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_hdf" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_hdf.html#pandas.DataFrame.to_hdf" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_hdf()</span></code></a> is not yet supported in the Beam DataFrame API because HDF5 is a random access file format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_html">
<span class="sig-name descname"><span class="pre">to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_html" title="Link to this definition">¶</a></dt>
<dd><p>Render a DataFrame as an HTML table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em> or </em><em>StringIO-like</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – Buffer to write to. If None, the output is returned as a string.</p></li>
<li><p><strong>columns</strong> (<em>array-like</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – The subset of columns to write. Writes all columns by default.</p></li>
<li><p><strong>col_space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The minimum width of each column in CSS length units.  An int is assumed to be px units..</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print column labels, default True.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Whether to print index (row) labels.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default 'NaN'</em>) – String representation of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> to use.</p></li>
<li><p><strong>formatters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>one-param. functions</em><em>, </em><em>optional</em>) – Formatter functions to apply to columns’ elements by position or
name.
The result of each function must be a unicode string.
List/tuple must be of length equal to the number of columns.</p></li>
<li><p><strong>float_format</strong> (<em>one-parameter function</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – <p>Formatter function to apply to columns’ elements if they are
floats. This function must return a unicode string and will be
applied only to the non-<code class="docutils literal notranslate"><span class="pre">NaN</span></code> elements, with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> being
handled by <code class="docutils literal notranslate"><span class="pre">na_rep</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>sparsify</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Set to False for a DeferredDataFrame with a hierarchical index to print
every multiindex key at each row.</p></li>
<li><p><strong>index_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Prints the names of the indexes.</p></li>
<li><p><strong>justify</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – <p>How to justify the column labels. If None uses the option from
the print configuration (controlled by set_option), ‘right’ out
of the box. Valid values are</p>
<ul>
<li><p>left</p></li>
<li><p>right</p></li>
<li><p>center</p></li>
<li><p>justify</p></li>
<li><p>justify-all</p></li>
<li><p>start</p></li>
<li><p>end</p></li>
<li><p>inherit</p></li>
<li><p>match-parent</p></li>
<li><p>initial</p></li>
<li><p>unset.</p></li>
</ul>
</p></li>
<li><p><strong>max_rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of rows to display in the console.</p></li>
<li><p><strong>max_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of columns to display in the console.</p></li>
<li><p><strong>show_dimensions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Display DeferredDataFrame dimensions (number of rows by number of columns).</p></li>
<li><p><strong>decimal</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '.'</em>) – Character recognized as decimal separator, e.g. ‘,’ in Europe.</p></li>
<li><p><strong>bold_rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Make the row labels bold in the output.</p></li>
<li><p><strong>classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>default None</em>) – CSS class(es) to apply to the resulting html table.</p></li>
<li><p><strong>escape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Convert the characters &lt;, &gt;, and &amp; to HTML-safe sequences.</p></li>
<li><p><strong>notebook</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>default False</em>) – Whether the generated HTML is for IPython Notebook.</p></li>
<li><p><strong>border</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – A <code class="docutils literal notranslate"><span class="pre">border=border</span></code> attribute is included in the opening
<cite>&lt;table&gt;</cite> tag. Default <code class="docutils literal notranslate"><span class="pre">pd.options.display.html.border</span></code>.</p></li>
<li><p><strong>table_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A css id is included in the opening <cite>&lt;table&gt;</cite> tag if specified.</p></li>
<li><p><strong>render_links</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Convert URLs to HTML links.</p></li>
<li><p><strong>encoding</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default &quot;utf-8&quot;</em>) – Set character encoding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If buf is None, returns the result as a string. Otherwise returns
None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.to_string" title="apache_beam.dataframe.frames.DeferredSeries.to_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_string</span></code></a></dt><dd><p>Convert DeferredDataFrame to a string.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">html_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;thead&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;col1&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;col2&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;/thead&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;tbody&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;1&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;4&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;2&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;3&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;/tbody&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/table&gt;&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">html_string</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_json" title="Link to this definition">¶</a></dt>
<dd><p>Convert the object to a JSON string.</p>
<p>Note NaN’s and None will be converted to null and datetime objects
will be converted to UNIX timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_or_buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – String, path object (implementing os.PathLike[str]), or file-like
object implementing a write() function. If None, the result is
returned as a string.</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Indication of expected JSON string format.</p>
<ul>
<li><p>DeferredSeries:</p>
<blockquote>
<div><ul class="simple">
<li><p>default is ‘index’</p></li>
<li><p>allowed values are: {‘split’, ‘records’, ‘index’, ‘table’}.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>DeferredDataFrame:</p>
<blockquote>
<div><ul class="simple">
<li><p>default is ‘columns’</p></li>
<li><p>allowed values are: {‘split’, ‘records’, ‘index’, ‘columns’,
‘values’, ‘table’}.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The format of the JSON string:</p>
<blockquote>
<div><ul class="simple">
<li><p>’split’ : dict like {‘index’ -&gt; [index], ‘columns’ -&gt; [columns],
‘data’ -&gt; [values]}</p></li>
<li><p>’records’ : list like [{column -&gt; value}, … , {column -&gt; value}]</p></li>
<li><p>’index’ : dict like {index -&gt; {column -&gt; value}}</p></li>
<li><p>’columns’ : dict like {column -&gt; {index -&gt; value}}</p></li>
<li><p>’values’ : just the values array</p></li>
<li><p>’table’ : dict like {‘schema’: {schema}, ‘data’: {data}}</p></li>
</ul>
<p>Describing the data, where data component is like <code class="docutils literal notranslate"><span class="pre">orient='records'</span></code>.</p>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>date_format</strong> (<em>{None</em><em>, </em><em>'epoch'</em><em>, </em><em>'iso'}</em>) – Type of date conversion. ‘epoch’ = epoch milliseconds,
‘iso’ = ISO8601. The default depends on the <cite>orient</cite>. For
<code class="docutils literal notranslate"><span class="pre">orient='table'</span></code>, the default is ‘iso’. For all other orients,
the default is ‘epoch’.</p></li>
<li><p><strong>double_precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 10</em>) – The number of decimal places to use when encoding
floating point values. The possible maximal value is 15.
Passing double_precision greater than 15 will raise a ValueError.</p></li>
<li><p><strong>force_ascii</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Force encoded string to be ASCII.</p></li>
<li><p><strong>date_unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'ms'</em><em> (</em><em>milliseconds</em><em>)</em>) – The time unit to encode to, governs timestamp and ISO8601
precision.  One of ‘s’, ‘ms’, ‘us’, ‘ns’ for second, millisecond,
microsecond, and nanosecond respectively.</p></li>
<li><p><strong>default_handler</strong> (<em>callable</em><em>, </em><em>default None</em>) – Handler to call if object cannot otherwise be converted to a
suitable format for JSON. Should receive a single argument which is
the object to convert and return a serialisable object.</p></li>
<li><p><strong>lines</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If ‘orient’ is ‘records’ write out line-delimited json format. Will
throw ValueError if incorrect ‘orient’ since others are not
list-like.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path_or_buf’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>Zstandard support.</p>
</div>
</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – The index is only used when ‘orient’ is ‘split’, ‘index’, ‘column’,
or ‘table’. Of these, ‘index’ and ‘column’ do not support
<cite>index=False</cite>.</p></li>
<li><p><strong>indent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Length of whitespace used to indent each record.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'w'</em><em> (</em><em>writing</em><em>)</em>) – Specify the IO mode for output when supplying a path_or_buf.
Accepted args are ‘w’ (writing) and ‘a’ (append) only.
mode=’a’ is only supported when lines is True and orient is ‘records’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If path_or_buf is None, returns the resulting json format as a
string. Otherwise returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_json</span></code></dt><dd><p>Convert a JSON string to pandas object.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The behavior of <code class="docutils literal notranslate"><span class="pre">indent=0</span></code> varies from the stdlib, which does not
indent the output but does insert newlines. Currently, <code class="docutils literal notranslate"><span class="pre">indent=0</span></code>
and the default <code class="docutils literal notranslate"><span class="pre">indent=None</span></code> are equivalent in pandas, though this
may change in a future release.</p>
<p><code class="docutils literal notranslate"><span class="pre">orient='table'</span></code> contains a ‘pandas_version’ field under ‘schema’.
This stores the version of <cite>pandas</cite> used in the latest revision of the
schema.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">loads</span><span class="p">,</span> <span class="n">dumps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;row 1&quot;</span><span class="p">,</span> <span class="s2">&quot;row 2&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col 1&quot;</span><span class="p">,</span> <span class="s2">&quot;col 2&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;columns&quot;: [</span>
<span class="go">        &quot;col 1&quot;,</span>
<span class="go">        &quot;col 2&quot;</span>
<span class="go">    ],</span>
<span class="go">    &quot;index&quot;: [</span>
<span class="go">        &quot;row 1&quot;,</span>
<span class="go">        &quot;row 2&quot;</span>
<span class="go">    ],</span>
<span class="go">    &quot;data&quot;: [</span>
<span class="go">        [</span>
<span class="go">            &quot;a&quot;,</span>
<span class="go">            &quot;b&quot;</span>
<span class="go">        ],</span>
<span class="go">        [</span>
<span class="go">            &quot;c&quot;,</span>
<span class="go">            &quot;d&quot;</span>
<span class="go">        ]</span>
<span class="go">    ]</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;records&#39;`` formatted JSON.</span>
<span class="go">Note that index labels are not preserved with this encoding.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;index&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;row 1&quot;: {</span>
<span class="go">        &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;row 2&quot;: {</span>
<span class="go">        &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;columns&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;col 1&quot;: {</span>
<span class="go">        &quot;row 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;row 2&quot;: &quot;c&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;col 2&quot;: {</span>
<span class="go">        &quot;row 1&quot;: &quot;b&quot;,</span>
<span class="go">        &quot;row 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;values&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">[</span>
<span class="go">    [</span>
<span class="go">        &quot;a&quot;,</span>
<span class="go">        &quot;b&quot;</span>
<span class="go">    ],</span>
<span class="go">    [</span>
<span class="go">        &quot;c&quot;,</span>
<span class="go">        &quot;d&quot;</span>
<span class="go">    ]</span>
<span class="go">]</span>

<span class="go">Encoding with Table Schema:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;schema&quot;: {</span>
<span class="go">        &quot;fields&quot;: [</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;index&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            },</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;col 1&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            },</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;col 2&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            }</span>
<span class="go">        ],</span>
<span class="go">        &quot;primaryKey&quot;: [</span>
<span class="go">            &quot;index&quot;</span>
<span class="go">        ],</span>
<span class="go">        &quot;pandas_version&quot;: &quot;1.4.0&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;data&quot;: [</span>
<span class="go">        {</span>
<span class="go">            &quot;index&quot;: &quot;row 1&quot;,</span>
<span class="go">            &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">            &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &quot;index&quot;: &quot;row 2&quot;,</span>
<span class="go">            &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">            &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">        }</span>
<span class="go">    ]</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_latex">
<span class="sig-name descname"><span class="pre">to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_latex" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_latex.html#pandas.Series.to_latex" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_latex()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_latex’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_markdown">
<span class="sig-name descname"><span class="pre">to_markdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_markdown" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_markdown.html#pandas.Series.to_markdown" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_markdown()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_markdown’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_msgpack">
<span class="sig-name descname"><span class="pre">to_msgpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_msgpack" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_msgpack()</span></code> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_parquet">
<span class="sig-name descname"><span class="pre">to_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Write a DataFrame to the binary parquet format.</p>
<p>This function writes the dataframe as a <a class="reference external" href="https://parquet.apache.org/">parquet file</a>. You can choose different parquet
backends, and have the option of compression. See
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/io.html#io-parquet" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – <p>String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function. If None, the result is
returned as bytes. If a string or path, it will be used as Root Directory
path when writing a partitioned dataset.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0.</span></p>
</div>
<p>Previously this was “fname”</p>
</p></li>
<li><p><strong>engine</strong> (<em>{'auto'</em><em>, </em><em>'pyarrow'</em><em>, </em><em>'fastparquet'}</em><em>, </em><em>default 'auto'</em>) – Parquet library to use. If ‘auto’, then the option
<code class="docutils literal notranslate"><span class="pre">io.parquet.engine</span></code> is used. The default <code class="docutils literal notranslate"><span class="pre">io.parquet.engine</span></code>
behavior is to try ‘pyarrow’, falling back to ‘fastparquet’ if
‘pyarrow’ is unavailable.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>default 'snappy'</em>) – Name of the compression to use. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Supported options: ‘snappy’, ‘gzip’, ‘brotli’, ‘lz4’, ‘zstd’.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default None</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, include the dataframe’s index(es) in the file output.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, they will not be written to the file.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, similar to <code class="docutils literal notranslate"><span class="pre">True</span></code> the dataframe’s index(es)
will be saved. However, instead of being saved as values,
the RangeIndex will be stored as a range in the metadata so it
doesn’t require much space and is faster. Other indexes will
be included as columns in the file output.</p></li>
<li><p><strong>partition_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em><em>, </em><em>default None</em>) – Column names by which to partition the dataset.
Columns are partitioned in the order they are given.
Must be None if path is not a string.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments passed to the parquet library. See
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/io.html#io-parquet" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">pandas io</span></a> for more details.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes if no path argument is provided else None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_parquet</span></code></dt><dd><p>Read a parquet file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_orc" title="apache_beam.dataframe.frames.DeferredDataFrame.to_orc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_orc</span></code></a></dt><dd><p>Write an orc file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="apache_beam.dataframe.frames.DeferredDataFrame.to_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_csv</span></code></a></dt><dd><p>Write a csv file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_sql" title="apache_beam.dataframe.frames.DeferredDataFrame.to_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_sql</span></code></a></dt><dd><p>Write to a sql table.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_hdf" title="apache_beam.dataframe.frames.DeferredDataFrame.to_hdf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_hdf</span></code></a></dt><dd><p>Write to hdf.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function requires either the <a class="reference external" href="https://pypi.org/project/fastparquet">fastparquet</a> or <a class="reference external" href="https://arrow.apache.org/docs/python/">pyarrow</a> library.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;df.parquet.gzip&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;df.parquet.gzip&#39;</span><span class="p">)</span>  
<span class="go">   col1  col2</span>
<span class="go">0     1     3</span>
<span class="go">1     2     4</span>

<span class="go">If you want to get a buffer to the parquet content you can use a io.BytesIO</span>
<span class="go">object, as long as you don&#39;t use partition_cols, which creates multiple files.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_period">
<span class="sig-name descname"><span class="pre">to_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_period" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_period.html#pandas.Series.to_period" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_period()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_period’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_pickle" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_pickle.html#pandas.Series.to_pickle" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_pickle()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_pickle’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_sql">
<span class="sig-name descname"><span class="pre">to_sql</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_sql" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_sql.html#pandas.Series.to_sql" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_sql()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_sql’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_stata">
<span class="sig-name descname"><span class="pre">to_stata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_stata" title="Link to this definition">¶</a></dt>
<dd><p>Export DataFrame object to Stata dta format.</p>
<p>Writes the DataFrame to a Stata dataset file.
“dta” files contain a Stata dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, or </em><em>buffer</em>) – String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function.</p></li>
<li><p><strong>convert_dates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary mapping columns containing datetime types to stata
internal format to use when writing the dates. Options are ‘tc’,
‘td’, ‘tm’, ‘tw’, ‘th’, ‘tq’, ‘ty’. Column can be either an integer
or a name. Datetime columns that do not have a conversion type
specified will be converted to ‘tc’. Raises NotImplementedError if
a datetime column has timezone information.</p></li>
<li><p><strong>write_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Write the index to Stata dataset.</p></li>
<li><p><strong>byteorder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Can be “&gt;”, “&lt;”, “little”, or “big”. default is <cite>sys.byteorder</cite>.</p></li>
<li><p><strong>time_stamp</strong> (<em>datetime</em>) – A datetime to use as file creation date.  Default is the current
time.</p></li>
<li><p><strong>data_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A label for the data set.  Must be 80 characters or smaller.</p></li>
<li><p><strong>variable_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary containing columns as keys and variable labels as
values. Each label must be 80 characters or smaller.</p></li>
<li><p><strong>version</strong> (<em>{114</em><em>, </em><em>117</em><em>, </em><em>118</em><em>, </em><em>119</em><em>, </em><em>None}</em><em>, </em><em>default 114</em>) – <p>Version to use in the output dta file. Set to None to let pandas
decide between 118 or 119 formats depending on the number of
columns in the frame. pandas Version 114 can be read by Stata 10 and
later. pandas Version 117 can be read by Stata 13 or later. pandas Version 118
is supported in Stata 14 and later. pandas Version 119 is supported in
Stata 15 and later. pandas Version 114 limits string variables to 244
characters or fewer while versions 117 and later allow strings
with lengths up to 2,000,000 characters. Versions 118 and 119
support Unicode characters, and pandas version 119 supports more than
32,767 variables.</p>
<p>pandas Version 119 should usually only be used when the number of
variables exceeds the capacity of dta format 118. Exporting
smaller datasets in format 119 may have unintended consequences,
and, as of November 2020, Stata SE cannot read pandas version 119 files.</p>
</p></li>
<li><p><strong>convert_strl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of column names to convert to string columns to Stata StrL
format. Only available if version is 117.  Storing strings in the
StrL format can produce smaller dta files if strings have more than
8 characters and values are repeated.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>Zstandard support.</p>
</div>
</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>value_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>dicts</em>) – <p>Dictionary containing columns as keys and dictionaries of column value
to labels as values. Labels for a single variable must be 32,000
characters or smaller.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – <ul>
<li><p>If datetimes contain timezone information
    * Column dtype is not representable in Stata</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>Columns listed in convert_dates are neither datetime64[ns]
      or datetime.datetime
    * Column listed in convert_dates is not in DeferredDataFrame
    * Categorical label contains more than 32,000 characters</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_stata</span></code></dt><dd><p>Import Stata data files.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.stata.StataWriter</span></code></dt><dd><p>Low-level writer for Stata data files.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.stata.StataWriter117</span></code></dt><dd><p>Low-level writer for pandas version 117 files.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;animal&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;parrot&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="s1">&#39;parrot&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">15</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_stata</span><span class="p">(</span><span class="s1">&#39;animals.dta&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.to_timestamp">
<span class="sig-name descname"><span class="pre">to_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.to_timestamp" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.to_timestamp.html#pandas.Series.to_timestamp" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.to_timestamp()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_timestamp’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredSeries.truediv">
<span class="sig-name descname"><span class="pre">truediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredSeries.truediv" title="Link to this definition">¶</a></dt>
<dd><p>Return Floating division of series and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">series</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value for
missing data in either one of the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em> or </em><em>scalar value</em>)</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>name</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<em>None</em><em> or </em><em>float value</em><em>, </em><em>default None</em><em> (</em><em>NaN</em><em>)</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredSeries alignment, with this value before computation.
If data in both corresponding DeferredSeries locations is missing
the result of filling (at that location) will be missing.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'}</em>) – Unused. Parameter needed for compatibility with DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rtruediv" title="apache_beam.dataframe.frames.DeferredSeries.rtruediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rtruediv</span></code></a></dt><dd><p>Reverse of the Floating division operator, see <a class="reference external" href="https://docs.python.org/3/reference/datamodel.html#emulating-numeric-types">Python documentation</a> for more details.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">a    1.0</span>
<span class="go">b    NaN</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    inf</span>
<span class="go">c    inf</span>
<span class="go">d    0.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">apache_beam.dataframe.frames.</span></span><span class="sig-name descname"><span class="pre">DeferredDataFrame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredDataFrameOrSeries</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.columns">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">columns</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.columns" title="Link to this definition">¶</a></dt>
<dd><p>The column labels of the DataFrame.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">     A  B</span>
<span class="go">0    1  3</span>
<span class="go">1    2  4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
<span class="go">Index([&#39;A&#39;, &#39;B&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.keys" title="Link to this definition">¶</a></dt>
<dd><p>Get the ‘info axis’ (see Indexing for more).</p>
<p>This is index for Series, columns for DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Info axis.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index">Index</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">]},</span>
<span class="gp">... </span>                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">   A  B</span>
<span class="go">a  1  0</span>
<span class="go">b  2  4</span>
<span class="go">c  3  8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">Index([&#39;A&#39;, &#39;B&#39;], dtype=&#39;object&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.align">
<span class="sig-name descname"><span class="pre">align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.align" title="Link to this definition">¶</a></dt>
<dd><p>Align two objects on their axes with the specified join method.</p>
<p>Join method is specified for each axis Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>)</p></li>
<li><p><strong>join</strong> (<em>{'outer'</em><em>, </em><em>'inner'</em><em>, </em><em>'left'</em><em>, </em><em>'right'}</em><em>, </em><em>default 'outer'</em>) – <p>Type of alignment to be performed.</p>
<ul>
<li><p>left: use only keys from left frame, preserve key order.</p></li>
<li><p>right: use only keys from right frame, preserve key order.</p></li>
<li><p>outer: use union of keys from both frames, sort keys lexicographically.</p></li>
<li><p>inner: use intersection of keys from both frames,
preserve the order of the left keys.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>allowed axis</em><em> of </em><em>the other object</em><em>, </em><em>default None</em>) – Align on index (0), columns (1), or both (None).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>level name</em><em>, </em><em>default None</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Always returns new objects. If copy=False and no reindexing is
required then original objects are returned.</p></li>
<li><p><strong>fill_value</strong> (<em>scalar</em><em>, </em><em>default np.nan</em>) – Value to use for missing values. Defaults to NaN, but can be any
“compatible” value.</p></li>
<li><p><strong>method</strong> (<em>{'backfill'</em><em>, </em><em>'bfill'</em><em>, </em><em>'pad'</em><em>, </em><em>'ffill'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Method to use for filling holes in reindexed DeferredSeries:</p>
<ul>
<li><p>pad / ffill: propagate last valid observation forward to next valid.</p></li>
<li><p>backfill / bfill: use NEXT valid observation to fill gap.</p></li>
</ul>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default None</em>) – <p>If method is specified, this is the maximum number of consecutive
NaN values to forward/backward fill. In other words, if there is
a gap with more than this number of consecutive NaNs, it will only
be partially filled. If method is not specified, this is the
maximum number of entries along the entire axis where NaNs will be
filled. Must be greater than 0 if not None.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>fill_axis</strong> (<em>{0</em><em> or </em><em>'index'} for DeferredSeries</em><em>, </em><em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'} for DeferredDataFrame</em><em>, </em><em>default 0</em>) – <p>Filling axis, method and limit.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
<li><p><strong>broadcast_axis</strong> (<em>{0</em><em> or </em><em>'index'} for DeferredSeries</em><em>, </em><em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'} for DeferredDataFrame</em><em>, </em><em>default None</em>) – <p>Broadcast values along this axis, if aligning two objects of
different dimensions.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aligned objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a> of (DeferredSeries/DeferredDataFrame, <a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)">type</a> of other)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Aligning per level is not yet supported. Only the default,
<code class="docutils literal notranslate"><span class="pre">level=None</span></code>, is allowed.</p>
<p>Filling NaN values via <code class="docutils literal notranslate"><span class="pre">method</span></code> is not supported, because it is
<a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>. Only the
default, <code class="docutils literal notranslate"><span class="pre">method=None</span></code>, is allowed.</p>
<p><code class="docutils literal notranslate"><span class="pre">copy=False</span></code> is not supported because its behavior (whether or not it is
an inplace operation) depends on the data.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   D  B  E  A</span>
<span class="go">1  1  2  3  4</span>
<span class="go">2  6  7  8  9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">    A    B    C    D</span>
<span class="go">2   10   20   30   40</span>
<span class="go">3   60   70   80   90</span>
<span class="go">4  600  700  800  900</span>

<span class="go">Align on columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">   A  B   C  D  E</span>
<span class="go">1  4  2 NaN  1  3</span>
<span class="go">2  9  7 NaN  6  8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">    A    B    C    D   E</span>
<span class="go">2   10   20   30   40 NaN</span>
<span class="go">3   60   70   80   90 NaN</span>
<span class="go">4  600  700  800  900 NaN</span>

<span class="go">We can also align on the index:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">    D    B    E    A</span>
<span class="go">1  1.0  2.0  3.0  4.0</span>
<span class="go">2  6.0  7.0  8.0  9.0</span>
<span class="go">3  NaN  NaN  NaN  NaN</span>
<span class="go">4  NaN  NaN  NaN  NaN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">    A      B      C      D</span>
<span class="go">1    NaN    NaN    NaN    NaN</span>
<span class="go">2   10.0   20.0   30.0   40.0</span>
<span class="go">3   60.0   70.0   80.0   90.0</span>
<span class="go">4  600.0  700.0  800.0  900.0</span>

<span class="go">Finally, the default `axis=None` will align on both index and columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left</span>
<span class="go">     A    B   C    D    E</span>
<span class="go">1  4.0  2.0 NaN  1.0  3.0</span>
<span class="go">2  9.0  7.0 NaN  6.0  8.0</span>
<span class="go">3  NaN  NaN NaN  NaN  NaN</span>
<span class="go">4  NaN  NaN NaN  NaN  NaN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right</span>
<span class="go">       A      B      C      D   E</span>
<span class="go">1    NaN    NaN    NaN    NaN NaN</span>
<span class="go">2   10.0   20.0   30.0   40.0 NaN</span>
<span class="go">3   60.0   70.0   80.0   90.0 NaN</span>
<span class="go">4  600.0  700.0  800.0  900.0 NaN</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify_integrity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.append"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.append" title="Link to this definition">¶</a></dt>
<dd><p>This method has been removed in the current version of Pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.get" title="Link to this definition">¶</a></dt>
<dd><p>Get item from object for given key (ex: DataFrame column).</p>
<p>Returns default value if not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>same type as items contained in object</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mf">24.3</span><span class="p">,</span> <span class="mf">75.7</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mf">87.8</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">71.6</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="s2">&quot;medium&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;temp_celsius&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_fahrenheit&quot;</span><span class="p">,</span> <span class="s2">&quot;windspeed&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-02-12&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2014-02-15&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">            temp_celsius  temp_fahrenheit windspeed</span>
<span class="go">2014-02-12          24.3             75.7      high</span>
<span class="go">2014-02-13          31.0             87.8      high</span>
<span class="go">2014-02-14          22.0             71.6    medium</span>
<span class="go">2014-02-15          35.0             95.0    medium</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;temp_celsius&quot;</span><span class="p">,</span> <span class="s2">&quot;windspeed&quot;</span><span class="p">])</span>
<span class="go">            temp_celsius windspeed</span>
<span class="go">2014-02-12          24.3      high</span>
<span class="go">2014-02-13          31.0      high</span>
<span class="go">2014-02-14          22.0    medium</span>
<span class="go">2014-02-15          35.0    medium</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;windspeed&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2014-02-13&#39;</span><span class="p">)</span>
<span class="go">&#39;high&#39;</span>

<span class="go">If the key isn&#39;t found, the default value will be used.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">get</span><span class="p">([</span><span class="s2">&quot;temp_celsius&quot;</span><span class="p">,</span> <span class="s2">&quot;temp_kelvin&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;default_value&quot;</span><span class="p">)</span>
<span class="go">&#39;default_value&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2014-02-10&#39;</span><span class="p">,</span> <span class="s1">&#39;[unknown]&#39;</span><span class="p">)</span>
<span class="go">&#39;[unknown]&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.set_index">
<span class="sig-name descname"><span class="pre">set_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.set_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.set_index" title="Link to this definition">¶</a></dt>
<dd><p>Set the DataFrame index using existing columns.</p>
<p>Set the DataFrame index (row labels) using one or more existing
columns or arrays (of the correct length). The index can replace the
existing index or expand on it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>label</em><em> or </em><em>array-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>labels/arrays</em>) – This parameter can be either a single column key, a single array of
the same length as the calling DeferredDataFrame, or a list containing an
arbitrary combination of column keys and arrays. Here, “array”
encompasses <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code>, <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, and
instances of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterator" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterator</span></code></a>.</p></li>
<li><p><strong>drop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Delete columns to be used as the new index.</p></li>
<li><p><strong>append</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to append columns to existing index.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to modify the DeferredDataFrame rather than creating a new one.</p></li>
<li><p><strong>verify_integrity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Check the new index for duplicates. Otherwise defer the check until
necessary. Setting to False will improve the performance of this
method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Changed row labels or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">keys</span></code> must be a <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">List[str]</span></code>. Passing an Index or Series
is not yet supported (<a class="reference external" href="https://github.com/apache/beam/issues/20759">Issue 20759</a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.reset_index</span></code></dt><dd><p>Opposite of set_index.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.reindex</span></code></dt><dd><p>Change to new indices or expand indices.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.reindex_like" title="apache_beam.dataframe.frames.DeferredDataFrame.reindex_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.reindex_like</span></code></a></dt><dd><p>Change to same indices as other DeferredDataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;sale&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">55</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">31</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   month  year  sale</span>
<span class="go">0      1  2012    55</span>
<span class="go">1      4  2014    40</span>
<span class="go">2      7  2013    84</span>
<span class="go">3     10  2014    31</span>

<span class="go">Set the index to become the &#39;month&#39; column:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
<span class="go">       year  sale</span>
<span class="go">month</span>
<span class="go">1      2012    55</span>
<span class="go">4      2014    40</span>
<span class="go">7      2013    84</span>
<span class="go">10     2014    31</span>

<span class="go">Create a MultiIndex using columns &#39;year&#39; and &#39;month&#39;:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">])</span>
<span class="go">            sale</span>
<span class="go">year  month</span>
<span class="go">2012  1     55</span>
<span class="go">2014  4     40</span>
<span class="go">2013  7     84</span>
<span class="go">2014  10    31</span>

<span class="go">Create a MultiIndex using an Index and a column:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="s1">&#39;year&#39;</span><span class="p">])</span>
<span class="go">         month  sale</span>
<span class="go">   year</span>
<span class="go">1  2012  1      55</span>
<span class="go">2  2014  4      40</span>
<span class="go">3  2013  7      84</span>
<span class="go">4  2014  10     31</span>

<span class="go">Create a MultiIndex using two Series:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>
<span class="go">      month  year  sale</span>
<span class="go">1 1       1  2012    55</span>
<span class="go">2 4       4  2014    40</span>
<span class="go">3 9       7  2013    84</span>
<span class="go">4 16     10  2014    31</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.set_axis">
<span class="sig-name descname"><span class="pre">set_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.set_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.set_axis" title="Link to this definition">¶</a></dt>
<dd><p>Assign desired index to given axis.</p>
<p>Indexes for column or row labels can be changed by assigning
a list-like or Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<em>list-like</em><em>, </em><a class="reference internal" href="apache_beam.dataframe.partitionings.html#apache_beam.dataframe.partitionings.Index" title="apache_beam.dataframe.partitionings.Index"><em>Index</em></a>) – The values for the new index.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to update. The value 0 identifies the rows. For <cite>DeferredSeries</cite>
this parameter is unused and defaults to 0.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – <p>Whether to make a copy of the underlying data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object of type DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DataFrame.rename_axis</span></code></dt><dd><p>Alter the name of the index or columns.</p>
</dd>
</dl>
</div>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">DataFrame.rename_axis : Alter the name of the index or columns.</span>

<span class="go">        Examples</span>
<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&quot;A&quot;: [1, 2, 3], &quot;B&quot;: [4, 5, 6]})</span>

<span class="go">        Change the row labels.</span>

<span class="go">        &gt;&gt;&gt; df.set_axis([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], axis=&#39;index&#39;)</span>
<span class="go">           A  B</span>
<span class="go">        a  1  4</span>
<span class="go">        b  2  5</span>
<span class="go">        c  3  6</span>

<span class="go">        Change the column labels.</span>

<span class="go">        &gt;&gt;&gt; df.set_axis([&#39;I&#39;, &#39;II&#39;], axis=&#39;columns&#39;)</span>
<span class="go">           I  II</span>
<span class="go">        0  1   4</span>
<span class="go">        1  2   5</span>
<span class="go">        2  3   6</span>


<span class="go">    --------</span>
<span class="go">    &gt;&gt;&gt; df = pd.DataFrame({&quot;A&quot;: [1, 2, 3], &quot;B&quot;: [4, 5, 6]})</span>

<span class="go">    Change the row labels.</span>

<span class="go">    &gt;&gt;&gt; df.set_axis([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], axis=&#39;index&#39;)</span>
<span class="go">       A  B</span>
<span class="go">    a  1  4</span>
<span class="go">    b  2  5</span>
<span class="go">    c  3  6</span>

<span class="go">    Change the column labels.</span>

<span class="go">    &gt;&gt;&gt; df.set_axis([&#39;I&#39;, &#39;II&#39;], axis=&#39;columns&#39;)</span>
<span class="go">       I  II</span>
<span class="go">    0  1   4</span>
<span class="go">    1  2   5</span>
<span class="go">    2  3   6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.axes" title="Link to this definition">¶</a></dt>
<dd><p>Return a list representing the axes of the DataFrame.</p>
<p>It has the row axis labels and column axis labels as the only members.
They are returned in that order.</p>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">axes</span>
<span class="go">[RangeIndex(start=0, stop=2, step=1), Index([&#39;col1&#39;, &#39;col2&#39;],</span>
<span class="go">dtype=&#39;object&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.dtypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtypes</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.dtypes" title="Link to this definition">¶</a></dt>
<dd><p>Return the dtypes in the DataFrame.</p>
<p>This returns a Series with the data type of each column.
The result’s index is the original DataFrame’s columns. Columns
with mixed types are stored with the <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype. See
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/basics.html#basics-dtypes" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the User Guide</span></a> for more.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The data type of each column.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DeferredSeries</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;datetime&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20180310&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                   <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="go">float              float64</span>
<span class="go">int                  int64</span>
<span class="go">datetime    datetime64[ns]</span>
<span class="go">string              object</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.assign"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.assign" title="Link to this definition">¶</a></dt>
<dd><p>Assign new columns to a DataFrame.</p>
<p>Returns a new object with all original columns in addition to new ones.
Existing columns that are re-assigned will be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>{str: callable</em><em> or </em><em>DeferredSeries}</em>) – The column names are keywords. If the values are
callable, they are computed on the DeferredDataFrame and
assigned to the new columns. The callable must not
change input DeferredDataFrame (though pandas doesn’t check it).
If the values are not callable, (e.g. a DeferredSeries, scalar, or array),
they are simply assigned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new DeferredDataFrame with the new columns in addition to
all the existing columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">value</span></code> must be a <code class="docutils literal notranslate"><span class="pre">callable</span></code> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a>. Other types
make this operation order-sensitive.</p>
<p class="rubric">Notes</p>
<p>Assigning multiple columns within the same <code class="docutils literal notranslate"><span class="pre">assign</span></code> is possible.
Later items in ‘**kwargs’ may refer to newly created or modified
columns in ‘df’; items are computed and assigned into ‘df’ in order.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;temp_c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">17.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Portland&#39;</span><span class="p">,</span> <span class="s1">&#39;Berkeley&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">          temp_c</span>
<span class="go">Portland    17.0</span>
<span class="go">Berkeley    25.0</span>

<span class="go">Where the value is a callable, evaluated on `df`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">temp_c</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">          temp_c  temp_f</span>
<span class="go">Portland    17.0    62.6</span>
<span class="go">Berkeley    25.0    77.0</span>

<span class="go">Alternatively, the same behavior can be achieved by directly</span>
<span class="go">referencing an existing Series or sequence:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;temp_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">)</span>
<span class="go">          temp_c  temp_f</span>
<span class="go">Portland    17.0    62.6</span>
<span class="go">Berkeley    25.0    77.0</span>

<span class="go">You can create multiple columns within the same assign where one</span>
<span class="go">of the columns depends on another one defined within the same assign:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;temp_c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">32</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">temp_k</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;temp_f&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">459.67</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">          temp_c  temp_f  temp_k</span>
<span class="go">Portland    17.0    62.6  290.15</span>
<span class="go">Berkeley    25.0    77.0  298.15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.explode">
<span class="sig-name descname"><span class="pre">explode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.explode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.explode" title="Link to this definition">¶</a></dt>
<dd><p>Transform each element of a list-like to a row, replicating index values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>column</strong> (<em>IndexLabel</em>) – <p>Column(s) to explode.
For multiple columns, specify a non-empty list with each element
be str or tuple, and all specified columns their list-like data
on same row of the frame must have matching length.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.0: </span>Multi-column explode</p>
</div>
</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If True, the resulting index will be labeled 0, 1, …, n - 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exploded lists to rows of the subset columns;
index will be duplicated for these rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError :</strong> – <ul class="simple">
<li><p>If columns of the frame are not unique.
    * If specified columns to explode is empty list.
    * If specified columns to explode have not matching count of
      elements rowwise in the frame.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.unstack</span></code></dt><dd><p>Pivot a level of the (necessarily hierarchical) index labels.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.melt" title="apache_beam.dataframe.frames.DeferredDataFrame.melt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.melt</span></code></a></dt><dd><p>Unpivot a DeferredDataFrame from wide format to long format.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.explode" title="apache_beam.dataframe.frames.DeferredSeries.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.explode</span></code></a></dt><dd><p>Explode a DeferredDataFrame from list-like columns to long format.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This routine will explode list-likes including lists, tuples, sets,
DeferredSeries, and np.ndarray. The result dtype of the subset rows will
be object. Scalars will be returned unchanged, and empty list-likes will
result in a np.nan for that row. In addition, the ordering of rows in the
output will be non-deterministic when exploding sets.</p>
<p>Reference <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping-explode" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more examples.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           A  B          C</span>
<span class="go">0  [0, 1, 2]  1  [a, b, c]</span>
<span class="go">1        foo  1        NaN</span>
<span class="go">2         []  1         []</span>
<span class="go">3     [3, 4]  1     [d, e]</span>

<span class="go">Single-column explode.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">     A  B          C</span>
<span class="go">0    0  1  [a, b, c]</span>
<span class="go">0    1  1  [a, b, c]</span>
<span class="go">0    2  1  [a, b, c]</span>
<span class="go">1  foo  1        NaN</span>
<span class="go">2  NaN  1         []</span>
<span class="go">3    3  1     [d, e]</span>
<span class="go">3    4  1     [d, e]</span>

<span class="go">Multi-column explode.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AC&#39;</span><span class="p">))</span>
<span class="go">     A  B    C</span>
<span class="go">0    0  1    a</span>
<span class="go">0    1  1    b</span>
<span class="go">0    2  1    c</span>
<span class="go">1  foo  1  NaN</span>
<span class="go">2  NaN  1  NaN</span>
<span class="go">3    3  1    d</span>
<span class="go">3    4  1    e</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.insert" title="Link to this definition">¶</a></dt>
<dd><p>Insert column into DataFrame at specified location.</p>
<p>Raises a ValueError if <cite>column</cite> is already contained in the DataFrame,
unless <cite>allow_duplicates</cite> is set to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Insertion index. Must verify 0 &lt;= loc &lt;= len(columns).</p></li>
<li><p><strong>column</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>number</em><em>, or </em><em>hashable object</em>) – Label of the inserted column.</p></li>
<li><p><strong>value</strong> (<em>Scalar</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><em>array-like</em>)</p></li>
<li><p><strong>allow_duplicates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default lib.no_default</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">value</span></code> cannot be a <code class="docutils literal notranslate"><span class="pre">List</span></code> because aligning it with this
DeferredDataFrame is order-sensitive.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.insert</span></code></dt><dd><p>Insert new item by index.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col1  col2</span>
<span class="go">0     1     3</span>
<span class="go">1     2     4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;newcol&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col1  newcol  col2</span>
<span class="go">0     1      99     3</span>
<span class="go">1     2      99     4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">allow_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col1  col1  newcol  col2</span>
<span class="go">0   100     1      99     3</span>
<span class="go">1   100     2      99     4</span>

<span class="go">Notice that pandas uses index alignment in case of `value` from type `Series`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;col0&quot;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col0  col1  col1  newcol  col2</span>
<span class="go">0   NaN   100     1      99     3</span>
<span class="go">1   5.0   100     2      99     4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.from_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.from_dict" title="Link to this definition">¶</a></dt>
<dd><p>Construct DataFrame from dict of array-like or dicts.</p>
<p>Creates DataFrame object from dictionary by columns or by index
allowing dtype specification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Of the form {field : array-like} or {field : dict}.</p></li>
<li><p><strong>orient</strong> (<em>{'columns'</em><em>, </em><em>'index'</em><em>, </em><em>'tight'}</em><em>, </em><em>default 'columns'</em>) – <p>The “orientation” of the data. If the keys of the passed dict
should be the columns of the resulting DeferredDataFrame, pass ‘columns’
(default). Otherwise if the keys should be rows, pass ‘index’.
If ‘tight’, assume a dict with keys [‘index’, ‘columns’, ‘data’,
‘index_names’, ‘column_names’].</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.0: </span>‘tight’ as an allowed value for the <code class="docutils literal notranslate"><span class="pre">orient</span></code> argument</p>
</div>
</p></li>
<li><p><strong>dtype</strong> (<em>dtype</em><em>, </em><em>default None</em>) – Data type to force after DeferredDataFrame construction, otherwise infer.</p></li>
<li><p><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>default None</em>) – Column labels to use when <code class="docutils literal notranslate"><span class="pre">orient='index'</span></code>. Raises a ValueError
if used with <code class="docutils literal notranslate"><span class="pre">orient='columns'</span></code> or <code class="docutils literal notranslate"><span class="pre">orient='tight'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.from_records" title="apache_beam.dataframe.frames.DeferredDataFrame.from_records"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.from_records</span></code></a></dt><dd><p>DeferredDataFrame from structured ndarray, sequence of tuples or dicts, or DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code></a></dt><dd><p>DeferredDataFrame object creation using constructor.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_dict" title="apache_beam.dataframe.frames.DeferredDataFrame.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_dict</span></code></a></dt><dd><p>Convert the DeferredDataFrame to a dictionary.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default the keys of the dict become the DataFrame columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;col_2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">   col_1 col_2</span>
<span class="go">0      3     a</span>
<span class="go">1      2     b</span>
<span class="go">2      1     c</span>
<span class="go">3      0     d</span>

<span class="go">Specify ``orient=&#39;index&#39;`` to create the DataFrame using dictionary</span>
<span class="go">keys as rows:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;row_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;row_2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">       0  1  2  3</span>
<span class="go">row_1  3  2  1  0</span>
<span class="go">row_2  a  b  c  d</span>

<span class="go">When using the &#39;index&#39; orientation, the column names can be</span>
<span class="go">specified manually:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="go">       A  B  C  D</span>
<span class="go">row_1  3  2  1  0</span>
<span class="go">row_2  a  b  c  d</span>

<span class="go">Specify ``orient=&#39;tight&#39;`` to create the DataFrame using a &#39;tight&#39;</span>
<span class="go">format:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)],</span>
<span class="gp">... </span>        <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
<span class="gp">... </span>        <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>        <span class="s1">&#39;index_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;n1&#39;</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s1">&#39;column_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">,</span> <span class="s1">&#39;z2&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="go">z1     x  y</span>
<span class="go">z2     1  2</span>
<span class="go">n1 n2</span>
<span class="go">a  b   1  3</span>
<span class="go">   c   2  4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.from_records">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.from_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.from_records" title="Link to this definition">¶</a></dt>
<dd><p>Convert structured or record ndarray to DataFrame.</p>
<p>Creates a DataFrame object from a structured ndarray, sequence of
tuples or dicts, or DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>structured ndarray</em><em>, </em><em>sequence</em><em> of </em><em>tuples</em><em> or </em><em>dicts</em><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – <p>Structured input data.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.0: </span>Passing a DeferredDataFrame is deprecated.</p>
</div>
</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>fields</em><em>, </em><em>array-like</em>) – Field of array to use as the index, alternately a specific set of
input labels to use.</p></li>
<li><p><strong>exclude</strong> (<em>sequence</em><em>, </em><em>default None</em>) – Columns or fields to exclude.</p></li>
<li><p><strong>columns</strong> (<em>sequence</em><em>, </em><em>default None</em>) – Column names to use. If the passed data do not have names
associated with them, this argument provides names for the
columns. Otherwise this argument indicates the order of the columns
in the result (any names not found in the data will become all-NA
columns).</p></li>
<li><p><strong>coerce_float</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Attempt to convert values of non-string, non-numeric objects (like
decimal.Decimal) to floating point, useful for SQL result sets.</p></li>
<li><p><strong>nrows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default None</em>) – Number of rows to read if data is an iterator.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.from_dict" title="apache_beam.dataframe.frames.DeferredDataFrame.from_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.from_dict</span></code></a></dt><dd><p>DeferredDataFrame from dict of array-like or dicts.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code></a></dt><dd><p>DeferredDataFrame object creation using constructor.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Data can be provided as a structured ndarray:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;col_1&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;col_2&#39;</span><span class="p">,</span> <span class="s1">&#39;U1&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">   col_1 col_2</span>
<span class="go">0      3     a</span>
<span class="go">1      2     b</span>
<span class="go">2      1     c</span>
<span class="go">3      0     d</span>

<span class="go">Data can be provided as a list of dicts:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span>
<span class="gp">... </span>        <span class="p">{</span><span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">   col_1 col_2</span>
<span class="go">0      3     a</span>
<span class="go">1      2     b</span>
<span class="go">2      1     c</span>
<span class="go">3      0     d</span>

<span class="go">Data can be provided as a list of tuples with corresponding columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col_1&#39;</span><span class="p">,</span> <span class="s1">&#39;col_2&#39;</span><span class="p">])</span>
<span class="go">   col_1 col_2</span>
<span class="go">0      3     a</span>
<span class="go">1      2     b</span>
<span class="go">2      1     c</span>
<span class="go">3      0     d</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.duplicated">
<span class="sig-name descname"><span class="pre">duplicated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.duplicated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.duplicated" title="Link to this definition">¶</a></dt>
<dd><p>Return boolean Series denoting duplicate rows.</p>
<p>Considering certain columns is optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> (<em>column label</em><em> or </em><em>sequence</em><em> of </em><em>labels</em><em>, </em><em>optional</em>) – Only consider certain columns for identifying duplicates, by
default use all of the columns.</p></li>
<li><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>False}</em><em>, </em><em>default 'first'</em>) – <p>Determines which duplicates (if any) to mark.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first</span></code> : Mark duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code> except for the first occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last</span></code> : Mark duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code> except for the last occurrence.</p></li>
<li><p>False : Mark all duplicates as <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean series for each duplicated rows.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.duplicated</span></code></dt><dd><p>Equivalent method on index.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.duplicated" title="apache_beam.dataframe.frames.DeferredSeries.duplicated"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.duplicated</span></code></a></dt><dd><p>Equivalent method on DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.drop_duplicates" title="apache_beam.dataframe.frames.DeferredSeries.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.drop_duplicates</span></code></a></dt><dd><p>Remove duplicate values from DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates" title="apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.drop_duplicates</span></code></a></dt><dd><p>Remove duplicate values from DeferredDataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Consider dataset containing ramen rating.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;brand&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Yum Yum&#39;</span><span class="p">,</span> <span class="s1">&#39;Yum Yum&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">    brand style  rating</span>
<span class="go">0  Yum Yum   cup     4.0</span>
<span class="go">1  Yum Yum   cup     4.0</span>
<span class="go">2  Indomie   cup     3.5</span>
<span class="go">3  Indomie  pack    15.0</span>
<span class="go">4  Indomie  pack     5.0</span>

<span class="go">By default, for each set of duplicated values, the first occurrence</span>
<span class="go">is set on False and all others on True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">By using &#39;last&#39;, the last occurrence of each set of duplicated values</span>
<span class="go">is set on False and all others on True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">2    False</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">By setting ``keep`` on False, all duplicates are True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">3    False</span>
<span class="go">4    False</span>
<span class="go">dtype: bool</span>

<span class="go">To find duplicates on specific column(s), use ``subset``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">])</span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">3     True</span>
<span class="go">4     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates">
<span class="sig-name descname"><span class="pre">drop_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.drop_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.drop_duplicates" title="Link to this definition">¶</a></dt>
<dd><p>Return DataFrame with duplicate rows removed.</p>
<p>Considering certain columns is optional. Indexes, including time indexes
are ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> (<em>column label</em><em> or </em><em>sequence</em><em> of </em><em>labels</em><em>, </em><em>optional</em>) – Only consider certain columns for identifying duplicates, by
default use all of the columns.</p></li>
<li><p><strong>keep</strong> ({‘first’, ‘last’, <code class="docutils literal notranslate"><span class="pre">False</span></code>}, default ‘first’) – <p>Determines which duplicates (if any) to keep.</p>
<ul>
<li><p>’first’ : Drop duplicates except for the first occurrence.</p></li>
<li><p>’last’ : Drop duplicates except for the last occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> : Drop all duplicates.</p></li>
</ul>
</p></li>
<li><p><strong>inplace</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Whether to modify the DeferredDataFrame rather than creating a new one.</p></li>
<li><p><strong>ignore_index</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the resulting axis will be labeled 0, 1, …, n - 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredDataFrame with duplicates removed or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.value_counts" title="apache_beam.dataframe.frames.DeferredDataFrame.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.value_counts</span></code></a></dt><dd><p>Count unique combinations of columns.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Consider dataset containing ramen rating.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>    <span class="s1">&#39;brand&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Yum Yum&#39;</span><span class="p">,</span> <span class="s1">&#39;Yum Yum&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">,</span> <span class="s1">&#39;Indomie&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;cup&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">,</span> <span class="s1">&#39;pack&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="s1">&#39;rating&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">... </span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">    brand style  rating</span>
<span class="go">0  Yum Yum   cup     4.0</span>
<span class="go">1  Yum Yum   cup     4.0</span>
<span class="go">2  Indomie   cup     3.5</span>
<span class="go">3  Indomie  pack    15.0</span>
<span class="go">4  Indomie  pack     5.0</span>

<span class="go">By default, it removes duplicate rows based on all columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="go">    brand style  rating</span>
<span class="go">0  Yum Yum   cup     4.0</span>
<span class="go">2  Indomie   cup     3.5</span>
<span class="go">3  Indomie  pack    15.0</span>
<span class="go">4  Indomie  pack     5.0</span>

<span class="go">To remove duplicates on specific column(s), use ``subset``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">])</span>
<span class="go">    brand style  rating</span>
<span class="go">0  Yum Yum   cup     4.0</span>
<span class="go">2  Indomie   cup     3.5</span>

<span class="go">To remove duplicates and keep last occurrences, use ``keep``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;brand&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">    brand style  rating</span>
<span class="go">1  Yum Yum   cup     4.0</span>
<span class="go">2  Indomie   cup     3.5</span>
<span class="go">4  Indomie  pack     5.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.aggregate">
<span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.aggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.aggregate" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate using one or more operations over the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – <p>Function to use for aggregating the data. If a function, must either
work when passed a DeferredDataFrame or when passed to DeferredDataFrame.apply.</p>
<p>Accepted combinations are:</p>
<ul>
<li><p>function</p></li>
<li><p>string function name</p></li>
<li><p>list of functions and/or function names, e.g. <code class="docutils literal notranslate"><span class="pre">[np.sum,</span> <span class="pre">'mean']</span></code></p></li>
<li><p>dict of axis labels -&gt; functions, function names or list of such.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – If 0 or ‘index’: apply function to each column.
If 1 or ‘columns’: apply function to each row.</p></li>
<li><p><strong>*args</strong> – Positional arguments to pass to <cite>func</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to <cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The return can be:</p>
<ul class="simple">
<li><p>scalar : when DeferredSeries.agg is called with single function</p></li>
<li><p>DeferredSeries : when DeferredDataFrame.agg is called with a single function</p></li>
<li><p>DeferredDataFrame : when DeferredDataFrame.agg is called with several functions</p></li>
</ul>
<p>Return scalar, DeferredSeries or DeferredDataFrame.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="apache_beam.dataframe.frames.DeferredDataFrame.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.apply</span></code></a></dt><dd><p>Perform any type of operations.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.transform</span></code></dt><dd><p>Perform transformation type operations.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.groupby.GroupBy</span></code></dt><dd><p>Perform operations over groups.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.resample.Resampler</span></code></dt><dd><p>Perform operations over resampled bins.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.Rolling</span></code></dt><dd><p>Perform operations over rolling window.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.Expanding</span></code></dt><dd><p>Perform operations over expanding window.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.ExponentialMovingWindow</span></code></dt><dd><p>Perform operation over exponential weighted window.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The aggregation operations are always performed over an axis, either the
index (default) or the column axis. This behavior is different from
<cite>numpy</cite> aggregation functions (<cite>mean</cite>, <cite>median</cite>, <cite>prod</cite>, <cite>sum</cite>, <cite>std</cite>,
<cite>var</cite>), where the default is to compute the aggregation of the flattened
array, e.g., <code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d)</span></code> as opposed to
<code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d,</span> <span class="pre">axis=0)</span></code>.</p>
<p><cite>agg</cite> is an alias for <cite>aggregate</cite>. Use the alias.</p>
<p>Functions that mutate the passed object can produce unexpected
behavior or errors and are not supported. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/gotchas.html#gotchas-udf-mutation" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span>Mutating with User Defined Function (UDF) methods</span></a>
for more details.</p>
<p>A passed user-defined-function will be passed a DeferredSeries for evaluation.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="go">Aggregate these functions over the rows.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">])</span>
<span class="go">        A     B     C</span>
<span class="go">sum  12.0  15.0  18.0</span>
<span class="go">min   1.0   2.0   3.0</span>

<span class="go">Different aggregations per column.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">]})</span>
<span class="go">        A    B</span>
<span class="go">sum  12.0  NaN</span>
<span class="go">min   1.0  2.0</span>
<span class="go">max   NaN  8.0</span>

<span class="go">Aggregate different functions over the columns and rename the index of the resulting</span>
<span class="go">DataFrame.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
<span class="go">     A    B    C</span>
<span class="go">x  7.0  NaN  NaN</span>
<span class="go">y  NaN  2.0  NaN</span>
<span class="go">z  NaN  NaN  6.0</span>

<span class="go">Aggregate over the columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="go">0    2.0</span>
<span class="go">1    5.0</span>
<span class="go">2    8.0</span>
<span class="go">3    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.agg">
<span class="sig-name descname"><span class="pre">agg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.agg" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate using one or more operations over the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>function</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – <p>Function to use for aggregating the data. If a function, must either
work when passed a DeferredDataFrame or when passed to DeferredDataFrame.apply.</p>
<p>Accepted combinations are:</p>
<ul>
<li><p>function</p></li>
<li><p>string function name</p></li>
<li><p>list of functions and/or function names, e.g. <code class="docutils literal notranslate"><span class="pre">[np.sum,</span> <span class="pre">'mean']</span></code></p></li>
<li><p>dict of axis labels -&gt; functions, function names or list of such.</p></li>
</ul>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – If 0 or ‘index’: apply function to each column.
If 1 or ‘columns’: apply function to each row.</p></li>
<li><p><strong>*args</strong> – Positional arguments to pass to <cite>func</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to <cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The return can be:</p>
<ul class="simple">
<li><p>scalar : when DeferredSeries.agg is called with single function</p></li>
<li><p>DeferredSeries : when DeferredDataFrame.agg is called with a single function</p></li>
<li><p>DeferredDataFrame : when DeferredDataFrame.agg is called with several functions</p></li>
</ul>
<p>Return scalar, DeferredSeries or DeferredDataFrame.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="apache_beam.dataframe.frames.DeferredDataFrame.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.apply</span></code></a></dt><dd><p>Perform any type of operations.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.transform</span></code></dt><dd><p>Perform transformation type operations.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.groupby.GroupBy</span></code></dt><dd><p>Perform operations over groups.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.resample.Resampler</span></code></dt><dd><p>Perform operations over resampled bins.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.Rolling</span></code></dt><dd><p>Perform operations over rolling window.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.Expanding</span></code></dt><dd><p>Perform operations over expanding window.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.ExponentialMovingWindow</span></code></dt><dd><p>Perform operation over exponential weighted window.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The aggregation operations are always performed over an axis, either the
index (default) or the column axis. This behavior is different from
<cite>numpy</cite> aggregation functions (<cite>mean</cite>, <cite>median</cite>, <cite>prod</cite>, <cite>sum</cite>, <cite>std</cite>,
<cite>var</cite>), where the default is to compute the aggregation of the flattened
array, e.g., <code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d)</span></code> as opposed to
<code class="docutils literal notranslate"><span class="pre">numpy.mean(arr_2d,</span> <span class="pre">axis=0)</span></code>.</p>
<p><cite>agg</cite> is an alias for <cite>aggregate</cite>. Use the alias.</p>
<p>Functions that mutate the passed object can produce unexpected
behavior or errors and are not supported. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/gotchas.html#gotchas-udf-mutation" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span>Mutating with User Defined Function (UDF) methods</span></a>
for more details.</p>
<p>A passed user-defined-function will be passed a DeferredSeries for evaluation.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>

<span class="go">Aggregate these functions over the rows.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">])</span>
<span class="go">        A     B     C</span>
<span class="go">sum  12.0  15.0  18.0</span>
<span class="go">min   1.0   2.0   3.0</span>

<span class="go">Different aggregations per column.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">]})</span>
<span class="go">        A    B</span>
<span class="go">sum  12.0  NaN</span>
<span class="go">min   1.0  2.0</span>
<span class="go">max   NaN  8.0</span>

<span class="go">Aggregate different functions over the columns and rename the index of the resulting</span>
<span class="go">DataFrame.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">))</span>
<span class="go">     A    B    C</span>
<span class="go">x  7.0  NaN  NaN</span>
<span class="go">y  NaN  2.0  NaN</span>
<span class="go">z  NaN  NaN  6.0</span>

<span class="go">Aggregate over the columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="go">0    2.0</span>
<span class="go">1    5.0</span>
<span class="go">2    8.0</span>
<span class="go">3    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.applymap">
<span class="sig-name descname"><span class="pre">applymap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.applymap" title="Link to this definition">¶</a></dt>
<dd><p>Apply a function to a Dataframe elementwise.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.1.0: </span>DataFrame.applymap has been deprecated. Use DataFrame.map instead.</p>
</div>
<p>This method applies a function that accepts and returns a scalar
to every element of a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – Python function, returns a single value from a single value.</p></li>
<li><p><strong>na_action</strong> (<em>{None</em><em>, </em><em>'ignore'}</em><em>, </em><em>default None</em>) – If ‘ignore’, propagate NaN values, without passing them to func.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass as keywords arguments to
<cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="apache_beam.dataframe.frames.DeferredDataFrame.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.apply</span></code></a></dt><dd><p>Apply a function along input axis of DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.map" title="apache_beam.dataframe.frames.DeferredDataFrame.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.map</span></code></a></dt><dd><p>Apply a function along input axis of DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.replace</span></code></dt><dd><p>Replace values given in <cite>to_replace</cite> with <cite>value</cite>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.12</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.356</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       0      1</span>
<span class="go">0  1.000  2.120</span>
<span class="go">1  3.356  4.567</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">   0  1</span>
<span class="go">0  3  4</span>
<span class="go">1  5  5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.map" title="Link to this definition">¶</a></dt>
<dd><p>Apply a function to a Dataframe elementwise.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.1.0: </span>DataFrame.applymap was deprecated and renamed to DataFrame.map.</p>
</div>
<p>This method applies a function that accepts and returns a scalar
to every element of a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – Python function, returns a single value from a single value.</p></li>
<li><p><strong>na_action</strong> (<em>{None</em><em>, </em><em>'ignore'}</em><em>, </em><em>default None</em>) – If ‘ignore’, propagate NaN values, without passing them to func.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass as keywords arguments to
<cite>func</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="apache_beam.dataframe.frames.DeferredDataFrame.apply"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.apply</span></code></a></dt><dd><p>Apply a function along input axis of DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.replace</span></code></dt><dd><p>Replace values given in <cite>to_replace</cite> with <cite>value</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.map" title="apache_beam.dataframe.frames.DeferredSeries.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.map</span></code></a></dt><dd><p>Apply a function elementwise on a DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.12</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.356</span><span class="p">,</span> <span class="mf">4.567</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       0      1</span>
<span class="go">0  1.000  2.120</span>
<span class="go">1  3.356  4.567</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">   0  1</span>
<span class="go">0  3  4</span>
<span class="go">1  5  5</span>

<span class="go">Like Series.map, NA values can be ignored:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_copy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_copy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_copy</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">na_action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="go">     0  1</span>
<span class="go">0  NaN  4</span>
<span class="go">1  5.0  5</span>

<span class="go">Note that a vectorized version of `func` often exists, which will</span>
<span class="go">be much faster. You could square each number elementwise.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">           0          1</span>
<span class="go">0   1.000000   4.494400</span>
<span class="go">1  11.262736  20.857489</span>

<span class="go">But it&#39;s better to avoid map in that case.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">**</span> <span class="mi">2</span>
<span class="go">           0          1</span>
<span class="go">0   1.000000   4.494400</span>
<span class="go">1  11.262736  20.857489</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.add_prefix">
<span class="sig-name descname"><span class="pre">add_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_prefix" title="Link to this definition">¶</a></dt>
<dd><p>Prefix labels with string <cite>prefix</cite>.</p>
<p>For Series, the row labels are prefixed.
For DataFrame, the column labels are prefixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The string to add before each label.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Axis to add prefix on</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New DeferredSeries or DeferredDataFrame with updated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.add_suffix" title="apache_beam.dataframe.frames.DeferredSeries.add_suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.add_suffix</span></code></a></dt><dd><p>Suffix row labels with string <cite>suffix</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_suffix" title="apache_beam.dataframe.frames.DeferredDataFrame.add_suffix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add_suffix</span></code></a></dt><dd><p>Suffix column labels with string <cite>suffix</cite>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;item_&#39;</span><span class="p">)</span>
<span class="go">item_0    1</span>
<span class="go">item_1    2</span>
<span class="go">item_2    3</span>
<span class="go">item_3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  1  3</span>
<span class="go">1  2  4</span>
<span class="go">2  3  5</span>
<span class="go">3  4  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;col_&#39;</span><span class="p">)</span>
<span class="go">     col_A  col_B</span>
<span class="go">0       1       3</span>
<span class="go">1       2       4</span>
<span class="go">2       3       5</span>
<span class="go">3       4       6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.add_suffix">
<span class="sig-name descname"><span class="pre">add_suffix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_suffix" title="Link to this definition">¶</a></dt>
<dd><p>Suffix labels with string <cite>suffix</cite>.</p>
<p>For Series, the row labels are suffixed.
For DataFrame, the column labels are suffixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The string to add after each label.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – <p>Axis to add suffix on</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New DeferredSeries or DeferredDataFrame with updated labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.add_prefix" title="apache_beam.dataframe.frames.DeferredSeries.add_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.add_prefix</span></code></a></dt><dd><p>Prefix row labels with string <cite>prefix</cite>.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add_prefix" title="apache_beam.dataframe.frames.DeferredDataFrame.add_prefix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add_prefix</span></code></a></dt><dd><p>Prefix column labels with string <cite>prefix</cite>.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s1">&#39;_item&#39;</span><span class="p">)</span>
<span class="go">0_item    1</span>
<span class="go">1_item    2</span>
<span class="go">2_item    3</span>
<span class="go">3_item    4</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  1  3</span>
<span class="go">1  2  4</span>
<span class="go">2  3  5</span>
<span class="go">3  4  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add_suffix</span><span class="p">(</span><span class="s1">&#39;_col&#39;</span><span class="p">)</span>
<span class="go">     A_col  B_col</span>
<span class="go">0       1       3</span>
<span class="go">1       2       4</span>
<span class="go">2       3       5</span>
<span class="go">3       4       6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.memory_usage">
<span class="sig-name descname"><span class="pre">memory_usage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.memory_usage" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.memory_usage.html#pandas.DataFrame.memory_usage" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.memory_usage()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.info" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.info.html#pandas.DataFrame.info" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.info()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.clip">
<span class="sig-name descname"><span class="pre">clip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.clip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.clip" title="Link to this definition">¶</a></dt>
<dd><p>Trim values at input threshold(s).</p>
<p>Assigns values outside boundary to boundary values. Thresholds
can be singular values or array like, and in the latter case
the clipping is performed element-wise in the specified axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lower</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default None</em>) – Minimum threshold value. All values below this
threshold will be set to it. A missing
threshold (e.g <cite>NA</cite>) will not clip the value.</p></li>
<li><p><strong>upper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default None</em>) – Maximum threshold value. All values above this
threshold will be set to it. A missing
threshold (e.g <cite>NA</cite>) will not clip the value.</p></li>
<li><p><strong>axis</strong> (<em>{{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}}</em><em>, </em><em>default None</em>) – Align object with lower and upper along the given axis.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to perform the operation in place on the data.</p></li>
<li><p><strong>*args</strong> – Additional keywords have no effect but might be accepted
for compatibility with numpy.</p></li>
<li><p><strong>**kwargs</strong> – Additional keywords have no effect but might be accepted
for compatibility with numpy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Same type as calling object with the values outside the
clip boundaries replaced or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">lower</span></code> and <code class="docutils literal notranslate"><span class="pre">upper</span></code> must be <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredSeries</span></code></a> instances, or
constants.  Array-like arguments are not supported because they are
order-sensitive.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.clip" title="apache_beam.dataframe.frames.DeferredSeries.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.clip</span></code></a></dt><dd><p>Trim values at input threshold in series.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.clip" title="apache_beam.dataframe.frames.DeferredDataFrame.clip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.clip</span></code></a></dt><dd><p>Trim values at input threshold in dataframe.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.clip</span></code></a></dt><dd><p>Clip (limit) the values in an array.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;col_0&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;col_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      9     -2</span>
<span class="go">1     -3     -7</span>
<span class="go">2      0      6</span>
<span class="go">3     -1      8</span>
<span class="go">4      5     -5</span>

<span class="go">Clips per column using lower and upper thresholds:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      6     -2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      6</span>
<span class="go">3     -1      6</span>
<span class="go">4      5     -4</span>

<span class="go">Clips using specific lower and upper thresholds per column element:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">0    2</span>
<span class="go">1   -4</span>
<span class="go">2   -1</span>
<span class="go">3    6</span>
<span class="go">4    3</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">   col_0  col_1</span>
<span class="go">0      6      2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      3</span>
<span class="go">3      6      8</span>
<span class="go">4      5      3</span>

<span class="go">Clips using specific lower threshold per column element, with missing values:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">0    2.0</span>
<span class="go">1   -4.0</span>
<span class="go">2    NaN</span>
<span class="go">3    6.0</span>
<span class="go">4    3.0</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">col_0  col_1</span>
<span class="go">0      9      2</span>
<span class="go">1     -3     -4</span>
<span class="go">2      0      6</span>
<span class="go">3      6      8</span>
<span class="go">4      5      3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.corr">
<span class="sig-name descname"><span class="pre">corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_periods</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.corr" title="Link to this definition">¶</a></dt>
<dd><p>Compute pairwise correlation of columns, excluding NA/null values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{'pearson'</em><em>, </em><em>'kendall'</em><em>, </em><em>'spearman'}</em><em> or </em><em>callable</em>) – <p>Method of correlation:</p>
<ul>
<li><p>pearson : standard correlation coefficient</p></li>
<li><p>kendall : Kendall Tau correlation coefficient</p></li>
<li><p>spearman : Spearman rank correlation</p></li>
<li><dl class="simple">
<dt>callable: callable with input two 1d ndarrays</dt><dd><p>and returning a float. Note that the returned matrix from corr
will have 1 along the diagonals and will be symmetric
regardless of the callable’s behavior.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>min_periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Minimum number of observations required per pair of columns
to have a valid result. Currently only available for Pearson
and Spearman correlation.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>The default value of <code class="docutils literal notranslate"><span class="pre">numeric_only</span></code> is now <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Correlation matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">method=&quot;pearson&quot;</span></code> can be parallelized. Other methods require
collecting all data on a single worker (see
<a class="reference external" href="https://s.apache.org/dataframe-non-parallel-operations">https://s.apache.org/dataframe-non-parallel-operations</a> for details).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.corrwith" title="apache_beam.dataframe.frames.DeferredDataFrame.corrwith"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.corrwith</span></code></a></dt><dd><p>Compute pairwise correlation with another DeferredDataFrame or DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.corr" title="apache_beam.dataframe.frames.DeferredSeries.corr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.corr</span></code></a></dt><dd><p>Compute the correlation between two DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Pearson, Kendall and Spearman correlation are currently computed using pairwise complete observations.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient">Pearson correlation coefficient</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Kendall_rank_correlation_coefficient">Kendall rank correlation coefficient</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman’s rank correlation coefficient</a></p></li>
</ul>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">histogram_intersection</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.3</span><span class="p">),</span> <span class="p">(</span><span class="mf">.0</span><span class="p">,</span> <span class="mf">.6</span><span class="p">),</span> <span class="p">(</span><span class="mf">.6</span><span class="p">,</span> <span class="mf">.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">.2</span><span class="p">,</span> <span class="mf">.1</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dogs&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">histogram_intersection</span><span class="p">)</span>
<span class="go">      dogs  cats</span>
<span class="go">dogs   1.0   0.3</span>
<span class="go">cats   0.3   1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dogs&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">min_periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">      dogs  cats</span>
<span class="go">dogs   1.0   NaN</span>
<span class="go">cats   NaN   1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.cov">
<span class="sig-name descname"><span class="pre">cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_periods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.cov"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.cov" title="Link to this definition">¶</a></dt>
<dd><p>Compute pairwise covariance of columns, excluding NA/null values.</p>
<p>Compute the pairwise covariance among the series of a DataFrame.
The returned data frame is the <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance_matrix">covariance matrix</a> of the columns
of the DataFrame.</p>
<p>Both NA and null values are automatically excluded from the
calculation. (See the note below about bias from missing values.)
A threshold can be set for the minimum number of
observations for each value created. Comparisons with observations
below this threshold will be returned as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>This method is generally used for the analysis of time series data to
understand the relationship between different measures
across time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Minimum number of observations required per pair of columns
to have a valid result.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta degrees of freedom.  The divisor used in calculations
is <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">-</span> <span class="pre">ddof</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> represents the number of elements.
This argument is applicable only when no <code class="docutils literal notranslate"><span class="pre">nan</span></code> is in the dataframe.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>The default value of <code class="docutils literal notranslate"><span class="pre">numeric_only</span></code> is now <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The covariance matrix of the series of the DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.cov" title="apache_beam.dataframe.frames.DeferredSeries.cov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.cov</span></code></a></dt><dd><p>Compute covariance with another DeferredSeries.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.ewm.ExponentialMovingWindow.cov</span></code></dt><dd><p>Exponential weighted sample covariance.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.expanding.Expanding.cov</span></code></dt><dd><p>Expanding sample covariance.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.rolling.Rolling.cov</span></code></dt><dd><p>Rolling sample covariance.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Returns the covariance matrix of the DeferredDataFrame’s time series.
The covariance is normalized by N-ddof.</p>
<p>For DeferredDataFrames that have DeferredSeries that are missing data (assuming that
data is <a class="reference external" href="https://en.wikipedia.org/wiki/Missing_data#Missing_at_random">missing at random</a>)
the returned covariance matrix will be an unbiased estimate
of the variance and covariance between the member DeferredSeries.</p>
<p>However, for many applications this estimate may not be acceptable
because the estimate covariance matrix is not guaranteed to be positive
semi-definite. This could lead to estimate correlations having
absolute values which are greater than one, and/or a non-invertible
covariance matrix. See <a class="reference external" href="https://en.wikipedia.org/w/index.php?title=Estimation_of_covariance_matrices">Estimation of covariance matrices</a> for more details.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dogs&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="go">          dogs      cats</span>
<span class="go">dogs  0.666667 -1.000000</span>
<span class="go">cats -1.000000  1.666667</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="go">          a         b         c         d         e</span>
<span class="go">a  0.998438 -0.020161  0.059277 -0.008943  0.014144</span>
<span class="go">b -0.020161  1.059352 -0.008543 -0.024738  0.009826</span>
<span class="go">c  0.059277 -0.008543  1.010670 -0.001486 -0.000271</span>
<span class="go">d -0.008943 -0.024738 -0.001486  0.921297 -0.013692</span>
<span class="go">e  0.014144  0.009826 -0.000271 -0.013692  0.977795</span>

<span class="go">**Minimum number of periods**</span>

<span class="go">This method also supports an optional ``min_periods`` keyword</span>
<span class="go">that specifies the required minimum number of non-NA observations for</span>
<span class="go">each column pair in order to have a valid result:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">min_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="go">          a         b         c</span>
<span class="go">a  0.316741       NaN -0.150812</span>
<span class="go">b       NaN  1.248003  0.191417</span>
<span class="go">c -0.150812  0.191417  0.895202</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.corrwith">
<span class="sig-name descname"><span class="pre">corrwith</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.corrwith"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.corrwith" title="Link to this definition">¶</a></dt>
<dd><p>Compute pairwise correlation.</p>
<p>Pairwise correlation is computed between rows or columns of
DataFrame with rows or columns of Series or DataFrame. DataFrames
are first aligned along both axes before computing the
correlations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – Object with which to compute correlations.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to use. 0 or ‘index’ to compute row-wise, 1 or ‘columns’ for
column-wise.</p></li>
<li><p><strong>drop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Drop missing indices from result.</p></li>
<li><p><strong>method</strong> (<em>{'pearson'</em><em>, </em><em>'kendall'</em><em>, </em><em>'spearman'}</em><em> or </em><em>callable</em>) – <p>Method of correlation:</p>
<ul>
<li><p>pearson : standard correlation coefficient</p></li>
<li><p>kendall : Kendall Tau correlation coefficient</p></li>
<li><p>spearman : Spearman rank correlation</p></li>
<li><dl class="simple">
<dt>callable: callable with input two 1d ndarrays</dt><dd><p>and returning a float.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>The default value of <code class="docutils literal notranslate"><span class="pre">numeric_only</span></code> is now <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pairwise correlations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.corr" title="apache_beam.dataframe.frames.DeferredDataFrame.corr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.corr</span></code></a></dt><dd><p>Compute pairwise correlation of columns.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">,</span> <span class="s2">&quot;three&quot;</span><span class="p">,</span> <span class="s2">&quot;four&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="go">one      1.0</span>
<span class="go">two      1.0</span>
<span class="go">three    1.0</span>
<span class="go">four     1.0</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">a    1.0</span>
<span class="go">b    1.0</span>
<span class="go">c    1.0</span>
<span class="go">d    1.0</span>
<span class="go">e    NaN</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.cummax">
<span class="sig-name descname"><span class="pre">cummax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.cummax" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.cummax.html#pandas.DataFrame.cummax" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.cummax()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.cummin">
<span class="sig-name descname"><span class="pre">cummin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.cummin" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.cummin.html#pandas.DataFrame.cummin" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.cummin()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.cumprod">
<span class="sig-name descname"><span class="pre">cumprod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.cumprod" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.cumprod.html#pandas.DataFrame.cumprod" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.cumprod()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.cumsum">
<span class="sig-name descname"><span class="pre">cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.cumsum" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.cumsum.html#pandas.DataFrame.cumsum" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.cumsum()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.diff" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.diff.html#pandas.DataFrame.diff" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.diff()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.interpolate" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.interpolate.html#pandas.DataFrame.interpolate" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.interpolate()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.pct_change">
<span class="sig-name descname"><span class="pre">pct_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.pct_change" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.pct_change.html#pandas.DataFrame.pct_change" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.pct_change()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.asof">
<span class="sig-name descname"><span class="pre">asof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.asof" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.asof.html#pandas.DataFrame.asof" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.asof()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.first_valid_index">
<span class="sig-name descname"><span class="pre">first_valid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.first_valid_index" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.first_valid_index.html#pandas.DataFrame.first_valid_index" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.first_valid_index()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.last_valid_index">
<span class="sig-name descname"><span class="pre">last_valid_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.last_valid_index" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.last_valid_index.html#pandas.DataFrame.last_valid_index" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.last_valid_index()</span></code></a> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.iat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iat</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.iat" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.iat()</span></code> is not yet supported in the Beam DataFrame API because it is sensitive to the order of the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">https://s.apache.org/dataframe-order-sensitive-operations</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.lookup">
<span class="sig-name descname"><span class="pre">lookup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.lookup" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.lookup()</span></code> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.head">
<span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.head" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.head()</span></code></a> is not yet supported in the Beam DataFrame API because it is <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>.</p>
<p>If you want to peek at a large dataset consider using interactive Beam’s <a class="reference internal" href="apache_beam.runners.interactive.interactive_beam.html#apache_beam.runners.interactive.interactive_beam.collect" title="apache_beam.runners.interactive.interactive_beam.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ib.collect</span></code></a> with <code class="docutils literal notranslate"><span class="pre">n</span></code> specified, or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sample" title="apache_beam.dataframe.frames.DeferredDataFrame.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>. If you want to find the N largest elements, consider using <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="apache_beam.dataframe.frames.DeferredDataFrame.nlargest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.nlargest()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.tail">
<span class="sig-name descname"><span class="pre">tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.tail" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.tail()</span></code></a> is not yet supported in the Beam DataFrame API because it is <a class="reference external" href="https://s.apache.org/dataframe-order-sensitive-operations">order-sensitive</a>.</p>
<p>If you want to peek at a large dataset consider using interactive Beam’s <a class="reference internal" href="apache_beam.runners.interactive.interactive_beam.html#apache_beam.runners.interactive.interactive_beam.collect" title="apache_beam.runners.interactive.interactive_beam.collect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ib.collect</span></code></a> with <code class="docutils literal notranslate"><span class="pre">n</span></code> specified, or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sample" title="apache_beam.dataframe.frames.DeferredDataFrame.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a>. If you want to find the N largest elements, consider using <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="apache_beam.dataframe.frames.DeferredDataFrame.nlargest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.nlargest()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.sample" title="Link to this definition">¶</a></dt>
<dd><p>Return a random sample of items from an axis of object.</p>
<p>You can use <cite>random_state</cite> for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of items from axis to return. Cannot be used with <cite>frac</cite>.
Default = 1 if <cite>frac</cite> = None.</p></li>
<li><p><strong>frac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Fraction of axis items to return. Cannot be used with <cite>n</cite>.</p></li>
<li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Allow or disallow sampling of the same row more than once.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>ndarray-like</em><em>, </em><em>optional</em>) – Default ‘None’ results in equal probability weighting.
If passed a DeferredSeries, will align with target object on index. Index
values in weights not found in sampled object will be ignored and
index values in sampled object not in weights will be assigned
weights of zero.
If called on a DeferredDataFrame, will accept the name of a column
when axis = 0.
Unless weights are a DeferredSeries, weights must be same length as axis
being sampled.
If weights do not sum to 1, they will be normalized to sum to 1.
Missing values in the weights column will be treated as zero.
Infinite values not allowed.</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>array-like</em><em>, </em><em>BitGenerator</em><em>, </em><em>np.random.RandomState</em><em>, </em><em>np.random.Generator</em><em>, </em><em>optional</em>) – <p>If int, array-like, or BitGenerator, seed for random number generator.
If np.random.RandomState or np.random.Generator, use as given.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>np.random.Generator objects now accepted</p>
</div>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – Axis to sample. Accepts axis number or name. Default is stat axis
for given data type. For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>If True, the resulting index will be labeled 0, 1, …, n - 1.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new object of same type as caller containing <cite>n</cite> items randomly
sampled from the caller object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>When <code class="docutils literal notranslate"><span class="pre">axis='index'</span></code>, only <code class="docutils literal notranslate"><span class="pre">n</span></code> and/or <code class="docutils literal notranslate"><span class="pre">weights</span></code> may be specified.
<code class="docutils literal notranslate"><span class="pre">frac</span></code>, <code class="docutils literal notranslate"><span class="pre">random_state</span></code>, and <code class="docutils literal notranslate"><span class="pre">replace=True</span></code> are not yet supported.
See <a class="reference external" href="https://github.com/apache/beam/issues/21010">Issue 21010</a>.</p>
<p>Note that pandas will raise an error if <code class="docutils literal notranslate"><span class="pre">n</span></code> is larger than the length
of the dataset, while the Beam DataFrame API will simply return the full
dataset in that case.</p>
<p>sample is fully supported for axis=’columns’.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrameGroupBy.sample</span></code></dt><dd><p>Generates random samples from each group of a DeferredDataFrame object.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeriesGroupBy.sample</span></code></dt><dd><p>Generates random samples from each group of a DeferredSeries object.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.choice.html#numpy.random.choice" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.choice</span></code></a></dt><dd><p>Generates a random sample from a given 1-D numpy array.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>If <cite>frac</cite> &gt; 1, <cite>replacement</cite> should be set to <cite>True</cite>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;num_legs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;num_wings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;num_specimen_seen&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">dog            4          0                  2</span>
<span class="go">spider         8          0                  1</span>
<span class="go">fish           0          0                  8</span>

<span class="go">Extract 3 random elements from the ``Series`` ``df[&#39;num_legs&#39;]``:</span>
<span class="go">Note that we use `random_state` to ensure the reproducibility of</span>
<span class="go">the examples.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_legs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">fish      0</span>
<span class="go">spider    8</span>
<span class="go">falcon    2</span>
<span class="go">Name: num_legs, dtype: int64</span>

<span class="go">A random 50% sample of the ``DataFrame`` with replacement:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">      num_legs  num_wings  num_specimen_seen</span>
<span class="go">dog          4          0                  2</span>
<span class="go">fish         0          0                  8</span>

<span class="go">An upsample sample of the ``DataFrame`` with replacement:</span>
<span class="go">Note that `replace` parameter has to be `True` for `frac` parameter &gt; 1.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">dog            4          0                  2</span>
<span class="go">fish           0          0                  8</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">fish           0          0                  8</span>
<span class="go">dog            4          0                  2</span>
<span class="go">fish           0          0                  8</span>
<span class="go">dog            4          0                  2</span>

<span class="go">Using a DataFrame column as weights. Rows with larger value in the</span>
<span class="go">`num_specimen_seen` column are more likely to be sampled.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;num_specimen_seen&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">        num_legs  num_wings  num_specimen_seen</span>
<span class="go">falcon         2          2                 10</span>
<span class="go">fish           0          0                  8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.dot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.dot" title="Link to this definition">¶</a></dt>
<dd><p>Compute the matrix multiplication between the DataFrame and other.</p>
<p>This method computes the matrix product between the DataFrame and the
values of an other Series, DataFrame or a numpy array.</p>
<p>It can also be called using <code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">&#64;</span> <span class="pre">other</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em> or </em><em>array-like</em>) – The other object to compute the matrix product with.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If other is a DeferredSeries, return the matrix product between self and
other as a DeferredSeries. If other is a DeferredDataFrame or a numpy.array, return
the matrix product of self and other in a DeferredDataFrame of a np.array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dot" title="apache_beam.dataframe.frames.DeferredSeries.dot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dot</span></code></a></dt><dd><p>Similar method for DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The dimensions of DeferredDataFrame and other must be compatible in order to
compute the matrix multiplication. In addition, the column names of
DeferredDataFrame and the index of other must contain the same values, as they
will be aligned prior to the multiplication.</p>
<p>The dot method for DeferredSeries computes the inner product, instead of the
matrix product here.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Here we multiply a DataFrame with a Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">0    -4</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>

<span class="go">Here we multiply a DataFrame with another DataFrame.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">Note that the dot method give the same result as @</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">@</span> <span class="n">other</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">The dot method works also if other is an np.array.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">    0   1</span>
<span class="go">0   1   4</span>
<span class="go">1   2   2</span>

<span class="go">Note how shuffling of the objects does not change the result.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">0    -4</span>
<span class="go">1     5</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.mode" title="Link to this definition">¶</a></dt>
<dd><p>Get the mode(s) of each element along the selected axis.</p>
<p>The mode of a set of values is the value that appears most often.
It can be multiple values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – <p>The axis to iterate over while searching for the mode:</p>
<ul>
<li><p>0 or ‘index’ : get mode of each column</p></li>
<li><p>1 or ‘columns’ : get mode of each row.</p></li>
</ul>
</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If True, only apply to numeric columns.</p></li>
<li><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Don’t consider counts of NaN/NaT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modes of each column or row.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>mode with axis=”columns” is not implemented because it produces
non-deferred columns.</p>
<p>mode with axis=”index” is not currently parallelizable. An approximate,
parallelizable implementation of mode may be added in the future
(<a class="reference external" href="https://github.com/apache/beam/issues/20946">Issue 20946</a>).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.mode" title="apache_beam.dataframe.frames.DeferredSeries.mode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.mode</span></code></a></dt><dd><p>Return the highest frequency value in a DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.value_counts" title="apache_beam.dataframe.frames.DeferredSeries.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.value_counts</span></code></a></dt><dd><p>Return the counts of values in a DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;arthropod&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">,</span> <span class="s1">&#39;ostrich&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="s1">&#39;wings&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           species  legs  wings</span>
<span class="go">falcon        bird     2    2.0</span>
<span class="go">horse       mammal     4    NaN</span>
<span class="go">spider   arthropod     8    0.0</span>
<span class="go">ostrich       bird     2    NaN</span>

<span class="go">By default, missing values are not considered, and the mode of wings</span>
<span class="go">are both 0 and 2. Because the resulting DataFrame has two rows,</span>
<span class="go">the second row of ``species`` and ``legs`` contains ``NaN``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
<span class="go">  species  legs  wings</span>
<span class="go">0    bird   2.0    0.0</span>
<span class="go">1     NaN   NaN    2.0</span>

<span class="go">Setting ``dropna=False`` ``NaN`` values are considered and they can be</span>
<span class="go">the mode (like for wings).</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">  species  legs  wings</span>
<span class="go">0    bird     2    NaN</span>

<span class="go">Setting ``numeric_only=True``, only the mode of numeric columns is</span>
<span class="go">computed, and columns of other types are ignored.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">   legs  wings</span>
<span class="go">0   2.0    0.0</span>
<span class="go">1   NaN    2.0</span>

<span class="go">To compute the mode over columns and not rows, use the axis parameter:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">           0    1</span>
<span class="go">falcon   2.0  NaN</span>
<span class="go">horse    4.0  NaN</span>
<span class="go">spider   0.0  8.0</span>
<span class="go">ostrich  2.0  NaN</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.dropna">
<span class="sig-name descname"><span class="pre">dropna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.dropna"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="Link to this definition">¶</a></dt>
<dd><p>Remove missing values.</p>
<p>See the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/missing_data.html#missing-data" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">User Guide</span></a> for more on which values are
considered missing, and how to work with missing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – <p>Determine if rows or columns which contain missing values are
removed.</p>
<ul>
<li><p>0, or ‘index’ : Drop rows which contain missing values.</p></li>
<li><p>1, or ‘columns’ : Drop columns which contain missing value.</p></li>
</ul>
<p>Only a single axis is allowed.</p>
</p></li>
<li><p><strong>how</strong> (<em>{'any'</em><em>, </em><em>'all'}</em><em>, </em><em>default 'any'</em>) – <p>Determine if row or column is removed from DeferredDataFrame, when we have
at least one NA or all NA.</p>
<ul>
<li><p>’any’ : If any NA values are present, drop that row or column.</p></li>
<li><p>’all’ : If all values are NA, drop that row or column.</p></li>
</ul>
</p></li>
<li><p><strong>thresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Require that many non-NA values. Cannot be combined with how.</p></li>
<li><p><strong>subset</strong> (<em>column label</em><em> or </em><em>sequence</em><em> of </em><em>labels</em><em>, </em><em>optional</em>) – Labels along other axis to consider, e.g. if you are dropping rows
these would be a list of columns to include.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to modify the DeferredDataFrame rather than creating a new one.</p></li>
<li><p><strong>ignore_index</strong> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the resulting axis will be labeled 0, 1, …, n - 1.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredDataFrame with NA entries dropped from it or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>dropna with axis=”columns” specified cannot be parallelized.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isna</span></code></a></dt><dd><p>Indicate missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="apache_beam.dataframe.frames.DeferredDataFrame.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.notna</span></code></a></dt><dd><p>Indicate existing (non-missing) values.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.fillna</span></code></dt><dd><p>Replace missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.dropna" title="apache_beam.dataframe.frames.DeferredSeries.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.dropna</span></code></a></dt><dd><p>Drop missing values.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.dropna</span></code></dt><dd><p>Drop missing indices.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;Catwoman&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;toy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Bullwhip&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;born&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1940-04-25&quot;</span><span class="p">),</span>
<span class="gp">... </span>                            <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       name        toy       born</span>
<span class="go">0    Alfred        NaN        NaT</span>
<span class="go">1    Batman  Batmobile 1940-04-25</span>
<span class="go">2  Catwoman   Bullwhip        NaT</span>

<span class="go">Drop the rows where at least one element is missing.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="go">     name        toy       born</span>
<span class="go">1  Batman  Batmobile 1940-04-25</span>

<span class="go">Drop the columns where at least one element is missing.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">       name</span>
<span class="go">0    Alfred</span>
<span class="go">1    Batman</span>
<span class="go">2  Catwoman</span>

<span class="go">Drop the rows where all elements are missing.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">       name        toy       born</span>
<span class="go">0    Alfred        NaN        NaT</span>
<span class="go">1    Batman  Batmobile 1940-04-25</span>
<span class="go">2  Catwoman   Bullwhip        NaT</span>

<span class="go">Keep only the rows with at least 2 non-NA values.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">       name        toy       born</span>
<span class="go">1    Batman  Batmobile 1940-04-25</span>
<span class="go">2  Catwoman   Bullwhip        NaT</span>

<span class="go">Define in which columns to look for missing values.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;toy&#39;</span><span class="p">])</span>
<span class="go">       name        toy       born</span>
<span class="go">1    Batman  Batmobile 1940-04-25</span>
<span class="go">2  Catwoman   Bullwhip        NaT</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a string describing operations on DataFrame columns.</p>
<p>Operates on columns only, not specific rows or elements.  This allows
<cite>eval</cite> to run arbitrary code, which can make you vulnerable to code
injection if you pass user input to this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The expression string to evaluate.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If the expression contains an assignment, whether to perform the
operation inplace and mutate the existing DeferredDataFrame. Otherwise,
a new DeferredDataFrame is returned.</p></li>
<li><p><strong>**kwargs</strong> – See the documentation for <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> for complete details
on the keyword arguments accepted by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the evaluation or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, scalar, pandas object, or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Accessing local variables with <code class="docutils literal notranslate"><span class="pre">&#64;&lt;varname&gt;</span></code> is not yet supported
(<a class="reference external" href="https://github.com/apache/beam/issues/20626">Issue 20626</a>).</p>
<p>Arguments <code class="docutils literal notranslate"><span class="pre">local_dict</span></code>, <code class="docutils literal notranslate"><span class="pre">global_dict</span></code>, <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>, and
<code class="docutils literal notranslate"><span class="pre">resolvers</span></code> are not yet supported.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.query" title="apache_beam.dataframe.frames.DeferredDataFrame.query"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.query</span></code></a></dt><dd><p>Evaluates a boolean expression to query the columns of a frame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.assign" title="apache_beam.dataframe.frames.DeferredDataFrame.assign"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.assign</span></code></a></dt><dd><p>Can evaluate an expression or function to create new values for a column.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code></a></dt><dd><p>Evaluate a Python expression as a string using various backends.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For more details see the API documentation for <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a>.
For detailed examples see <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/enhancingperf.html#enhancingperf-eval" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">enhancing performance with eval</span></a>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A   B</span>
<span class="go">0  1  10</span>
<span class="go">1  2   8</span>
<span class="go">2  3   6</span>
<span class="go">3  4   4</span>
<span class="go">4  5   2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;A + B&#39;</span><span class="p">)</span>
<span class="go">0    11</span>
<span class="go">1    10</span>
<span class="go">2     9</span>
<span class="go">3     8</span>
<span class="go">4     7</span>
<span class="go">dtype: int64</span>

<span class="go">Assignment is allowed though by default the original DataFrame is not</span>
<span class="go">modified.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;C = A + B&#39;</span><span class="p">)</span>
<span class="go">   A   B   C</span>
<span class="go">0  1  10  11</span>
<span class="go">1  2   8  10</span>
<span class="go">2  3   6   9</span>
<span class="go">3  4   4   8</span>
<span class="go">4  5   2   7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A   B</span>
<span class="go">0  1  10</span>
<span class="go">1  2   8</span>
<span class="go">2  3   6</span>
<span class="go">3  4   4</span>
<span class="go">4  5   2</span>

<span class="go">Multiple columns can be assigned to using multi-line expressions:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="sd">C = A + B</span>
<span class="gp">... </span><span class="sd">D = A - B</span>
<span class="gp">... </span><span class="sd">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">   A   B   C  D</span>
<span class="go">0  1  10  11 -9</span>
<span class="go">1  2   8  10 -6</span>
<span class="go">2  3   6   9 -3</span>
<span class="go">3  4   4   8  0</span>
<span class="go">4  5   2   7  3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.query" title="Link to this definition">¶</a></dt>
<dd><p>Query the columns of a DataFrame with a boolean expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>The query string to evaluate.</p>
<p>You can refer to variables
in the environment by prefixing them with an ‘&#64;’ character like
<code class="docutils literal notranslate"><span class="pre">&#64;a</span> <span class="pre">+</span> <span class="pre">b</span></code>.</p>
<p>You can refer to column names that are not valid Python variable names
by surrounding them in backticks. Thus, column names containing spaces
or punctuations (besides underscores) or starting with digits must be
surrounded by backticks. (For example, a column named “Area (cm^2)” would
be referenced as <code class="docutils literal notranslate"><span class="pre">`Area</span> <span class="pre">(cm^2)`</span></code>). Column names which are Python keywords
(like “list”, “for”, “import”, etc) cannot be used.</p>
<p>For example, if one of your columns is called <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">a</span></code> and you want
to sum it with <code class="docutils literal notranslate"><span class="pre">b</span></code>, your query should be <code class="docutils literal notranslate"><span class="pre">`a</span> <span class="pre">a`</span> <span class="pre">+</span> <span class="pre">b</span></code>.</p>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to modify the DeferredDataFrame rather than creating a new one.</p></li>
<li><p><strong>**kwargs</strong> – See the documentation for <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> for complete details
on the keyword arguments accepted by <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.query" title="apache_beam.dataframe.frames.DeferredDataFrame.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.query()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredDataFrame resulting from the provided query expression or
None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Accessing local variables with <code class="docutils literal notranslate"><span class="pre">&#64;&lt;varname&gt;</span></code> is not yet supported
(<a class="reference external" href="https://github.com/apache/beam/issues/20626">Issue 20626</a>).</p>
<p>Arguments <code class="docutils literal notranslate"><span class="pre">local_dict</span></code>, <code class="docutils literal notranslate"><span class="pre">global_dict</span></code>, <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>, and
<code class="docutils literal notranslate"><span class="pre">resolvers</span></code> are not yet supported.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code></a></dt><dd><p>Evaluate a string describing operations on DeferredDataFrame columns.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eval</span></code></a></dt><dd><p>Evaluate a string describing operations on DeferredDataFrame columns.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The result of the evaluation of this expression is first passed to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">DeferredDataFrame.loc</span></code> and if that fails because of a
multidimensional key (e.g., a DeferredDataFrame) then the result will be passed
to <code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.__getitem__()</span></code>.</p>
<p>This method uses the top-level <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eval" title="apache_beam.dataframe.frames.DeferredDataFrame.eval"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a> function to
evaluate the passed query.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code> method uses a slightly
modified Python syntax by default. For example, the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">|</span></code>
(bitwise) operators have the precedence of their boolean cousins,
<a class="reference external" href="https://docs.python.org/3/reference/expressions.html#and" title="(in Python v3.13)"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">and</span></code></a> and <a class="reference external" href="https://docs.python.org/3/reference/expressions.html#or" title="(in Python v3.13)"><code class="xref std std-keyword docutils literal notranslate"><span class="pre">or</span></code></a>. This <em>is</em> syntactically valid Python,
however the semantics are different.</p>
<p>You can change the semantics of the expression by passing the keyword
argument <code class="docutils literal notranslate"><span class="pre">parser='python'</span></code>. This enforces the same semantics as
evaluation in Python space. Likewise, you can pass <code class="docutils literal notranslate"><span class="pre">engine='python'</span></code>
to evaluate an expression using Python itself as a backend. This is not
recommended as it is inefficient compared to using <code class="docutils literal notranslate"><span class="pre">numexpr</span></code> as the
engine.</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">DeferredDataFrame.index</span></code> and
<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.columns" title="apache_beam.dataframe.frames.DeferredDataFrame.columns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DeferredDataFrame.columns</span></code></a> attributes of the
<code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code> instance are placed in the query namespace
by default, which allows you to treat both the index and columns of the
frame as a column in the frame.
The identifier <code class="docutils literal notranslate"><span class="pre">index</span></code> is used for the frame index; you can also
use the name of the index to identify it in a query. Please note that
Python keywords may not be used as identifiers.</p>
<p>For further details and examples see the <code class="docutils literal notranslate"><span class="pre">query</span></code> documentation in
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/indexing.html#indexing-query" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">indexing</span></a>.</p>
<p><em>Backtick quoted variables</em></p>
<p>Backtick quoted variables are parsed as literal Python code and
are converted internally to a Python valid identifier.
This can lead to the following problems.</p>
<p>During parsing a number of disallowed characters inside the backtick
quoted string are replaced by strings that are allowed as a Python identifier.
These characters include all operators in Python, the space character, the
question mark, the exclamation mark, the dollar sign, and the euro sign.
For other characters that fall outside the ASCII range (U+0001..U+007F)
and those that are not further specified in PEP 3131,
the query parser will raise an error.
This excludes whitespace different than the space character,
but also the hashtag (as it is used for comments) and the backtick
itself (backtick can also not be escaped).</p>
<p>In a special case, quotes that make a pair around a backtick can
confuse the parser.
For example, <code class="docutils literal notranslate"><span class="pre">`it's`</span> <span class="pre">&gt;</span> <span class="pre">`that's`</span></code> will raise an error,
as it forms a quoted string (<code class="docutils literal notranslate"><span class="pre">'s</span> <span class="pre">&gt;</span> <span class="pre">`that'</span></code>) with a backtick inside.</p>
<p>See also the Python documentation about lexical analysis
(<a class="reference external" href="https://docs.python.org/3/reference/lexical_analysis.html">https://docs.python.org/3/reference/lexical_analysis.html</a>)
in combination with the source code in <code class="xref py py-mod docutils literal notranslate"><span class="pre">pandas.core.computation.parsing</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="s1">&#39;C C&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A   B  C C</span>
<span class="go">0  1  10   10</span>
<span class="go">1  2   8    9</span>
<span class="go">2  3   6    8</span>
<span class="go">3  4   4    7</span>
<span class="go">4  5   2    6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;A &gt; B&#39;</span><span class="p">)</span>
<span class="go">   A  B  C C</span>
<span class="go">4  5  2    6</span>

<span class="go">The previous expression is equivalent to</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">A</span> <span class="o">&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">B</span><span class="p">]</span>
<span class="go">   A  B  C C</span>
<span class="go">4  5  2    6</span>

<span class="go">For columns with spaces in their name, you can use backtick quoting.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;B == `C C`&#39;</span><span class="p">)</span>
<span class="go">   A   B  C C</span>
<span class="go">0  1  10   10</span>

<span class="go">The previous expression is equivalent to</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">B</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;C C&#39;</span><span class="p">]]</span>
<span class="go">   A   B  C C</span>
<span class="go">0  1  10   10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.isnull">
<span class="sig-name descname"><span class="pre">isnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.isnull" title="Link to this definition">¶</a></dt>
<dd><p>Detect missing values.</p>
<p>Return a boolean same-sized object indicating if the values are NA.
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, gets mapped to True
values.
Everything else gets mapped to False values. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredDataFrame that
indicates whether an element is an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isnull" title="apache_beam.dataframe.frames.DeferredDataFrame.isnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isnull</span></code></a></dt><dd><p>Alias of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="apache_beam.dataframe.frames.DeferredDataFrame.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.notna</span></code></a></dt><dd><p>Boolean inverse of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="apache_beam.dataframe.frames.DeferredDataFrame.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isna</span></code></a></dt><dd><p>Top-level isna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">     age   born   name    toy</span>
<span class="go">0  False   True  False   True</span>
<span class="go">1  False  False  False  False</span>
<span class="go">2   True  False  False  False</span>

<span class="go">Show which entries in a Series are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.isna">
<span class="sig-name descname"><span class="pre">isna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="Link to this definition">¶</a></dt>
<dd><p>Detect missing values.</p>
<p>Return a boolean same-sized object indicating if the values are NA.
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, gets mapped to True
values.
Everything else gets mapped to False values. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredDataFrame that
indicates whether an element is an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isnull" title="apache_beam.dataframe.frames.DeferredDataFrame.isnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isnull</span></code></a></dt><dd><p>Alias of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="apache_beam.dataframe.frames.DeferredDataFrame.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.notna</span></code></a></dt><dd><p>Boolean inverse of isna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="apache_beam.dataframe.frames.DeferredDataFrame.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isna</span></code></a></dt><dd><p>Top-level isna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">     age   born   name    toy</span>
<span class="go">0  False   True  False   True</span>
<span class="go">1  False  False  False  False</span>
<span class="go">2   True  False  False  False</span>

<span class="go">Show which entries in a Series are NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.notnull">
<span class="sig-name descname"><span class="pre">notnull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.notnull" title="Link to this definition">¶</a></dt>
<dd><p>Detect existing (non-missing) values.</p>
<p>Return a boolean same-sized object indicating if the values are not NA.
Non-missing values get mapped to True. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, get mapped to False
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredDataFrame that
indicates whether an element is not an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notnull" title="apache_beam.dataframe.frames.DeferredDataFrame.notnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.notnull</span></code></a></dt><dd><p>Alias of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isna</span></code></a></dt><dd><p>Boolean inverse of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="apache_beam.dataframe.frames.DeferredDataFrame.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="apache_beam.dataframe.frames.DeferredDataFrame.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notna</span></code></a></dt><dd><p>Top-level notna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">     age   born  name    toy</span>
<span class="go">0   True  False  True  False</span>
<span class="go">1   True   True  True   True</span>
<span class="go">2  False   True  True   True</span>

<span class="go">Show which entries in a Series are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.notna">
<span class="sig-name descname"><span class="pre">notna</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="Link to this definition">¶</a></dt>
<dd><p>Detect existing (non-missing) values.</p>
<p>Return a boolean same-sized object indicating if the values are not NA.
Non-missing values get mapped to True. Characters such as empty
strings <code class="docutils literal notranslate"><span class="pre">''</span></code> or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.inf</span></code> are not considered NA values
(unless you set <code class="docutils literal notranslate"><span class="pre">pandas.options.mode.use_inf_as_na</span> <span class="pre">=</span> <span class="pre">True</span></code>).
NA values, such as None or <code class="xref py py-attr docutils literal notranslate"><span class="pre">numpy.NaN</span></code>, get mapped to False
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mask of bool values for each element in DeferredDataFrame that
indicates whether an element is not an NA value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notnull" title="apache_beam.dataframe.frames.DeferredDataFrame.notnull"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.notnull</span></code></a></dt><dd><p>Alias of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isna</span></code></a></dt><dd><p>Boolean inverse of notna.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dropna" title="apache_beam.dataframe.frames.DeferredDataFrame.dropna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dropna</span></code></a></dt><dd><p>Omit axes labels with missing values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.notna" title="apache_beam.dataframe.frames.DeferredDataFrame.notna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">notna</span></code></a></dt><dd><p>Top-level notna.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Show which entries in a DataFrame are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">born</span><span class="o">=</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">NaT</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1939-05-27&#39;</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;1940-04-25&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                       <span class="n">name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Alfred&#39;</span><span class="p">,</span> <span class="s1">&#39;Batman&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">toy</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Batmobile&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   age       born    name        toy</span>
<span class="go">0  5.0        NaT  Alfred       None</span>
<span class="go">1  6.0 1939-05-27  Batman  Batmobile</span>
<span class="go">2  NaN 1940-04-25              Joker</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">     age   born  name    toy</span>
<span class="go">0   True  False  True  False</span>
<span class="go">1   True   True  True   True</span>
<span class="go">2  False   True  True   True</span>

<span class="go">Show which entries in a Series are not NA.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span>
<span class="go">0    5.0</span>
<span class="go">1    6.0</span>
<span class="go">2    NaN</span>
<span class="go">dtype: float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ser</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="go">0     True</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.items" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.items.html#pandas.DataFrame.items" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.items()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.itertuples">
<span class="sig-name descname"><span class="pre">itertuples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.itertuples" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.itertuples.html#pandas.DataFrame.itertuples" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.itertuples()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.iterrows">
<span class="sig-name descname"><span class="pre">iterrows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.iterrows" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.iterrows.html#pandas.DataFrame.iterrows" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.iterrows()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.iteritems">
<span class="sig-name descname"><span class="pre">iteritems</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.iteritems" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.iteritems()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.join" title="Link to this definition">¶</a></dt>
<dd><p>Join columns of another DataFrame.</p>
<p>Join columns with <cite>other</cite> DataFrame either on index or on a key
column. Efficiently join multiple DataFrame objects by index at once by
passing a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><em>a list containing any combination</em><em> of </em><em>them</em>) – Index should be similar to one of the columns in this one. If a
DeferredSeries is passed, its name attribute must be set, and that will be
used as the column name in the resulting joined DeferredDataFrame.</p></li>
<li><p><strong>on</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, or </em><em>array-like</em><em>, </em><em>optional</em>) – Column or index level name(s) in the caller to join on the index
in <cite>other</cite>, otherwise joins index-on-index. If multiple
values given, the <cite>other</cite> DeferredDataFrame must have a MultiIndex. Can
pass an array as the join key if it is not already contained in
the calling DeferredDataFrame. Like an Excel VLOOKUP operation.</p></li>
<li><p><strong>how</strong> (<em>{'left'</em><em>, </em><em>'right'</em><em>, </em><em>'outer'</em><em>, </em><em>'inner'</em><em>, </em><em>'cross'}</em><em>, </em><em>default 'left'</em>) – <p>How to handle the operation of the two objects.</p>
<ul>
<li><p>left: use calling frame’s index (or column if on is specified)</p></li>
<li><p>right: use <cite>other</cite>’s index.</p></li>
<li><p>outer: form union of calling frame’s index (or column if on is
specified) with <cite>other</cite>’s index, and sort it lexicographically.</p></li>
<li><p>inner: form intersection of calling frame’s index (or column if
on is specified) with <cite>other</cite>’s index, preserving the order
of the calling’s one.</p></li>
<li><p>cross: creates the cartesian product from both frames, preserves the order
of the left keys.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</li>
</ul>
</p></li>
<li><p><strong>lsuffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Suffix to use from left frame’s overlapping columns.</p></li>
<li><p><strong>rsuffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Suffix to use from right frame’s overlapping columns.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Order result DeferredDataFrame lexicographically by the join key. If False,
the order of the join key depends on the join type (how keyword).</p></li>
<li><p><strong>validate</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – <p>If specified, checks if join is of specified type.</p>
<ul>
<li><p>”one_to_one” or “1:1”: check if join keys are unique in both left
and right datasets.</p></li>
<li><p>”one_to_many” or “1:m”: check if join keys are unique in left dataset.</p></li>
<li><p>”many_to_one” or “m:1”: check if join keys are unique in right dataset.</p></li>
<li><p>”many_to_many” or “m:m”: allowed, but does not result in checks.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe containing columns from both the caller and <cite>other</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.merge" title="apache_beam.dataframe.frames.DeferredDataFrame.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.merge</span></code></a></dt><dd><p>For column(s)-on-column(s) operations.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Parameters <cite>on</cite>, <cite>lsuffix</cite>, and <cite>rsuffix</cite> are not supported when
passing a list of <cite>DeferredDataFrame</cite> objects.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">]})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  key   A</span>
<span class="go">0  K0  A0</span>
<span class="go">1  K1  A1</span>
<span class="go">2  K2  A2</span>
<span class="go">3  K3  A3</span>
<span class="go">4  K4  A4</span>
<span class="go">5  K5  A5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">  key   B</span>
<span class="go">0  K0  B0</span>
<span class="go">1  K1  B1</span>
<span class="go">2  K2  B2</span>

<span class="go">Join DataFrames using their indexes.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_caller&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_other&#39;</span><span class="p">)</span>
<span class="go">  key_caller   A key_other    B</span>
<span class="go">0         K0  A0        K0   B0</span>
<span class="go">1         K1  A1        K1   B1</span>
<span class="go">2         K2  A2        K2   B2</span>
<span class="go">3         K3  A3       NaN  NaN</span>
<span class="go">4         K4  A4       NaN  NaN</span>
<span class="go">5         K5  A5       NaN  NaN</span>

<span class="go">If we want to join using the key columns, we need to set key to be</span>
<span class="go">the index in both `df` and `other`. The joined DataFrame will have</span>
<span class="go">key as its index.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">))</span>
<span class="go">      A    B</span>
<span class="go">key</span>
<span class="go">K0   A0   B0</span>
<span class="go">K1   A1   B1</span>
<span class="go">K2   A2   B2</span>
<span class="go">K3   A3  NaN</span>
<span class="go">K4   A4  NaN</span>
<span class="go">K5   A5  NaN</span>

<span class="go">Another option to join using the key columns is to use the `on`</span>
<span class="go">parameter. DataFrame.join always uses `other`&#39;s index but we can use</span>
<span class="go">any column in `df`. This method preserves the original DataFrame&#39;s</span>
<span class="go">index in the result.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="go">  key   A    B</span>
<span class="go">0  K0  A0   B0</span>
<span class="go">1  K1  A1   B1</span>
<span class="go">2  K2  A2   B2</span>
<span class="go">3  K3  A3  NaN</span>
<span class="go">4  K4  A4  NaN</span>
<span class="go">5  K5  A5  NaN</span>

<span class="go">Using non-unique key values shows how they are matched.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K0&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;A5&#39;</span><span class="p">]})</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  key   A</span>
<span class="go">0  K0  A0</span>
<span class="go">1  K1  A1</span>
<span class="go">2  K1  A2</span>
<span class="go">3  K3  A3</span>
<span class="go">4  K0  A4</span>
<span class="go">5  K1  A5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;m:1&#39;</span><span class="p">)</span>
<span class="go">  key   A    B</span>
<span class="go">0  K0  A0   B0</span>
<span class="go">1  K1  A1   B1</span>
<span class="go">2  K1  A2   B1</span>
<span class="go">3  K3  A3  NaN</span>
<span class="go">4  K0  A4   B0</span>
<span class="go">5  K1  A5   B1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge DataFrame or named Series objects with a database-style join.</p>
<p>A named Series object is treated as a DataFrame with a single named column.</p>
<p>The join is done on columns or indexes. If joining columns on
columns, the DataFrame indexes <em>will be ignored</em>. Otherwise if joining indexes
on indexes or indexes on a column or columns, the index will be passed on.
When performing a cross merge, no column specifications to merge on are
allowed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If both key columns contain rows where the key is a null value, those
rows will be matched against each other. This is different from usual SQL
join behaviour and can lead to unexpected results.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em> or </em><em>named DeferredSeries</em>) – Object to merge with.</p></li>
<li><p><strong>how</strong> (<em>{'left'</em><em>, </em><em>'right'</em><em>, </em><em>'outer'</em><em>, </em><em>'inner'</em><em>, </em><em>'cross'}</em><em>, </em><em>default 'inner'</em>) – <p>Type of merge to be performed.</p>
<ul>
<li><p>left: use only keys from left frame, similar to a SQL left outer join;
preserve key order.</p></li>
<li><p>right: use only keys from right frame, similar to a SQL right outer join;
preserve key order.</p></li>
<li><p>outer: use union of keys from both frames, similar to a SQL full outer
join; sort keys lexicographically.</p></li>
<li><p>inner: use intersection of keys from both frames, similar to a SQL inner
join; preserve the order of the left keys.</p></li>
<li><p>cross: creates the cartesian product from both frames, preserves the order
of the left keys.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</li>
</ul>
</p></li>
<li><p><strong>on</strong> (<em>label</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – Column or index level names to join on. These must be found in both
DeferredDataFrames. If <cite>on</cite> is None and not merging on indexes then this defaults
to the intersection of the columns in both DeferredDataFrames.</p></li>
<li><p><strong>left_on</strong> (<em>label</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, or </em><em>array-like</em>) – Column or index level names to join on in the left DeferredDataFrame. Can also
be an array or list of arrays of the length of the left DeferredDataFrame.
These arrays are treated as if they are columns.</p></li>
<li><p><strong>right_on</strong> (<em>label</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, or </em><em>array-like</em>) – Column or index level names to join on in the right DeferredDataFrame. Can also
be an array or list of arrays of the length of the right DeferredDataFrame.
These arrays are treated as if they are columns.</p></li>
<li><p><strong>left_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Use the index from the left DeferredDataFrame as the join key(s). If it is a
MultiIndex, the number of keys in the other DeferredDataFrame (either the index
or a number of columns) must match the number of levels.</p></li>
<li><p><strong>right_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Use the index from the right DeferredDataFrame as the join key. Same caveats as
left_index.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Sort the join keys lexicographically in the result DeferredDataFrame. If False,
the order of the join keys depends on the join type (how keyword).</p></li>
<li><p><strong>suffixes</strong> (<em>list-like</em><em>, </em><em>default is</em><em> (</em><em>&quot;_x&quot;</em><em>, </em><em>&quot;_y&quot;</em><em>)</em>) – A length-2 sequence where each element is optionally a string
indicating the suffix to add to overlapping column names in
<cite>left</cite> and <cite>right</cite> respectively. Pass a value of <cite>None</cite> instead
of a string to indicate that the column name from <cite>left</cite> or
<cite>right</cite> should be left as-is, with no suffix. At least one of the
values must not be None.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – If False, avoid copy if possible.</p></li>
<li><p><strong>indicator</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default False</em>) – If True, adds a column to the output DeferredDataFrame called “_merge” with
information on the source of each row. The column can be given a different
name by providing a string argument. The column will have a Categorical
type with the value of “left_only” for observations whose merge key only
appears in the left DeferredDataFrame, “right_only” for observations
whose merge key only appears in the right DeferredDataFrame, and “both”
if the observation’s merge key is found in both DeferredDataFrames.</p></li>
<li><p><strong>validate</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – <p>If specified, checks if merge is of specified type.</p>
<ul>
<li><p>”one_to_one” or “1:1”: check if merge keys are unique in both
left and right datasets.</p></li>
<li><p>”one_to_many” or “1:m”: check if merge keys are unique in left
dataset.</p></li>
<li><p>”many_to_one” or “m:1”: check if merge keys are unique in right
dataset.</p></li>
<li><p>”many_to_many” or “m:m”: allowed, but does not result in checks.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DeferredDataFrame of the two merged objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>merge is not parallelizable unless <code class="docutils literal notranslate"><span class="pre">left_index</span></code> or <code class="docutils literal notranslate"><span class="pre">right_index</span></code> is
<a href="#id69"><span class="problematic" id="id70">``</span></a>True`, because it requires generating an entirely new unique index.
See notes on <code class="xref py py-meth docutils literal notranslate"><span class="pre">DeferredDataFrame.reset_index()</span></code>. It is recommended to
move the join key for one of your columns to the index to avoid this issue.
For an example see the enrich pipeline in
<code class="xref py py-mod docutils literal notranslate"><span class="pre">apache_beam.examples.dataframe.taxiride</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">how=&quot;cross&quot;</span></code> is not yet supported.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_ordered</span></code></dt><dd><p>Merge with optional filling/interpolation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_asof</span></code></dt><dd><p>Merge on nearest keys.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.join" title="apache_beam.dataframe.frames.DeferredDataFrame.join"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.join</span></code></a></dt><dd><p>Similar method using indices.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;lkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;rkey&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span>
<span class="go">    lkey value</span>
<span class="go">0   foo      1</span>
<span class="go">1   bar      2</span>
<span class="go">2   baz      3</span>
<span class="go">3   foo      5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span>
<span class="go">    rkey value</span>
<span class="go">0   foo      5</span>
<span class="go">1   bar      6</span>
<span class="go">2   baz      7</span>
<span class="go">3   foo      8</span>

<span class="go">Merge df1 and df2 on the lkey and rkey columns. The value columns have</span>
<span class="go">the default suffixes, _x and _y, appended.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lkey&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;rkey&#39;</span><span class="p">)</span>
<span class="go">  lkey  value_x rkey  value_y</span>
<span class="go">0  foo        1  foo        5</span>
<span class="go">1  foo        1  foo        8</span>
<span class="go">2  foo        5  foo        5</span>
<span class="go">3  foo        5  foo        8</span>
<span class="go">4  bar        2  bar        6</span>
<span class="go">5  baz        3  baz        7</span>

<span class="go">Merge DataFrames df1 and df2 with specified left and right suffixes</span>
<span class="go">appended to any overlapping columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lkey&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;rkey&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="s1">&#39;_right&#39;</span><span class="p">))</span>
<span class="go">  lkey  value_left rkey  value_right</span>
<span class="go">0  foo           1  foo            5</span>
<span class="go">1  foo           1  foo            8</span>
<span class="go">2  foo           5  foo            5</span>
<span class="go">3  foo           5  foo            8</span>
<span class="go">4  bar           2  bar            6</span>
<span class="go">5  baz           3  baz            7</span>

<span class="go">Merge DataFrames df1 and df2, but raise an exception if the DataFrames have</span>
<span class="go">any overlapping columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;lkey&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;rkey&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">columns overlap but no suffix specified:</span>
<span class="x">    Index([&#39;value&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span>
<span class="go">      a  b</span>
<span class="go">0   foo  1</span>
<span class="go">1   bar  2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span>
<span class="go">      a  c</span>
<span class="go">0   foo  3</span>
<span class="go">1   baz  4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">      a  b  c</span>
<span class="go">0   foo  1  3</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">      a  b  c</span>
<span class="go">0   foo  1  3.0</span>
<span class="go">1   bar  2  NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span>
<span class="go">    left</span>
<span class="go">0   foo</span>
<span class="go">1   bar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span>
<span class="go">    right</span>
<span class="go">0   7</span>
<span class="go">1   8</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;cross&#39;</span><span class="p">)</span>
<span class="go">   left  right</span>
<span class="go">0   foo      7</span>
<span class="go">1   foo      8</span>
<span class="go">2   bar      7</span>
<span class="go">3   bar      8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.nlargest">
<span class="sig-name descname"><span class="pre">nlargest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.nlargest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="Link to this definition">¶</a></dt>
<dd><p>Return the first <cite>n</cite> rows ordered by <cite>columns</cite> in descending order.</p>
<p>Return the first <cite>n</cite> rows with the largest values in <cite>columns</cite>, in
descending order. The columns that are not specified are returned as
well, but not used for ordering.</p>
<p>This method is equivalent to
<code class="docutils literal notranslate"><span class="pre">df.sort_values(columns,</span> <span class="pre">ascending=False).head(n)</span></code>, but more
performant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of rows to return.</p></li>
<li><p><strong>columns</strong> (<em>label</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>labels</em>) – Column label(s) to order by.</p></li>
<li><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>'all'}</em><em>, </em><em>default 'first'</em>) – <p>Where there are duplicate values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first</span></code> : prioritize the first occurrence(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last</span></code> : prioritize the last occurrence(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> : do not drop any duplicates, even it means
selecting more than <cite>n</cite> items.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The first <cite>n</cite> rows ordered by the given columns in descending
order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nsmallest" title="apache_beam.dataframe.frames.DeferredDataFrame.nsmallest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.nsmallest</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows ordered by <cite>columns</cite> in ascending order.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sort_values</span></code></dt><dd><p>Sort DeferredDataFrame by the values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.head" title="apache_beam.dataframe.frames.DeferredDataFrame.head"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.head</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows without re-ordering.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function cannot be used with all column types. For example, when
specifying columns with <cite>object</cite> or <cite>category</cite> dtypes, <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is
raised.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">59000000</span><span class="p">,</span> <span class="mi">65000000</span><span class="p">,</span> <span class="mi">434000</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="mi">434000</span><span class="p">,</span> <span class="mi">434000</span><span class="p">,</span> <span class="mi">337000</span><span class="p">,</span> <span class="mi">11300</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="mi">11300</span><span class="p">,</span> <span class="mi">11300</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;GDP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1937894</span><span class="p">,</span> <span class="mi">2583560</span> <span class="p">,</span> <span class="mi">12011</span><span class="p">,</span> <span class="mi">4520</span><span class="p">,</span> <span class="mi">12128</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="mi">17036</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">311</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;alpha-2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;IT&quot;</span><span class="p">,</span> <span class="s2">&quot;FR&quot;</span><span class="p">,</span> <span class="s2">&quot;MT&quot;</span><span class="p">,</span> <span class="s2">&quot;MV&quot;</span><span class="p">,</span> <span class="s2">&quot;BN&quot;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="s2">&quot;IS&quot;</span><span class="p">,</span> <span class="s2">&quot;NR&quot;</span><span class="p">,</span> <span class="s2">&quot;TV&quot;</span><span class="p">,</span> <span class="s2">&quot;AI&quot;</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Italy&quot;</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> <span class="s2">&quot;Malta&quot;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="s2">&quot;Maldives&quot;</span><span class="p">,</span> <span class="s2">&quot;Brunei&quot;</span><span class="p">,</span> <span class="s2">&quot;Iceland&quot;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="s2">&quot;Nauru&quot;</span><span class="p">,</span> <span class="s2">&quot;Tuvalu&quot;</span><span class="p">,</span> <span class="s2">&quot;Anguilla&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">          population      GDP alpha-2</span>
<span class="go">Italy       59000000  1937894      IT</span>
<span class="go">France      65000000  2583560      FR</span>
<span class="go">Malta         434000    12011      MT</span>
<span class="go">Maldives      434000     4520      MV</span>
<span class="go">Brunei        434000    12128      BN</span>
<span class="go">Iceland       337000    17036      IS</span>
<span class="go">Nauru          11300      182      NR</span>
<span class="go">Tuvalu         11300       38      TV</span>
<span class="go">Anguilla       11300      311      AI</span>

<span class="go">In the following example, we will use ``nlargest`` to select the three</span>
<span class="go">rows having the largest values in column &quot;population&quot;.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">)</span>
<span class="go">        population      GDP alpha-2</span>
<span class="go">France    65000000  2583560      FR</span>
<span class="go">Italy     59000000  1937894      IT</span>
<span class="go">Malta       434000    12011      MT</span>

<span class="go">When using ``keep=&#39;last&#39;``, ties are resolved in reverse order:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">        population      GDP alpha-2</span>
<span class="go">France    65000000  2583560      FR</span>
<span class="go">Italy     59000000  1937894      IT</span>
<span class="go">Brunei      434000    12128      BN</span>

<span class="go">When using ``keep=&#39;all&#39;``, all duplicate items are maintained:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">          population      GDP alpha-2</span>
<span class="go">France      65000000  2583560      FR</span>
<span class="go">Italy       59000000  1937894      IT</span>
<span class="go">Malta         434000    12011      MT</span>
<span class="go">Maldives      434000     4520      MV</span>
<span class="go">Brunei        434000    12128      BN</span>

<span class="go">To order by the largest values in column &quot;population&quot; and then &quot;GDP&quot;,</span>
<span class="go">we can specify multiple columns like in the next example.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">])</span>
<span class="go">        population      GDP alpha-2</span>
<span class="go">France    65000000  2583560      FR</span>
<span class="go">Italy     59000000  1937894      IT</span>
<span class="go">Brunei      434000    12128      BN</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.nsmallest">
<span class="sig-name descname"><span class="pre">nsmallest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.nsmallest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.nsmallest" title="Link to this definition">¶</a></dt>
<dd><p>Return the first <cite>n</cite> rows ordered by <cite>columns</cite> in ascending order.</p>
<p>Return the first <cite>n</cite> rows with the smallest values in <cite>columns</cite>, in
ascending order. The columns that are not specified are returned as
well, but not used for ordering.</p>
<p>This method is equivalent to
<code class="docutils literal notranslate"><span class="pre">df.sort_values(columns,</span> <span class="pre">ascending=True).head(n)</span></code>, but more
performant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of items to retrieve.</p></li>
<li><p><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Column name or names to order by.</p></li>
<li><p><strong>keep</strong> (<em>{'first'</em><em>, </em><em>'last'</em><em>, </em><em>'all'}</em><em>, </em><em>default 'first'</em>) – <p>Where there are duplicate values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">first</span></code> : take the first occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last</span></code> : take the last occurrence.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> : do not drop any duplicates, even it means
selecting more than <cite>n</cite> items.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">keep=False</span></code> and <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> are supported. Other values of
<code class="docutils literal notranslate"><span class="pre">keep</span></code> make this an order-sensitive operation. Note <code class="docutils literal notranslate"><span class="pre">keep=&quot;any&quot;</span></code> is
a Beam-specific option that guarantees only one duplicate will be kept, but
unlike <code class="docutils literal notranslate"><span class="pre">&quot;first&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;last&quot;</span></code> it makes no guarantees about _which_
duplicate element is kept.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.nlargest" title="apache_beam.dataframe.frames.DeferredDataFrame.nlargest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.nlargest</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows ordered by <cite>columns</cite> in descending order.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sort_values</span></code></dt><dd><p>Sort DeferredDataFrame by the values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.head" title="apache_beam.dataframe.frames.DeferredDataFrame.head"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.head</span></code></a></dt><dd><p>Return the first <cite>n</cite> rows without re-ordering.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">59000000</span><span class="p">,</span> <span class="mi">65000000</span><span class="p">,</span> <span class="mi">434000</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="mi">434000</span><span class="p">,</span> <span class="mi">434000</span><span class="p">,</span> <span class="mi">337000</span><span class="p">,</span> <span class="mi">337000</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="mi">11300</span><span class="p">,</span> <span class="mi">11300</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;GDP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1937894</span><span class="p">,</span> <span class="mi">2583560</span> <span class="p">,</span> <span class="mi">12011</span><span class="p">,</span> <span class="mi">4520</span><span class="p">,</span> <span class="mi">12128</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="mi">17036</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">311</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;alpha-2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;IT&quot;</span><span class="p">,</span> <span class="s2">&quot;FR&quot;</span><span class="p">,</span> <span class="s2">&quot;MT&quot;</span><span class="p">,</span> <span class="s2">&quot;MV&quot;</span><span class="p">,</span> <span class="s2">&quot;BN&quot;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="s2">&quot;IS&quot;</span><span class="p">,</span> <span class="s2">&quot;NR&quot;</span><span class="p">,</span> <span class="s2">&quot;TV&quot;</span><span class="p">,</span> <span class="s2">&quot;AI&quot;</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Italy&quot;</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">,</span> <span class="s2">&quot;Malta&quot;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="s2">&quot;Maldives&quot;</span><span class="p">,</span> <span class="s2">&quot;Brunei&quot;</span><span class="p">,</span> <span class="s2">&quot;Iceland&quot;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="s2">&quot;Nauru&quot;</span><span class="p">,</span> <span class="s2">&quot;Tuvalu&quot;</span><span class="p">,</span> <span class="s2">&quot;Anguilla&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">          population      GDP alpha-2</span>
<span class="go">Italy       59000000  1937894      IT</span>
<span class="go">France      65000000  2583560      FR</span>
<span class="go">Malta         434000    12011      MT</span>
<span class="go">Maldives      434000     4520      MV</span>
<span class="go">Brunei        434000    12128      BN</span>
<span class="go">Iceland       337000    17036      IS</span>
<span class="go">Nauru         337000      182      NR</span>
<span class="go">Tuvalu         11300       38      TV</span>
<span class="go">Anguilla       11300      311      AI</span>

<span class="go">In the following example, we will use ``nsmallest`` to select the</span>
<span class="go">three rows having the smallest values in column &quot;population&quot;.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">)</span>
<span class="go">          population    GDP alpha-2</span>
<span class="go">Tuvalu         11300     38      TV</span>
<span class="go">Anguilla       11300    311      AI</span>
<span class="go">Iceland       337000  17036      IS</span>

<span class="go">When using ``keep=&#39;last&#39;``, ties are resolved in reverse order:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span>
<span class="go">          population  GDP alpha-2</span>
<span class="go">Anguilla       11300  311      AI</span>
<span class="go">Tuvalu         11300   38      TV</span>
<span class="go">Nauru         337000  182      NR</span>

<span class="go">When using ``keep=&#39;all&#39;``, all duplicate items are maintained:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">          population    GDP alpha-2</span>
<span class="go">Tuvalu         11300     38      TV</span>
<span class="go">Anguilla       11300    311      AI</span>
<span class="go">Iceland       337000  17036      IS</span>
<span class="go">Nauru         337000    182      NR</span>

<span class="go">To order by the smallest values in column &quot;population&quot; and then &quot;GDP&quot;, we can</span>
<span class="go">specify multiple columns like in the next example.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;GDP&#39;</span><span class="p">])</span>
<span class="go">          population  GDP alpha-2</span>
<span class="go">Tuvalu         11300   38      TV</span>
<span class="go">Anguilla       11300  311      AI</span>
<span class="go">Nauru         337000  182      NR</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.plot" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.plot.html#pandas.DataFrame.plot" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.plot()</span></code></a> is not yet supported in the Beam DataFrame API because it is a plotting tool.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-plotting-tools">https://s.apache.org/dataframe-plotting-tools</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.pop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.pop" title="Link to this definition">¶</a></dt>
<dd><p>Return item and drop from frame. Raise KeyError if not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>label</em>) – Label of column to be popped.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mf">389.0</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;parrot&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="mf">24.0</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;lion&#39;</span><span class="p">,</span> <span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="mf">80.5</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;monkey&#39;</span><span class="p">,</span> <span class="s1">&#39;mammal&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;max_speed&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">     name   class  max_speed</span>
<span class="go">0  falcon    bird      389.0</span>
<span class="go">1  parrot    bird       24.0</span>
<span class="go">2    lion  mammal       80.5</span>
<span class="go">3  monkey  mammal        NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
<span class="go">0      bird</span>
<span class="go">1      bird</span>
<span class="go">2    mammal</span>
<span class="go">3    mammal</span>
<span class="go">Name: class, dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">     name  max_speed</span>
<span class="go">0  falcon      389.0</span>
<span class="go">1  parrot       24.0</span>
<span class="go">2    lion       80.5</span>
<span class="go">3  monkey        NaN</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.quantile">
<span class="sig-name descname"><span class="pre">quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.quantile" title="Link to this definition">¶</a></dt>
<dd><p>Return values at the given quantile over requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>array-like</em><em>, </em><em>default 0.5</em><em> (</em><em>50% quantile</em><em>)</em>) – Value between 0 &lt;= q &lt;= 1, the quantile(s) to compute.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – Equals 0 or ‘index’ for row-wise, 1 or ‘columns’ for column-wise.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>The default value of <code class="docutils literal notranslate"><span class="pre">numeric_only</span></code> is now <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
</p></li>
<li><p><strong>interpolation</strong> (<em>{'linear'</em><em>, </em><em>'lower'</em><em>, </em><em>'higher'</em><em>, </em><em>'midpoint'</em><em>, </em><em>'nearest'}</em>) – <p>This optional parameter specifies the interpolation method to use,
when the desired quantile lies between two data points <cite>i</cite> and <cite>j</cite>:</p>
<ul>
<li><p>linear: <cite>i + (j - i) * fraction</cite>, where <cite>fraction</cite> is the
fractional part of the index surrounded by <cite>i</cite> and <cite>j</cite>.</p></li>
<li><p>lower: <cite>i</cite>.</p></li>
<li><p>higher: <cite>j</cite>.</p></li>
<li><p>nearest: <cite>i</cite> or <cite>j</cite> whichever is nearest.</p></li>
<li><p>midpoint: (<cite>i</cite> + <cite>j</cite>) / 2.</p></li>
</ul>
</p></li>
<li><p><strong>method</strong> (<em>{'single'</em><em>, </em><em>'table'}</em><em>, </em><em>default 'single'</em>) – Whether to compute quantiles per-column (‘single’) or over all columns
(‘table’). When ‘table’, the only allowed interpolation methods are
‘nearest’, ‘lower’, and ‘higher’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If <code class="docutils literal notranslate"><span class="pre">q</span></code> is an array, a DeferredDataFrame will be returned where the</dt><dd><p>index is <code class="docutils literal notranslate"><span class="pre">q</span></code>, the columns are the columns of self, and the
values are the quantiles.</p>
</dd>
<dt>If <code class="docutils literal notranslate"><span class="pre">q</span></code> is a float, a DeferredSeries will be returned where the</dt><dd><p>index is the columns of self and the values are the quantiles.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">quantile(axis=&quot;index&quot;)</span></code> is not parallelizable. See
<a class="reference external" href="https://github.com/apache/beam/issues/20933">Issue 20933</a> tracking
the possible addition of an approximate, parallelizable implementation of
quantile.</p>
<p>When using quantile with <code class="docutils literal notranslate"><span class="pre">axis=&quot;columns&quot;</span></code> only a single <code class="docutils literal notranslate"><span class="pre">q</span></code> value can be
specified.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">core.window.rolling.Rolling.quantile</span></code></dt><dd><p>Rolling quantile.</p>
</dd>
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.percentile.html#numpy.percentile" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.percentile</span></code></a></dt><dd><p>Numpy function to compute the percentile.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">]]),</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.1</span><span class="p">)</span>
<span class="go">a    1.3</span>
<span class="go">b    3.7</span>
<span class="go">Name: 0.1, dtype: float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.5</span><span class="p">])</span>
<span class="go">       a     b</span>
<span class="go">0.1  1.3   3.7</span>
<span class="go">0.5  2.5  55.0</span>

<span class="go">Specifying `method=&#39;table&#39;` will compute the quantile over all columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="go">a    1</span>
<span class="go">b    1</span>
<span class="go">Name: 0.1, dtype: int64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.5</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="go">     a    b</span>
<span class="go">0.1  1    1</span>
<span class="go">0.5  3  100</span>

<span class="go">Specifying `numeric_only=False` will also compute the quantile of</span>
<span class="go">datetime and timedelta data.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2010&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2011&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1 days&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;2 days&#39;</span><span class="p">)]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">numeric_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">A                    1.5</span>
<span class="go">B    2010-07-02 12:00:00</span>
<span class="go">C        1 days 12:00:00</span>
<span class="go">Name: 0.5, dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rename">
<span class="sig-name descname"><span class="pre">rename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.rename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename" title="Link to this definition">¶</a></dt>
<dd><p>Rename columns or index labels.</p>
<p>Function / dict values must be unique (1-to-1). Labels not contained in
a dict / Series will be left as-is. Extra labels listed don’t throw an
error.</p>
<p>See the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/basics.html#basics-rename" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">user guide</span></a> for more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapper</strong> (<em>dict-like</em><em> or </em><em>function</em>) – Dict-like or function transformations to apply to
that axis’ values. Use either <code class="docutils literal notranslate"><span class="pre">mapper</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> to
specify the axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, or <code class="docutils literal notranslate"><span class="pre">index</span></code> and
<code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p></li>
<li><p><strong>index</strong> (<em>dict-like</em><em> or </em><em>function</em>) – Alternative to specifying axis (<code class="docutils literal notranslate"><span class="pre">mapper,</span> <span class="pre">axis=0</span></code>
is equivalent to <code class="docutils literal notranslate"><span class="pre">index=mapper</span></code>).</p></li>
<li><p><strong>columns</strong> (<em>dict-like</em><em> or </em><em>function</em>) – Alternative to specifying axis (<code class="docutils literal notranslate"><span class="pre">mapper,</span> <span class="pre">axis=1</span></code>
is equivalent to <code class="docutils literal notranslate"><span class="pre">columns=mapper</span></code>).</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – Axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>. Can be either the axis name
(‘index’, ‘columns’) or number (0, 1). The default is ‘index’.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Also copy underlying data.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to modify the DeferredDataFrame rather than creating a new one.
If True then value of copy is ignored.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>level name</em><em>, </em><em>default None</em>) – In case of a MultiIndex, only rename labels in the specified
level.</p></li>
<li><p><strong>errors</strong> (<em>{'ignore'</em><em>, </em><em>'raise'}</em><em>, </em><em>default 'ignore'</em>) – If ‘raise’, raise a <cite>KeyError</cite> when a dict-like <cite>mapper</cite>, <cite>index</cite>,
or <cite>columns</cite> contains labels that are not present in the Index
being transformed.
If ‘ignore’, existing keys will be renamed and extra keys will be
ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DeferredDataFrame with the renamed axis labels or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If any of the labels is not found in the selected axis and
    “errors=’raise’”.</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>rename is not parallelizable when <code class="docutils literal notranslate"><span class="pre">axis=&quot;index&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">errors=&quot;raise&quot;</span></code>. It requires collecting all data on a single
node in order to detect if one of the index values is missing.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename_axis" title="apache_beam.dataframe.frames.DeferredDataFrame.rename_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.rename_axis</span></code></a></dt><dd><p>Set the name of the axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">``DataFrame.rename`` supports two calling conventions</span>

<span class="go">* ``(index=index_mapper, columns=columns_mapper, ...)``</span>
<span class="go">* ``(mapper, axis={&#39;index&#39;, &#39;columns&#39;}, ...)``</span>

<span class="go">We *highly* recommend using keyword arguments to clarify your</span>
<span class="go">intent.</span>

<span class="go">Rename columns using a mapping:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">})</span>
<span class="go">   a  c</span>
<span class="go">0  1  4</span>
<span class="go">1  2  5</span>
<span class="go">2  3  6</span>

<span class="go">Rename index using a mapping:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span>
<span class="go">   A  B</span>
<span class="go">x  1  4</span>
<span class="go">y  2  5</span>
<span class="go">z  3  6</span>

<span class="go">Cast index labels to a different type:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
<span class="go">RangeIndex(start=0, stop=3, step=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="go">Index([&#39;0&#39;, &#39;1&#39;, &#39;2&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">},</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">KeyError</span>: <span class="n">[&#39;C&#39;] not found in axis</span>

<span class="x">Using axis-style parameters:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">   a  b</span>
<span class="go">0  1  4</span>
<span class="go">1  2  5</span>
<span class="go">2  3  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   A  B</span>
<span class="go">0  1  4</span>
<span class="go">2  2  5</span>
<span class="go">4  3  6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rename_axis">
<span class="sig-name descname"><span class="pre">rename_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename_axis" title="Link to this definition">¶</a></dt>
<dd><p>Set the name of the axis for the index or columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mapper</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>optional</em>) – Value to set the axis name attribute.</p></li>
<li><p><strong>index</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>dict-like</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>A scalar, list-like, dict-like or functions transformations to
apply to that axis’ values.
Note that the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter is not allowed if the
object is a DeferredSeries. This parameter only apply for DeferredDataFrame
type objects.</p>
<p>Use either <code class="docutils literal notranslate"><span class="pre">mapper</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> to
specify the axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, or <code class="docutils literal notranslate"><span class="pre">index</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
</p></li>
<li><p><strong>columns</strong> (<em>scalar</em><em>, </em><em>list-like</em><em>, </em><em>dict-like</em><em> or </em><em>function</em><em>, </em><em>optional</em>) – <p>A scalar, list-like, dict-like or functions transformations to
apply to that axis’ values.
Note that the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter is not allowed if the
object is a DeferredSeries. This parameter only apply for DeferredDataFrame
type objects.</p>
<p>Use either <code class="docutils literal notranslate"><span class="pre">mapper</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> to
specify the axis to target with <code class="docutils literal notranslate"><span class="pre">mapper</span></code>, or <code class="docutils literal notranslate"><span class="pre">index</span></code>
and/or <code class="docutils literal notranslate"><span class="pre">columns</span></code>.</p>
</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to rename. For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default None</em>) – Also copy underlying data.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Modifies the object directly, instead of creating a new DeferredSeries
or DeferredDataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The same type as the caller or None if <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a>, <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a>, or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.rename" title="apache_beam.dataframe.frames.DeferredSeries.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.rename</span></code></a></dt><dd><p>Alter DeferredSeries index labels or name.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.rename" title="apache_beam.dataframe.frames.DeferredDataFrame.rename"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.rename</span></code></a></dt><dd><p>Alter DeferredDataFrame index labels or name.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.rename</span></code></dt><dd><p>Set new names on index.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><code class="docutils literal notranslate"><span class="pre">DeferredDataFrame.rename_axis</span></code> supports two calling conventions</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(index=index_mapper,</span> <span class="pre">columns=columns_mapper,</span> <span class="pre">...)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(mapper,</span> <span class="pre">axis={'index',</span> <span class="pre">'columns'},</span> <span class="pre">...)</span></code></p></li>
</ul>
<p>The first calling convention will only modify the names of
the index and/or the names of the Index object that is the columns.
In this case, the parameter <code class="docutils literal notranslate"><span class="pre">copy</span></code> is ignored.</p>
<p>The second calling convention will modify the names of the
corresponding index if mapper is a list or a scalar.
However, if mapper is dict-like or a function, it will use the
deprecated behavior of modifying the axis <em>labels</em>.</p>
<p>We <em>highly</em> recommend using keyword arguments to clarify your
intent.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0       dog</span>
<span class="go">1       cat</span>
<span class="go">2    monkey</span>
<span class="go">dtype: object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;animal&quot;</span><span class="p">)</span>
<span class="go">animal</span>
<span class="go">0    dog</span>
<span class="go">1    cat</span>
<span class="go">2    monkey</span>
<span class="go">dtype: object</span>

<span class="go">**DataFrame**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;num_legs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;num_arms&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s2">&quot;dog&quot;</span><span class="p">,</span> <span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="s2">&quot;monkey&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_arms</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;animal&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_arms</span>
<span class="go">animal</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s2">&quot;limbs&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">limbs   num_legs  num_arms</span>
<span class="go">animal</span>
<span class="go">dog            4         0</span>
<span class="go">cat            4         0</span>
<span class="go">monkey         2         2</span>

<span class="go">**MultiIndex**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;mammal&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;monkey&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                                      <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">limbs          num_legs  num_arms</span>
<span class="go">type   name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">})</span>
<span class="go">limbs          num_legs  num_arms</span>
<span class="go">class  name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span>
<span class="go">LIMBS          num_legs  num_arms</span>
<span class="go">type   name</span>
<span class="go">mammal dog            4         0</span>
<span class="go">       cat            4         0</span>
<span class="go">       monkey         2         2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.round">
<span class="sig-name descname"><span class="pre">round</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decimals</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.round"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.round" title="Link to this definition">¶</a></dt>
<dd><p>Round a DataFrame to a variable number of decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decimals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a>) – Number of decimal places to round each column to. If an int is
given, round each column to the same number of places.
Otherwise dict and DeferredSeries round to variable numbers of places.
Column names should be in the keys if <cite>decimals</cite> is a
dict-like, or in the index if <cite>decimals</cite> is a DeferredSeries. Any
columns not included in <cite>decimals</cite> will be left as is. Elements
of <cite>decimals</cite> which are not columns of the input will be
ignored.</p></li>
<li><p><strong>*args</strong> – Additional keywords have no effect but might be accepted for
compatibility with numpy.</p></li>
<li><p><strong>**kwargs</strong> – Additional keywords have no effect but might be accepted for
compatibility with numpy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DeferredDataFrame with the affected columns rounded to the specified
number of decimal places.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.around.html#numpy.around" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.around</span></code></a></dt><dd><p>Round a numpy array to the given number of decimals.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.round" title="apache_beam.dataframe.frames.DeferredSeries.round"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.round</span></code></a></dt><dd><p>Round a DeferredSeries to the given number of decimals.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="mf">.21</span><span class="p">,</span> <span class="mf">.32</span><span class="p">),</span> <span class="p">(</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.67</span><span class="p">),</span> <span class="p">(</span><span class="mf">.66</span><span class="p">,</span> <span class="mf">.03</span><span class="p">),</span> <span class="p">(</span><span class="mf">.21</span><span class="p">,</span> <span class="mf">.18</span><span class="p">)],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;dogs&#39;</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">    dogs  cats</span>
<span class="go">0  0.21  0.32</span>
<span class="go">1  0.01  0.67</span>
<span class="go">2  0.66  0.03</span>
<span class="go">3  0.21  0.18</span>

<span class="go">By providing an integer each column is rounded to the same number</span>
<span class="go">of decimal places</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">    dogs  cats</span>
<span class="go">0   0.2   0.3</span>
<span class="go">1   0.0   0.7</span>
<span class="go">2   0.7   0.0</span>
<span class="go">3   0.2   0.2</span>

<span class="go">With a dict, the number of places for specific columns can be</span>
<span class="go">specified with the column names as key and the number of decimal</span>
<span class="go">places as value</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="s1">&#39;dogs&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cats&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="go">    dogs  cats</span>
<span class="go">0   0.2   0.0</span>
<span class="go">1   0.0   1.0</span>
<span class="go">2   0.7   0.0</span>
<span class="go">3   0.2   0.0</span>

<span class="go">Using a Series, the number of places for specific columns can be</span>
<span class="go">specified with the column names as index and the number of</span>
<span class="go">decimal places as value</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">decimals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cats&#39;</span><span class="p">,</span> <span class="s1">&#39;dogs&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="p">)</span>
<span class="go">    dogs  cats</span>
<span class="go">0   0.2   0.0</span>
<span class="go">1   0.0   1.0</span>
<span class="go">2   0.7   0.0</span>
<span class="go">3   0.2   0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes">
<span class="sig-name descname"><span class="pre">select_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes" title="Link to this definition">¶</a></dt>
<dd><p>Return a subset of the DataFrame’s columns based on the column dtypes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include</strong> (<em>scalar</em><em> or </em><em>list-like</em>) – A selection of dtypes or strings to be included/excluded. At least
one of these parameters must be supplied.</p></li>
<li><p><strong>exclude</strong> (<em>scalar</em><em> or </em><em>list-like</em>) – A selection of dtypes or strings to be included/excluded. At least
one of these parameters must be supplied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The subset of the frame including the dtypes in <code class="docutils literal notranslate"><span class="pre">include</span></code> and
excluding the dtypes in <code class="docutils literal notranslate"><span class="pre">exclude</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If both of <code class="docutils literal notranslate"><span class="pre">include</span></code> and <code class="docutils literal notranslate"><span class="pre">exclude</span></code> are empty
    * If <code class="docutils literal notranslate"><span class="pre">include</span></code> and <code class="docutils literal notranslate"><span class="pre">exclude</span></code> have overlapping elements
    * If any kind of string dtype is passed in.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.dtypes" title="apache_beam.dataframe.frames.DeferredDataFrame.dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.dtypes</span></code></a></dt><dd><p>Return DeferredSeries with the data type of each column.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>To select all <em>numeric</em> types, use <code class="docutils literal notranslate"><span class="pre">np.number</span></code> or <code class="docutils literal notranslate"><span class="pre">'number'</span></code></p></li>
<li><p>To select strings you must use the <code class="docutils literal notranslate"><span class="pre">object</span></code> dtype, but note that
this will return <em>all</em> object dtype columns</p></li>
<li><p>See the <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html">numpy dtype hierarchy</a></p></li>
<li><p>To select datetimes, use <code class="docutils literal notranslate"><span class="pre">np.datetime64</span></code>, <code class="docutils literal notranslate"><span class="pre">'datetime'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'datetime64'</span></code></p></li>
<li><p>To select timedeltas, use <code class="docutils literal notranslate"><span class="pre">np.timedelta64</span></code>, <code class="docutils literal notranslate"><span class="pre">'timedelta'</span></code> or
<code class="docutils literal notranslate"><span class="pre">'timedelta64'</span></code></p></li>
<li><p>To select Pandas categorical dtypes, use <code class="docutils literal notranslate"><span class="pre">'category'</span></code></p></li>
<li><p>To select Pandas datetimetz dtypes, use <code class="docutils literal notranslate"><span class="pre">'datetimetz'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'datetime64[ns,</span> <span class="pre">tz]'</span></code></p></li>
</ul>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        a      b  c</span>
<span class="go">0       1   True  1.0</span>
<span class="go">1       2  False  2.0</span>
<span class="go">2       1   True  1.0</span>
<span class="go">3       2  False  2.0</span>
<span class="go">4       1   True  1.0</span>
<span class="go">5       2  False  2.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
<span class="go">   b</span>
<span class="go">0  True</span>
<span class="go">1  False</span>
<span class="go">2  True</span>
<span class="go">3  False</span>
<span class="go">4  True</span>
<span class="go">5  False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">])</span>
<span class="go">   c</span>
<span class="go">0  1.0</span>
<span class="go">1  2.0</span>
<span class="go">2  1.0</span>
<span class="go">3  2.0</span>
<span class="go">4  1.0</span>
<span class="go">5  2.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
<span class="go">       b    c</span>
<span class="go">0   True  1.0</span>
<span class="go">1  False  2.0</span>
<span class="go">2   True  1.0</span>
<span class="go">3  False  2.0</span>
<span class="go">4   True  1.0</span>
<span class="go">5  False  2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.shift" title="Link to this definition">¶</a></dt>
<dd><p>Shift index by desired number of periods with an optional time <cite>freq</cite>.</p>
<p>When <cite>freq</cite> is not passed, shift the index without realigning the data.
If <cite>freq</cite> is passed (in this case, the index must be date or datetime,
or it will raise a <cite>NotImplementedError</cite>), the index will be
increased using the periods and the <cite>freq</cite>. <cite>freq</cite> can be inferred
when specified as “infer” as long as either freq or inferred_freq
attribute is set in the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>Sequence</em>) – Number of periods to shift. Can be positive or negative.
If an iterable of ints, the data will be shifted once by each int.
This is equivalent to shifting by one value at a time and
concatenating all resulting frames. The resulting columns will have
the shift suffixed to their column names. For multiple periods,
axis must not be 1.</p></li>
<li><p><strong>freq</strong> (<em>DateOffset</em><em>, </em><em>tseries.offsets</em><em>, </em><em>timedelta</em><em>, or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Offset to use from the tseries module or time rule (e.g. ‘EOM’).
If <cite>freq</cite> is specified then the index values are shifted but the
data is not realigned. That is, use <cite>freq</cite> if you would like to
extend the index when shifting and preserve the original data.
If <cite>freq</cite> is specified as “infer” then it will be inferred from
the freq or inferred_freq attributes of the index. If neither of
those attributes exist, a ValueError is thrown.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – Shift direction. For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a><em>, </em><em>optional</em>) – The scalar value to use for newly introduced missing values.
the default depends on the dtype of <cite>self</cite>.
For numeric data, <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> is used.
For datetime, timedelta, or period data, etc. <code class="xref py py-attr docutils literal notranslate"><span class="pre">NaT</span></code> is used.
For extension dtypes, <code class="docutils literal notranslate"><span class="pre">self.dtype.na_value</span></code> is used.</p></li>
<li><p><strong>suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – If str and periods is an iterable, this is added after the column
name and before the shift value for each shifted column name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Copy of input object, shifted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>shift with <code class="docutils literal notranslate"><span class="pre">axis=&quot;index&quot;</span> <span class="pre">is</span> <span class="pre">only</span> <span class="pre">supported</span> <span class="pre">with</span> <span class="pre">``freq</span></code> specified and
<code class="docutils literal notranslate"><span class="pre">fill_value</span></code> undefined. Other configurations make this operation
order-sensitive.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Index.shift</span></code></dt><dd><p>Shift values of Index.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DatetimeIndex.shift</span></code></dt><dd><p>Shift values of DatetimeIndex.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PeriodIndex.shift</span></code></dt><dd><p>Shift values of PeriodIndex.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;Col2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">48</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;Col3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">52</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-05&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-01    10    13    17</span>
<span class="go">2020-01-02    20    23    27</span>
<span class="go">2020-01-03    15    18    22</span>
<span class="go">2020-01-04    30    33    37</span>
<span class="go">2020-01-05    45    48    52</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-01   NaN   NaN   NaN</span>
<span class="go">2020-01-02   NaN   NaN   NaN</span>
<span class="go">2020-01-03   NaN   NaN   NaN</span>
<span class="go">2020-01-04  10.0  13.0  17.0</span>
<span class="go">2020-01-05  20.0  23.0  27.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-01   NaN    10    13</span>
<span class="go">2020-01-02   NaN    20    23</span>
<span class="go">2020-01-03   NaN    15    18</span>
<span class="go">2020-01-04   NaN    30    33</span>
<span class="go">2020-01-05   NaN    45    48</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-01     0     0     0</span>
<span class="go">2020-01-02     0     0     0</span>
<span class="go">2020-01-03     0     0     0</span>
<span class="go">2020-01-04    10    13    17</span>
<span class="go">2020-01-05    20    23    27</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-04    10    13    17</span>
<span class="go">2020-01-05    20    23    27</span>
<span class="go">2020-01-06    15    18    22</span>
<span class="go">2020-01-07    30    33    37</span>
<span class="go">2020-01-08    45    48    52</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;infer&quot;</span><span class="p">)</span>
<span class="go">            Col1  Col2  Col3</span>
<span class="go">2020-01-04    10    13    17</span>
<span class="go">2020-01-05    20    23    27</span>
<span class="go">2020-01-06    15    18    22</span>
<span class="go">2020-01-07    30    33    37</span>
<span class="go">2020-01-08    45    48    52</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Col1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="go">            Col1_0  Col1_1  Col1_2</span>
<span class="go">2020-01-01      10     NaN     NaN</span>
<span class="go">2020-01-02      20    10.0     NaN</span>
<span class="go">2020-01-03      15    20.0    10.0</span>
<span class="go">2020-01-04      30    15.0    20.0</span>
<span class="go">2020-01-05      45    30.0    15.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.shape" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.shape()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.stack" title="Link to this definition">¶</a></dt>
<dd><p>Stack the prescribed level(s) from columns to index.</p>
<p>Return a reshaped DataFrame or Series having a multi-level
index with one or more new inner-most levels compared to the current
DataFrame. The new inner-most levels are created by pivoting the
columns of the current dataframe:</p>
<blockquote>
<div><ul class="simple">
<li><p>if the columns have a single level, the output is a Series;</p></li>
<li><p>if the columns have multiple levels, the new index
level(s) is (are) taken from the prescribed level(s) and
the output is a DataFrame.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>default -1</em>) – Level(s) to stack from the column axis onto the index
axis, defined as one index or label, or a list of indices
or labels.</p></li>
<li><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Whether to drop rows in the resulting Frame/DeferredSeries with
missing values. Stacking a column level onto the index
axis can create combinations of index and column values
that are missing from the original dataframe. See Examples
section.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Whether to sort the levels of the resulting MultiIndex.</p></li>
<li><p><strong>future_stack</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Whether to use the new implementation that will replace the current
implementation in pandas 3.0. When True, dropna and sort have no impact
on the result and must remain unspecified. See <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/whatsnew/v2.1.0.html#whatsnew-210-enhancements-new-stack" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">pandas 2.1.0 Release
notes</span></a> for more details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Stacked dataframe or series.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.unstack</span></code></dt><dd><p>Unstack prescribed level(s) from index axis onto column axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot" title="apache_beam.dataframe.frames.DeferredDataFrame.pivot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pivot</span></code></a></dt><dd><p>Reshape dataframe from long format to wide format.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot_table" title="apache_beam.dataframe.frames.DeferredDataFrame.pivot_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pivot_table</span></code></a></dt><dd><p>Create a spreadsheet-style pivot table as a DeferredDataFrame.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The function is named by analogy with a collection of books
being reorganized from being side by side on a horizontal
position (the columns of the dataframe) to being stacked
vertically on top of each other (in the index of the
dataframe).</p>
<p>Reference <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping-stacking" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more examples.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Single level columns**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_single_level_cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>
<span class="gp">... </span>                                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">])</span>

<span class="go">Stacking a dataframe with a single level column axis returns a Series:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_single_level_cols</span>
<span class="go">     weight height</span>
<span class="go">cat       0      1</span>
<span class="go">dog       2      3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_single_level_cols</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">future_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">cat  weight    0</span>
<span class="go">     height    1</span>
<span class="go">dog  weight    2</span>
<span class="go">     height    3</span>
<span class="go">dtype: int64</span>

<span class="go">**Multi level columns: simple case**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">multicol1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                       <span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;pounds&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>                                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">columns</span><span class="o">=</span><span class="n">multicol1</span><span class="p">)</span>

<span class="go">Stacking a dataframe with a multi-level column axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols1</span>
<span class="go">     weight</span>
<span class="go">         kg    pounds</span>
<span class="go">cat       1        2</span>
<span class="go">dog       2        4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols1</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">future_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">            weight</span>
<span class="go">cat kg           1</span>
<span class="go">    pounds       2</span>
<span class="go">dog kg           2</span>
<span class="go">    pounds       4</span>

<span class="go">**Missing values**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">multicol2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                       <span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]],</span>
<span class="gp">... </span>                                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">columns</span><span class="o">=</span><span class="n">multicol2</span><span class="p">)</span>

<span class="go">It is common to have missing values when stacking a dataframe</span>
<span class="go">with multi-level columns, as the stacked dataframe typically</span>
<span class="go">has more values than the original dataframe. Missing values</span>
<span class="go">are filled with NaNs:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols2</span>
<span class="go">    weight height</span>
<span class="go">        kg      m</span>
<span class="go">cat    1.0    2.0</span>
<span class="go">dog    3.0    4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols2</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">future_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">        weight  height</span>
<span class="go">cat kg     1.0     NaN</span>
<span class="go">    m      NaN     2.0</span>
<span class="go">dog kg     3.0     NaN</span>
<span class="go">    m      NaN     4.0</span>

<span class="go">**Prescribing the level(s) to be stacked**</span>

<span class="go">The first parameter controls which level or levels are stacked:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols2</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">future_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">             kg    m</span>
<span class="go">cat weight  1.0  NaN</span>
<span class="go">    height  NaN  2.0</span>
<span class="go">dog weight  3.0  NaN</span>
<span class="go">    height  NaN  4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols2</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">future_stack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">cat  weight  kg    1.0</span>
<span class="go">     height  m     2.0</span>
<span class="go">dog  weight  kg    3.0</span>
<span class="go">     height  m     4.0</span>
<span class="go">dtype: float64</span>

<span class="go">**Dropping missing values**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]],</span>
<span class="gp">... </span>                                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">columns</span><span class="o">=</span><span class="n">multicol2</span><span class="p">)</span>

<span class="go">Note that rows where all values are missing are dropped by</span>
<span class="go">default but this behaviour can be controlled via the dropna</span>
<span class="go">keyword parameter:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols3</span>
<span class="go">    weight height</span>
<span class="go">        kg      m</span>
<span class="go">cat    NaN    1.0</span>
<span class="go">dog    2.0    3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols3</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">        weight  height</span>
<span class="go">cat kg     NaN     NaN</span>
<span class="go">    m      NaN     1.0</span>
<span class="go">dog kg     2.0     NaN</span>
<span class="go">    m      NaN     3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multi_level_cols3</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">        weight  height</span>
<span class="go">cat m      NaN     1.0</span>
<span class="go">dog kg     2.0     NaN</span>
<span class="go">    m      NaN     3.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.all">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.all" title="Link to this definition">¶</a></dt>
<dd><p>Return whether all elements are True, potentially over an axis.</p>
<p>Returns True unless there at least one element within a series or
along a Dataframe axis that is False or equivalent (e.g. zero or
empty).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default 0</em>) – <p>Indicate which axis or axes should be reduced. For <cite>DeferredSeries</cite> this parameter
is unused and defaults to 0.</p>
<ul>
<li><p>0 / ‘index’ : reduce the index, return a DeferredSeries whose index is the
original column labels.</p></li>
<li><p>1 / ‘columns’ : reduce the columns, return a DeferredSeries whose index is the
original index.</p></li>
<li><p>None : reduce all axes, return a scalar.</p></li>
</ul>
</p></li>
<li><p><strong>bool_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire row/column is NA and skipna is
True, then the result will be True, as for an empty row/column.
If skipna is False, then NA are treated as True, because these are not
equal to zero.</p></li>
<li><p><strong>**kwargs</strong> (<em>any</em><em>, </em><em>default None</em>) – Additional keywords have no effect but might be accepted for
compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If level is specified, then, DeferredDataFrame is returned; otherwise, DeferredSeries
is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.all" title="apache_beam.dataframe.frames.DeferredSeries.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.all</span></code></a></dt><dd><p>Return True if all elements are True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.any" title="apache_beam.dataframe.frames.DeferredDataFrame.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.any</span></code></a></dt><dd><p>Return True if one (or more) elements are True.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">**DataFrames**</span>

<span class="go">Create a dataframe from a dictionary.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   col1   col2</span>
<span class="go">0  True   True</span>
<span class="go">1  True  False</span>

<span class="go">Default behaviour checks if values in each column all return True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">col1     True</span>
<span class="go">col2    False</span>
<span class="go">dtype: bool</span>

<span class="go">Specify ``axis=&#39;columns&#39;`` to check if values in each row all return True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0     True</span>
<span class="go">1    False</span>
<span class="go">dtype: bool</span>

<span class="go">Or ``axis=None`` for whether every value is True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.any">
<span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.any" title="Link to this definition">¶</a></dt>
<dd><p>Return whether any element is True, potentially over an axis.</p>
<p>Returns False unless there is at least one element within a series or
along a Dataframe axis that is True or equivalent (e.g. non-zero or
non-empty).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default 0</em>) – <p>Indicate which axis or axes should be reduced. For <cite>DeferredSeries</cite> this parameter
is unused and defaults to 0.</p>
<ul>
<li><p>0 / ‘index’ : reduce the index, return a DeferredSeries whose index is the
original column labels.</p></li>
<li><p>1 / ‘columns’ : reduce the columns, return a DeferredSeries whose index is the
original index.</p></li>
<li><p>None : reduce all axes, return a scalar.</p></li>
</ul>
</p></li>
<li><p><strong>bool_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If the entire row/column is NA and skipna is
True, then the result will be False, as for an empty row/column.
If skipna is False, then NA are treated as True, because these are not
equal to zero.</p></li>
<li><p><strong>**kwargs</strong> (<em>any</em><em>, </em><em>default None</em>) – Additional keywords have no effect but might be accepted for
compatibility with NumPy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If level is specified, then, DeferredDataFrame is returned; otherwise, DeferredSeries
is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.any.html#numpy.any" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.any</span></code></a></dt><dd><p>Numpy version of this method.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.any" title="apache_beam.dataframe.frames.DeferredSeries.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.any</span></code></a></dt><dd><p>Return whether any element is True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.all" title="apache_beam.dataframe.frames.DeferredSeries.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.all</span></code></a></dt><dd><p>Return whether all elements are True.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.any" title="apache_beam.dataframe.frames.DeferredDataFrame.any"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.any</span></code></a></dt><dd><p>Return whether any element is True over requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.all" title="apache_beam.dataframe.frames.DeferredDataFrame.all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.all</span></code></a></dt><dd><p>Return whether all elements are True over requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">**Series**</span>

<span class="go">For Series input, the output is a scalar indicating whether any element</span>
<span class="go">is True.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">**DataFrame**</span>

<span class="go">Whether each column contains at least one True element (the default).</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B  C</span>
<span class="go">0  1  0  0</span>
<span class="go">1  2  2  0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">A     True</span>
<span class="go">B     True</span>
<span class="go">C    False</span>
<span class="go">dtype: bool</span>

<span class="go">Aggregating over the columns.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       A  B</span>
<span class="go">0   True  1</span>
<span class="go">1  False  2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0    True</span>
<span class="go">1    True</span>
<span class="go">dtype: bool</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">       A  B</span>
<span class="go">0   True  1</span>
<span class="go">1  False  0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0    True</span>
<span class="go">1    False</span>
<span class="go">dtype: bool</span>

<span class="go">Aggregating over the entire DataFrame with ``axis=None``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">`any` for an empty DataFrame is an empty Series.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">Series([], dtype: bool)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.count">
<span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="Link to this definition">¶</a></dt>
<dd><p>Count non-NA cells for each column or row.</p>
<p>The values <cite>None</cite>, <cite>NaN</cite>, <cite>NaT</cite>, <code class="docutils literal notranslate"><span class="pre">pandas.NA</span></code> are considered NA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – If 0 or ‘index’ counts are generated for each column.
If 1 or ‘columns’ counts are generated for each row.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>For each column/row the number of non-NA/null entries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.count" title="apache_beam.dataframe.frames.DeferredSeries.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.count</span></code></a></dt><dd><p>Number of non-NA elements in a DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.value_counts" title="apache_beam.dataframe.frames.DeferredDataFrame.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.value_counts</span></code></a></dt><dd><p>Count unique combinations of columns.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.shape" title="apache_beam.dataframe.frames.DeferredDataFrame.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.shape</span></code></a></dt><dd><p>Number of DeferredDataFrame rows and columns (including NA elements).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.isna" title="apache_beam.dataframe.frames.DeferredDataFrame.isna"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.isna</span></code></a></dt><dd><p>Boolean same-sized DeferredDataFrame showing places of NA elements.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Constructing DataFrame from a dictionary:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Person&quot;</span><span class="p">:</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Myla&quot;</span><span class="p">,</span> <span class="s2">&quot;Lewis&quot;</span><span class="p">,</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;Myla&quot;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;Age&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">24.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">26</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;Single&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   Person   Age  Single</span>
<span class="go">0    John  24.0   False</span>
<span class="go">1    Myla   NaN    True</span>
<span class="go">2   Lewis  21.0    True</span>
<span class="go">3    John  33.0    True</span>
<span class="go">4    Myla  26.0   False</span>

<span class="go">Notice the uncounted NA values:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">Person    5</span>
<span class="go">Age       4</span>
<span class="go">Single    5</span>
<span class="go">dtype: int64</span>

<span class="go">Counts for each **row**:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">0    3</span>
<span class="go">1    2</span>
<span class="go">2    3</span>
<span class="go">3    3</span>
<span class="go">4    3</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.describe" title="Link to this definition">¶</a></dt>
<dd><p>Generate descriptive statistics.</p>
<p>Descriptive statistics include those that summarize the central
tendency, dispersion and shape of a
dataset’s distribution, excluding <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.</p>
<p>Analyzes both numeric and object series, as well
as <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> column sets of mixed data types. The output
will vary depending on what is provided. Refer to the notes
below for more detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>percentiles</strong> (<em>list-like</em><em> of </em><em>numbers</em><em>, </em><em>optional</em>) – The percentiles to include in the output. All should
fall between 0 and 1. The default is
<code class="docutils literal notranslate"><span class="pre">[.25,</span> <span class="pre">.5,</span> <span class="pre">.75]</span></code>, which returns the 25th, 50th, and
75th percentiles.</p></li>
<li><p><strong>include</strong> (<em>'all'</em><em>, </em><em>list-like</em><em> of </em><em>dtypes</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em><em>, </em><em>optional</em>) – <p>A white list of data types to include in the result. Ignored
for <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>. Here are the options:</p>
<ul>
<li><p>’all’ : All columns of the input will be included in the output.</p></li>
<li><p>A list-like of dtypes : Limits the results to the
provided data types.
To limit the result to numeric types submit
<code class="docutils literal notranslate"><span class="pre">numpy.number</span></code>. To limit it instead to object columns submit
the <code class="docutils literal notranslate"><span class="pre">numpy.object</span></code> data type. Strings
can also be used in the style of
<code class="docutils literal notranslate"><span class="pre">select_dtypes</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">df.describe(include=['O'])</span></code>). To
select pandas categorical columns, use <code class="docutils literal notranslate"><span class="pre">'category'</span></code></p></li>
<li><p>None (default) : The result will include all numeric columns.</p></li>
</ul>
</p></li>
<li><p><strong>exclude</strong> (<em>list-like</em><em> of </em><em>dtypes</em><em> or </em><em>None</em><em> (</em><em>default</em><em>)</em><em>, </em><em>optional</em><em>,</em>) – <p>A black list of data types to omit from the result. Ignored
for <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>. Here are the options:</p>
<ul>
<li><p>A list-like of dtypes : Excludes the provided data types
from the result. To exclude numeric types submit
<code class="docutils literal notranslate"><span class="pre">numpy.number</span></code>. To exclude object columns submit the data
type <code class="docutils literal notranslate"><span class="pre">numpy.object</span></code>. Strings can also be used in the style of
<code class="docutils literal notranslate"><span class="pre">select_dtypes</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">df.describe(exclude=['O'])</span></code>). To
exclude pandas categorical columns, use <code class="docutils literal notranslate"><span class="pre">'category'</span></code></p></li>
<li><p>None (default) : The result will exclude nothing.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Summary statistics of the DeferredSeries or Dataframe provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">describe</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="apache_beam.dataframe.frames.DeferredDataFrame.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.count</span></code></a></dt><dd><p>Count number of non-NA/null observations.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Maximum of the values in the object.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Minimum of the values in the object.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mean" title="apache_beam.dataframe.frames.DeferredDataFrame.mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mean</span></code></a></dt><dd><p>Mean of the values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.std" title="apache_beam.dataframe.frames.DeferredDataFrame.std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.std</span></code></a></dt><dd><p>Standard deviation of the observations.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes" title="apache_beam.dataframe.frames.DeferredDataFrame.select_dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.select_dtypes</span></code></a></dt><dd><p>Subset of a DeferredDataFrame including/excluding columns based on their dtype.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For numeric data, the result’s index will include <code class="docutils literal notranslate"><span class="pre">count</span></code>,
<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code> as well as lower, <code class="docutils literal notranslate"><span class="pre">50</span></code> and
upper percentiles. By default the lower percentile is <code class="docutils literal notranslate"><span class="pre">25</span></code> and the
upper percentile is <code class="docutils literal notranslate"><span class="pre">75</span></code>. The <code class="docutils literal notranslate"><span class="pre">50</span></code> percentile is the
same as the median.</p>
<p>For object data (e.g. strings or timestamps), the result’s index
will include <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">unique</span></code>, <code class="docutils literal notranslate"><span class="pre">top</span></code>, and <code class="docutils literal notranslate"><span class="pre">freq</span></code>. The <code class="docutils literal notranslate"><span class="pre">top</span></code>
is the most common value. The <code class="docutils literal notranslate"><span class="pre">freq</span></code> is the most common value’s
frequency. Timestamps also include the <code class="docutils literal notranslate"><span class="pre">first</span></code> and <code class="docutils literal notranslate"><span class="pre">last</span></code> items.</p>
<p>If multiple object values have the highest count, then the
<code class="docutils literal notranslate"><span class="pre">count</span></code> and <code class="docutils literal notranslate"><span class="pre">top</span></code> results will be arbitrarily chosen from
among those with the highest count.</p>
<p>For mixed data types provided via a <code class="docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code>, the default is to
return only an analysis of numeric columns. If the dataframe consists
only of object and categorical data without any numeric columns, the
default is to return an analysis of both the object and categorical
columns. If <code class="docutils literal notranslate"><span class="pre">include='all'</span></code> is provided as an option, the result
will include a union of attributes of each type.</p>
<p>The <cite>include</cite> and <cite>exclude</cite> parameters can be used to limit
which columns in a <code class="docutils literal notranslate"><span class="pre">DeferredDataFrame</span></code> are analyzed for the output.
The parameters are ignored when analyzing a <code class="docutils literal notranslate"><span class="pre">DeferredSeries</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Describing a numeric ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count    3.0</span>
<span class="go">mean     2.0</span>
<span class="go">std      1.0</span>
<span class="go">min      1.0</span>
<span class="go">25%      1.5</span>
<span class="go">50%      2.0</span>
<span class="go">75%      2.5</span>
<span class="go">max      3.0</span>
<span class="go">dtype: float64</span>

<span class="go">Describing a categorical ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count     4</span>
<span class="go">unique    3</span>
<span class="go">top       a</span>
<span class="go">freq      2</span>
<span class="go">dtype: object</span>

<span class="go">Describing a timestamp ``Series``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count                      3</span>
<span class="go">mean     2006-09-01 08:00:00</span>
<span class="go">min      2000-01-01 00:00:00</span>
<span class="go">25%      2004-12-31 12:00:00</span>
<span class="go">50%      2010-01-01 00:00:00</span>
<span class="go">75%      2010-01-01 00:00:00</span>
<span class="go">max      2010-01-01 00:00:00</span>
<span class="go">dtype: object</span>

<span class="go">Describing a ``DataFrame``. By default only numeric fields</span>
<span class="go">are returned.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;categorical&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">]),</span>
<span class="gp">... </span>                   <span class="s1">&#39;numeric&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="gp">... </span>                  <span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">       numeric</span>
<span class="go">count      3.0</span>
<span class="go">mean       2.0</span>
<span class="go">std        1.0</span>
<span class="go">min        1.0</span>
<span class="go">25%        1.5</span>
<span class="go">50%        2.0</span>
<span class="go">75%        2.5</span>
<span class="go">max        3.0</span>

<span class="go">Describing all columns of a ``DataFrame`` regardless of data type.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>  
<span class="go">       categorical  numeric object</span>
<span class="go">count            3      3.0      3</span>
<span class="go">unique           3      NaN      3</span>
<span class="go">top              f      NaN      a</span>
<span class="go">freq             1      NaN      1</span>
<span class="go">mean           NaN      2.0    NaN</span>
<span class="go">std            NaN      1.0    NaN</span>
<span class="go">min            NaN      1.0    NaN</span>
<span class="go">25%            NaN      1.5    NaN</span>
<span class="go">50%            NaN      2.0    NaN</span>
<span class="go">75%            NaN      2.5    NaN</span>
<span class="go">max            NaN      3.0    NaN</span>

<span class="go">Describing a column from a ``DataFrame`` by accessing it as</span>
<span class="go">an attribute.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">numeric</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="go">count    3.0</span>
<span class="go">mean     2.0</span>
<span class="go">std      1.0</span>
<span class="go">min      1.0</span>
<span class="go">25%      1.5</span>
<span class="go">50%      2.0</span>
<span class="go">75%      2.5</span>
<span class="go">max      3.0</span>
<span class="go">Name: numeric, dtype: float64</span>

<span class="go">Including only numeric columns in a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>
<span class="go">       numeric</span>
<span class="go">count      3.0</span>
<span class="go">mean       2.0</span>
<span class="go">std        1.0</span>
<span class="go">min        1.0</span>
<span class="go">25%        1.5</span>
<span class="go">50%        2.0</span>
<span class="go">75%        2.5</span>
<span class="go">max        3.0</span>

<span class="go">Including only string columns in a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>  
<span class="go">       object</span>
<span class="go">count       3</span>
<span class="go">unique      3</span>
<span class="go">top         a</span>
<span class="go">freq        1</span>

<span class="go">Including only categorical columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>
<span class="go">       categorical</span>
<span class="go">count            3</span>
<span class="go">unique           3</span>
<span class="go">top              d</span>
<span class="go">freq             1</span>

<span class="go">Excluding numeric columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span>  
<span class="go">       categorical object</span>
<span class="go">count            3      3</span>
<span class="go">unique           3      3</span>
<span class="go">top              f      a</span>
<span class="go">freq             1      1</span>

<span class="go">Excluding object columns from a ``DataFrame`` description.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="nb">object</span><span class="p">])</span>  
<span class="go">       categorical  numeric</span>
<span class="go">count            3      3.0</span>
<span class="go">unique           3      NaN</span>
<span class="go">top              f      NaN</span>
<span class="go">freq             1      NaN</span>
<span class="go">mean           NaN      2.0</span>
<span class="go">std            NaN      1.0</span>
<span class="go">min            NaN      1.0</span>
<span class="go">25%            NaN      1.5</span>
<span class="go">50%            NaN      2.0</span>
<span class="go">75%            NaN      2.5</span>
<span class="go">max            NaN      3.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="Link to this definition">¶</a></dt>
<dd><p>Return the maximum of the values over the requested axis.</p>
<p>If you want the <em>index</em> of the maximum, use <code class="docutils literal notranslate"><span class="pre">idxmax</span></code>. This is the equivalent of the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> method <code class="docutils literal notranslate"><span class="pre">argmax</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="Link to this definition">¶</a></dt>
<dd><p>Return the minimum of the values over the requested axis.</p>
<p>If you want the <em>index</em> of the minimum, use <code class="docutils literal notranslate"><span class="pre">idxmin</span></code>. This is the equivalent of the <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> method <code class="docutils literal notranslate"><span class="pre">argmin</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.pivot">
<span class="sig-name descname"><span class="pre">pivot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.pivot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot" title="Link to this definition">¶</a></dt>
<dd><p>Return reshaped DataFrame organized by given index / column values.</p>
<p>Reshape data (produce a “pivot” table) based on column values. Uses
unique values from specified <cite>index</cite> / <cite>columns</cite> to form axes of the
resulting DataFrame. This function does not support data
aggregation, multiple values will result in a MultiIndex in the
columns. See the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">User Guide</span></a> for more on reshaping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a><em> or </em><em>a list</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Column to use to make new frame’s columns.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a><em> or </em><em>a list</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Column to use to make new frame’s index. If not given, uses existing index.</p></li>
<li><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><em>object</em></a><em> or </em><em>a list</em><em> of </em><em>the previous</em><em>, </em><em>optional</em>) – Column(s) to use for populating new frame’s values. If not
specified, all remaining columns will be used and the result will
have hierarchically indexed columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns reshaped DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError:</strong> – When there are any <cite>index</cite>, <cite>columns</cite> combinations with multiple
    values. <cite>DeferredDataFrame.pivot_table</cite> when you need to aggregate.</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Because pivot is a non-deferred method, any columns specified in
<code class="docutils literal notranslate"><span class="pre">columns</span></code> must be CategoricalDType so we can determine the output column
names.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot_table" title="apache_beam.dataframe.frames.DeferredDataFrame.pivot_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pivot_table</span></code></a></dt><dd><p>Generalization of pivot that can handle duplicate values for one index/column pair.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.unstack</span></code></dt><dd><p>Pivot based on the index values instead of a column.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">wide_to_long</span></code></dt><dd><p>Wide panel to long format. Less flexible but more user-friendly than melt.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For finer-tuned control, see hierarchical indexing documentation along
with the related stack/unstack methods.</p>
<p>Reference <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping-pivot" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more examples.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="s1">&#39;two&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;baz&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;zoo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">    foo   bar  baz  zoo</span>
<span class="go">0   one   A    1    x</span>
<span class="go">1   one   B    2    y</span>
<span class="go">2   one   C    3    z</span>
<span class="go">3   two   A    4    q</span>
<span class="go">4   two   B    5    w</span>
<span class="go">5   two   C    6    t</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;baz&#39;</span><span class="p">)</span>
<span class="go">bar  A   B   C</span>
<span class="go">foo</span>
<span class="go">one  1   2   3</span>
<span class="go">two  4   5   6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)[</span><span class="s1">&#39;baz&#39;</span><span class="p">]</span>
<span class="go">bar  A   B   C</span>
<span class="go">foo</span>
<span class="go">one  1   2   3</span>
<span class="go">two  4   5   6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;zoo&#39;</span><span class="p">])</span>
<span class="go">      baz       zoo</span>
<span class="go">bar   A  B  C   A  B  C</span>
<span class="go">foo</span>
<span class="go">one   1  2  3   x  y  z</span>
<span class="go">two   4  5  6   q  w  t</span>

<span class="go">You could also assign a list of column names or a list of index names.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>       <span class="s2">&quot;lev1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s2">&quot;lev2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s2">&quot;lev3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s2">&quot;lev4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">    lev1 lev2 lev3 lev4 values</span>
<span class="go">0   1    1    1    1    0</span>
<span class="go">1   1    1    2    2    1</span>
<span class="go">2   1    2    1    3    2</span>
<span class="go">3   2    1    2    4    3</span>
<span class="go">4   2    1    1    5    4</span>
<span class="go">5   2    2    2    6    5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;lev1&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lev2&quot;</span><span class="p">,</span> <span class="s2">&quot;lev3&quot;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="go">lev2    1         2</span>
<span class="go">lev3    1    2    1    2</span>
<span class="go">lev1</span>
<span class="go">1     0.0  1.0  2.0  NaN</span>
<span class="go">2     4.0  3.0  NaN  5.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lev1&quot;</span><span class="p">,</span> <span class="s2">&quot;lev2&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lev3&quot;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="go">      lev3    1    2</span>
<span class="go">lev1  lev2</span>
<span class="go">   1     1  0.0  1.0</span>
<span class="go">         2  2.0  NaN</span>
<span class="go">   2     1  4.0  3.0</span>
<span class="go">         2  NaN  5.0</span>

<span class="go">A ValueError is raised if there are any duplicates.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s2">&quot;baz&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   foo bar  baz</span>
<span class="go">0  one   A    1</span>
<span class="go">1  one   A    2</span>
<span class="go">2  two   B    3</span>
<span class="go">3  two   C    4</span>

<span class="go">Notice that the first two rows are the same for our `index`</span>
<span class="go">and `columns` arguments.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;baz&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">   </span><span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Index contains duplicate entries, cannot reshape</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.prod">
<span class="sig-name descname"><span class="pre">prod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.prod" title="Link to this definition">¶</a></dt>
<dd><p>Return the product of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default, the product of an empty or all-NA Series is ``1``</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.product">
<span class="sig-name descname"><span class="pre">product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.product" title="Link to this definition">¶</a></dt>
<dd><p>Return the product of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">By default, the product of an empty or all-NA Series is ``1``</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="Link to this definition">¶</a></dt>
<dd><p>Return the sum of the values over the requested axis.</p>
<p>This is equivalent to the method <code class="docutils literal notranslate"><span class="pre">numpy.sum</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>min_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – The required number of valid values to perform the operation. If fewer than
<code class="docutils literal notranslate"><span class="pre">min_count</span></code> non-NA values are present the result will be NA.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or scalar</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.sum" title="apache_beam.dataframe.frames.DeferredSeries.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.sum</span></code></a></dt><dd><p>Return the sum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.min" title="apache_beam.dataframe.frames.DeferredSeries.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.min</span></code></a></dt><dd><p>Return the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.max" title="apache_beam.dataframe.frames.DeferredSeries.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.max</span></code></a></dt><dd><p>Return the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return the index of the minimum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return the index of the maximum.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sum" title="apache_beam.dataframe.frames.DeferredDataFrame.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sum</span></code></a></dt><dd><p>Return the sum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.min" title="apache_beam.dataframe.frames.DeferredDataFrame.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.min</span></code></a></dt><dd><p>Return the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.max" title="apache_beam.dataframe.frames.DeferredDataFrame.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.max</span></code></a></dt><dd><p>Return the maximum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmin</span></code></a></dt><dd><p>Return the index of the minimum over the requested axis.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="apache_beam.dataframe.frames.DeferredDataFrame.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.idxmax</span></code></a></dt><dd><p>Return the index of the maximum over the requested axis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;warm&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">,</span> <span class="s1">&#39;cold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;spider&#39;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blooded&#39;</span><span class="p">,</span> <span class="s1">&#39;animal&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;legs&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">blooded  animal</span>
<span class="go">warm     dog       4</span>
<span class="go">         falcon    2</span>
<span class="go">cold     fish      0</span>
<span class="go">         spider    8</span>
<span class="go">Name: legs, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">14</span>

<span class="go">By default, the sum of an empty or all-NA Series is ``0``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>  <span class="c1"># min_count=0 is the default</span>
<span class="go">0.0</span>

<span class="go">This can be controlled with the ``min_count`` parameter. For example, if</span>
<span class="go">you&#39;d like the sum of an empty series to be NaN, pass ``min_count=1``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>

<span class="go">Thanks to the ``skipna`` parameter, ``min_count`` handles all-NA and</span>
<span class="go">empty series identically.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">0.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">nan</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.mean" title="Link to this definition">¶</a></dt>
<dd><p>Return the mean of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.mean()</span>
<span class="go">            2.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.mean()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.mean(axis=1)</span>
<span class="go">            tiger   1.5</span>
<span class="go">            zebra   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">            getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.mean(numeric_only=True)</span>
<span class="go">            a   1.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.mean()</span>
<span class="go">        2.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.mean()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.mean(axis=1)</span>
<span class="go">        tiger   1.5</span>
<span class="go">        zebra   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">        getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.mean(numeric_only=True)</span>
<span class="go">        a   1.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.median">
<span class="sig-name descname"><span class="pre">median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.median" title="Link to this definition">¶</a></dt>
<dd><p>Return the median of the values over the requested axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.median()</span>
<span class="go">            2.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.median()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.median(axis=1)</span>
<span class="go">            tiger   1.5</span>
<span class="go">            zebra   2.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True`</span>
<span class="go">            to avoid getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.median(numeric_only=True)</span>
<span class="go">            a   1.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.median()</span>
<span class="go">        2.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.median()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.median(axis=1)</span>
<span class="go">        tiger   1.5</span>
<span class="go">        zebra   2.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True`</span>
<span class="go">        to avoid getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.median(numeric_only=True)</span>
<span class="go">        a   1.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">median</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.nunique">
<span class="sig-name descname"><span class="pre">nunique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.nunique" title="Link to this definition">¶</a></dt>
<dd><p>Count number of distinct elements in specified axis.</p>
<p>Return Series with number of distinct elements. Can ignore NaN
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to use. 0 or ‘index’ for row-wise, 1 or ‘columns’ for
column-wise.</p></li>
<li><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Don’t include NaN in the counts.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.nunique" title="apache_beam.dataframe.frames.DeferredSeries.nunique"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.nunique</span></code></a></dt><dd><p>Method nunique for DeferredSeries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.count" title="apache_beam.dataframe.frames.DeferredDataFrame.count"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.count</span></code></a></dt><dd><p>Count non-NA cells for each column or row.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="go">A    3</span>
<span class="go">B    2</span>
<span class="go">dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">nunique</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0    1</span>
<span class="go">1    2</span>
<span class="go">2    2</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.std" title="Link to this definition">¶</a></dt>
<dd><p>Return sample standard deviation over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> (if level specified)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Notes</p>
<p>To have the same behaviour as <cite>numpy.std</cite>, use <cite>ddof=0</cite> (instead of the
default <cite>ddof=1</cite>)</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.87</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">]}</span>
<span class="gp">... </span>                  <span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;person_id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           age  height</span>
<span class="go">person_id</span>
<span class="go">0           21    1.61</span>
<span class="go">1           25    1.87</span>
<span class="go">2           62    1.49</span>
<span class="go">3           43    2.01</span>

<span class="go">The standard deviation of the columns can be found as follows:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="go">age       18.786076</span>
<span class="go">height     0.237417</span>
<span class="go">dtype: float64</span>

<span class="go">Alternatively, `ddof=0` can be set to normalize by N instead of N-1:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">age       16.269219</span>
<span class="go">height     0.205609</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.var">
<span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.var" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased variance over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a> or <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> (if level specified)</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.87</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">]}</span>
<span class="gp">... </span>                 <span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;person_id&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           age  height</span>
<span class="go">person_id</span>
<span class="go">0           21    1.61</span>
<span class="go">1           25    1.87</span>
<span class="go">2           62    1.49</span>
<span class="go">3           43    2.01</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="go">age       352.916667</span>
<span class="go">height      0.056367</span>
<span class="go">dtype: float64</span>

<span class="go">Alternatively, ``ddof=0`` can be set to normalize by N instead of N-1:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">age       264.687500</span>
<span class="go">height      0.042275</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.sem">
<span class="sig-name descname"><span class="pre">sem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.sem" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased standard error of the mean over requested axis.</p>
<p>Normalized by N-1 by default. This can be changed using the ddof argument</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>ddof</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 1</em>) – Delta Degrees of Freedom. The divisor used in calculations is N - ddof,
where N represents the number of elements.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or DataFrame (if level specified)</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or DataFrame (if level specified)</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.sem().round(6)</span>
<span class="go">            0.57735</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">            tiger  1   2</span>
<span class="go">            zebra  2   3</span>
<span class="go">            &gt;&gt;&gt; df.sem()</span>
<span class="go">            a   0.5</span>
<span class="go">            b   0.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.sem(axis=1)</span>
<span class="go">            tiger   0.5</span>
<span class="go">            zebra   0.5</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True`</span>
<span class="go">            to avoid getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">            ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.sem(numeric_only=True)</span>
<span class="go">            a   0.5</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.sem().round(6)</span>
<span class="go">        0.57735</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [2, 3]}, index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">        tiger  1   2</span>
<span class="go">        zebra  2   3</span>
<span class="go">        &gt;&gt;&gt; df.sem()</span>
<span class="go">        a   0.5</span>
<span class="go">        b   0.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.sem(axis=1)</span>
<span class="go">        tiger   0.5</span>
<span class="go">        zebra   0.5</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True`</span>
<span class="go">        to avoid getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;]},</span>
<span class="go">        ...                   index=[&#39;tiger&#39;, &#39;zebra&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.sem(numeric_only=True)</span>
<span class="go">        a   0.5</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">sem</span></code> cannot currently be parallelized. It will require collecting all data on a single node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.skew">
<span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.skew" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased skew over requested axis.</p>
<p>Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">            &gt;&gt;&gt; s.skew()</span>
<span class="go">            0.0</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [2, 3, 4], &#39;c&#39;: [1, 3, 5]},</span>
<span class="go">            ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                    a   b   c</span>
<span class="go">            tiger   1   2   1</span>
<span class="go">            zebra   2   3   3</span>
<span class="go">            cow     3   4   5</span>
<span class="go">            &gt;&gt;&gt; df.skew()</span>
<span class="go">            a   0.0</span>
<span class="go">            b   0.0</span>
<span class="go">            c   0.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df.skew(axis=1)</span>
<span class="go">            tiger   1.732051</span>
<span class="go">            zebra  -1.732051</span>
<span class="go">            cow     0.000000</span>
<span class="go">            dtype: float64</span>

<span class="go">            In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">            getting an error.</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;, &#39;X&#39;]},</span>
<span class="go">            ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.skew(numeric_only=True)</span>
<span class="go">            a   0.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 3])</span>
<span class="go">        &gt;&gt;&gt; s.skew()</span>
<span class="go">        0.0</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [2, 3, 4], &#39;c&#39;: [1, 3, 5]},</span>
<span class="go">        ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">                a   b   c</span>
<span class="go">        tiger   1   2   1</span>
<span class="go">        zebra   2   3   3</span>
<span class="go">        cow     3   4   5</span>
<span class="go">        &gt;&gt;&gt; df.skew()</span>
<span class="go">        a   0.0</span>
<span class="go">        b   0.0</span>
<span class="go">        c   0.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df.skew(axis=1)</span>
<span class="go">        tiger   1.732051</span>
<span class="go">        zebra  -1.732051</span>
<span class="go">        cow     0.000000</span>
<span class="go">        dtype: float64</span>

<span class="go">        In this case, `numeric_only` should be set to `True` to avoid</span>
<span class="go">        getting an error.</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 3], &#39;b&#39;: [&#39;T&#39;, &#39;Z&#39;, &#39;X&#39;]},</span>
<span class="go">        ...                  index=[&#39;tiger&#39;, &#39;zebra&#39;, &#39;cow&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.skew(numeric_only=True)</span>
<span class="go">        a   0.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.kurt">
<span class="sig-name descname"><span class="pre">kurt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.kurt" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased kurtosis over requested axis.</p>
<p>Kurtosis obtained using Fisher’s definition of
kurtosis (kurtosis of normal == 0.0). Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; s</span>
<span class="go">            cat    1</span>
<span class="go">            dog    2</span>
<span class="go">            dog    2</span>
<span class="go">            mouse  3</span>
<span class="go">            dtype: int64</span>
<span class="go">            &gt;&gt;&gt; s.kurt()</span>
<span class="go">            1.5</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">              cat  1   3</span>
<span class="go">              dog  2   4</span>
<span class="go">              dog  2   4</span>
<span class="go">            mouse  3   4</span>
<span class="go">            &gt;&gt;&gt; df.kurt()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   4.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            With axis=None</span>

<span class="go">            &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">            -0.988693</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">            cat   -6.0</span>
<span class="go">            dog   -6.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; s</span>
<span class="go">        cat    1</span>
<span class="go">        dog    2</span>
<span class="go">        dog    2</span>
<span class="go">        mouse  3</span>
<span class="go">        dtype: int64</span>
<span class="go">        &gt;&gt;&gt; s.kurt()</span>
<span class="go">        1.5</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">          cat  1   3</span>
<span class="go">          dog  2   4</span>
<span class="go">          dog  2   4</span>
<span class="go">        mouse  3   4</span>
<span class="go">        &gt;&gt;&gt; df.kurt()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   4.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        With axis=None</span>

<span class="go">        &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">        -0.988693</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">        cat   -6.0</span>
<span class="go">        dog   -6.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.kurtosis">
<span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.kurtosis" title="Link to this definition">¶</a></dt>
<dd><p>Return unbiased kurtosis over requested axis.</p>
<p>Kurtosis obtained using Fisher’s definition of
kurtosis (kurtosis of normal == 0.0). Normalized by N-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{index</em><em> (</em><em>0</em><em>)</em><em>, </em><em>columns</em><em> (</em><em>1</em><em>)</em><em>}</em>) – <p>Axis for the function to be applied on.
For <cite>DeferredSeries</cite> this parameter is unused and defaults to 0.</p>
<p>For DeferredDataFrames, specifying <code class="docutils literal notranslate"><span class="pre">axis=None</span></code> will apply the aggregation
across both axes.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values when computing the result.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Include only float, int, boolean columns. Not implemented for DeferredSeries.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to be passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series or scalar</p>
</dd>
</dl>
<p>Examples</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Series or scalar</span>

<span class="go">            Examples</span>
<span class="go">            --------</span>
<span class="go">            &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; s</span>
<span class="go">            cat    1</span>
<span class="go">            dog    2</span>
<span class="go">            dog    2</span>
<span class="go">            mouse  3</span>
<span class="go">            dtype: int64</span>
<span class="go">            &gt;&gt;&gt; s.kurt()</span>
<span class="go">            1.5</span>

<span class="go">            With a DataFrame</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">            &gt;&gt;&gt; df</span>
<span class="go">                   a   b</span>
<span class="go">              cat  1   3</span>
<span class="go">              dog  2   4</span>
<span class="go">              dog  2   4</span>
<span class="go">            mouse  3   4</span>
<span class="go">            &gt;&gt;&gt; df.kurt()</span>
<span class="go">            a   1.5</span>
<span class="go">            b   4.0</span>
<span class="go">            dtype: float64</span>

<span class="go">            With axis=None</span>

<span class="go">            &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">            -0.988693</span>

<span class="go">            Using axis=1</span>

<span class="go">            &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">            ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">            &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">            cat   -6.0</span>
<span class="go">            dog   -6.0</span>
<span class="go">            dtype: float64</span>


<span class="go">        --------</span>
<span class="go">        &gt;&gt;&gt; s = pd.Series([1, 2, 2, 3], index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; s</span>
<span class="go">        cat    1</span>
<span class="go">        dog    2</span>
<span class="go">        dog    2</span>
<span class="go">        mouse  3</span>
<span class="go">        dtype: int64</span>
<span class="go">        &gt;&gt;&gt; s.kurt()</span>
<span class="go">        1.5</span>

<span class="go">        With a DataFrame</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2, 2, 3], &#39;b&#39;: [3, 4, 4, 4]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;, &#39;dog&#39;, &#39;mouse&#39;])</span>
<span class="go">        &gt;&gt;&gt; df</span>
<span class="go">               a   b</span>
<span class="go">          cat  1   3</span>
<span class="go">          dog  2   4</span>
<span class="go">          dog  2   4</span>
<span class="go">        mouse  3   4</span>
<span class="go">        &gt;&gt;&gt; df.kurt()</span>
<span class="go">        a   1.5</span>
<span class="go">        b   4.0</span>
<span class="go">        dtype: float64</span>

<span class="go">        With axis=None</span>

<span class="go">        &gt;&gt;&gt; df.kurt(axis=None).round(6)</span>
<span class="go">        -0.988693</span>

<span class="go">        Using axis=1</span>

<span class="go">        &gt;&gt;&gt; df = pd.DataFrame({&#39;a&#39;: [1, 2], &#39;b&#39;: [3, 4], &#39;c&#39;: [3, 4], &#39;d&#39;: [1, 2]},</span>
<span class="go">        ...                   index=[&#39;cat&#39;, &#39;dog&#39;])</span>
<span class="go">        &gt;&gt;&gt; df.kurt(axis=1)</span>
<span class="go">        cat   -6.0</span>
<span class="go">        dog   -6.0</span>
<span class="go">        dtype: float64</span>
</pre></div>
</div>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.take">
<span class="sig-name descname"><span class="pre">take</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.take" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.take.html#pandas.DataFrame.take" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.take()</span></code></a> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_records">
<span class="sig-name descname"><span class="pre">to_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_records" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_records.html#pandas.DataFrame.to_records" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_records()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_dict" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_dict.html#pandas.DataFrame.to_dict" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_dict()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_numpy" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_numpy.html#pandas.DataFrame.to_numpy" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_numpy()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_string" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_string.html#pandas.DataFrame.to_string" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_string()</span></code></a> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_sparse">
<span class="sig-name descname"><span class="pre">to_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_sparse" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_sparse()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.transpose" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.transpose.html#pandas.DataFrame.transpose" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.transpose()</span></code></a> is not yet supported in the Beam DataFrame API because the columns in the output DataFrame depend on the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-columns">https://s.apache.org/dataframe-non-deferred-columns</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.T">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">T</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.T" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.T()</span></code> is not yet supported in the Beam DataFrame API because the columns in the output DataFrame depend on the data.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-columns">https://s.apache.org/dataframe-non-deferred-columns</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.update" title="Link to this definition">¶</a></dt>
<dd><p>Modify in place using non-NA values from another DataFrame.</p>
<p>Aligns on indices. There is no return value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a><em>, or </em><em>object coercible into a DeferredDataFrame</em>) – Should have at least one matching index/column label
with the original DeferredDataFrame. If a DeferredSeries is passed,
its name attribute must be set, and that will be
used as the column name to align with the original DeferredDataFrame.</p></li>
<li><p><strong>join</strong> (<em>{'left'}</em><em>, </em><em>default 'left'</em>) – Only left join is implemented, keeping the index and columns of the
original object.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – <p>How to handle non-NA values for overlapping keys:</p>
<ul>
<li><p>True: overwrite original DeferredDataFrame’s values
with values from <cite>other</cite>.</p></li>
<li><p>False: only update values that are NA in
the original DeferredDataFrame.</p></li>
</ul>
</p></li>
<li><p><strong>filter_func</strong> (<em>callable</em><em>(</em><em>1d-array</em><em>) </em><em>-&gt; bool 1d-array</em><em>, </em><em>optional</em>) – Can choose to replace values other than NA. Return True for values
that should be updated.</p></li>
<li><p><strong>errors</strong> (<em>{'raise'</em><em>, </em><em>'ignore'}</em><em>, </em><em>default 'ignore'</em>) – If ‘raise’, will raise a ValueError if the DeferredDataFrame and <cite>other</cite>
both contain non-NA data in the same place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This method directly changes calling object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>When <cite>errors=’raise’</cite> and there’s overlapping non-NA data.
    * When <cite>errors</cite> is not either <cite>‘ignore’</cite> or <cite>‘raise’</cite></p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – <ul>
<li><p>If <cite>join != ‘left’</cite></p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict.update" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict.update</span></code></a></dt><dd><p>Similar method for dictionaries.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.merge" title="apache_beam.dataframe.frames.DeferredDataFrame.merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.merge</span></code></a></dt><dd><p>For column(s)-on-column(s) operations.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  1  4</span>
<span class="go">1  2  5</span>
<span class="go">2  3  6</span>

<span class="go">The DataFrame&#39;s length does not increase as a result of the update,</span>
<span class="go">only values at matching index/column labels are updated.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  a  d</span>
<span class="go">1  b  e</span>
<span class="go">2  c  f</span>

<span class="go">For Series, its name attribute must be set.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_column</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_column</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  a  d</span>
<span class="go">1  b  y</span>
<span class="go">2  c  e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B</span>
<span class="go">0  a  x</span>
<span class="go">1  b  d</span>
<span class="go">2  c  e</span>

<span class="go">If `other` contains NaNs the corresponding values are not updated</span>
<span class="go">in the original dataframe.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A    B</span>
<span class="go">0  1    4</span>
<span class="go">1  2  500</span>
<span class="go">2  3    6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.values" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.values()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.style">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">style</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.style" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.style()</span></code> is not yet supported in the Beam DataFrame API because it produces an output type that is not deferred.</p>
<p>For more information see <a class="reference external" href="https://s.apache.org/dataframe-non-deferred-result">https://s.apache.org/dataframe-non-deferred-result</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.melt">
<span class="sig-name descname"><span class="pre">melt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.melt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.melt" title="Link to this definition">¶</a></dt>
<dd><p>Unpivot a DataFrame from wide to long format, optionally leaving identifiers set.</p>
<p>This function is useful to massage a DataFrame into a format where one
or more columns are identifier variables (<cite>id_vars</cite>), while all other
columns, considered measured variables (<cite>value_vars</cite>), are “unpivoted” to
the row axis, leaving just two non-identifier columns, ‘variable’ and
‘value’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, or </em><em>ndarray</em><em>, </em><em>optional</em>) – Column(s) to use as identifier variables.</p></li>
<li><p><strong>value_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, or </em><em>ndarray</em><em>, </em><em>optional</em>) – Column(s) to unpivot. If not specified, uses all columns that
are not set as <cite>id_vars</cite>.</p></li>
<li><p><strong>var_name</strong> (<em>scalar</em>) – Name to use for the ‘variable’ column. If None it uses
<code class="docutils literal notranslate"><span class="pre">frame.columns.name</span></code> or ‘variable’.</p></li>
<li><p><strong>value_name</strong> (<em>scalar</em><em>, </em><em>default 'value'</em>) – Name to use for the ‘value’ column.</p></li>
<li><p><strong>col_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – If columns are a MultiIndex then use this level to melt.</p></li>
<li><p><strong>ignore_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – If True, original index is ignored. If False, the original index is retained.
Index labels will be repeated as necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unpivoted DeferredDataFrame.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> is not supported, because it requires generating an
order-sensitive index.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.melt" title="apache_beam.dataframe.frames.DeferredDataFrame.melt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">melt</span></code></a></dt><dd><p>Identical method.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot_table" title="apache_beam.dataframe.frames.DeferredDataFrame.pivot_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pivot_table</span></code></a></dt><dd><p>Create a spreadsheet-style pivot table as a DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot" title="apache_beam.dataframe.frames.DeferredDataFrame.pivot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pivot</span></code></a></dt><dd><p>Return reshaped DeferredDataFrame organized by given index / column values.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.explode" title="apache_beam.dataframe.frames.DeferredDataFrame.explode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.explode</span></code></a></dt><dd><p>Explode a DeferredDataFrame from list-like columns to long format.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Reference <a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/reshaping.html#reshaping-melt" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more examples.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">},</span>
<span class="gp">... </span>                   <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
<span class="gp">... </span>                   <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">6</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B  C</span>
<span class="go">0  a  1  2</span>
<span class="go">1  b  3  4</span>
<span class="go">2  c  5  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="go">   A variable  value</span>
<span class="go">0  a        B      1</span>
<span class="go">1  b        B      3</span>
<span class="go">2  c        B      5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="go">   A variable  value</span>
<span class="go">0  a        B      1</span>
<span class="go">1  b        B      3</span>
<span class="go">2  c        B      5</span>
<span class="go">3  a        C      2</span>
<span class="go">4  b        C      4</span>
<span class="go">5  c        C      6</span>

<span class="go">The names of &#39;variable&#39; and &#39;value&#39; columns can be customized:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;myVarname&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;myValname&#39;</span><span class="p">)</span>
<span class="go">   A myVarname  myValname</span>
<span class="go">0  a         B          1</span>
<span class="go">1  b         B          3</span>
<span class="go">2  c         B          5</span>

<span class="go">Original index values can be kept around:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">   A variable  value</span>
<span class="go">0  a        B      1</span>
<span class="go">1  b        B      3</span>
<span class="go">2  c        B      5</span>
<span class="go">0  a        C      2</span>
<span class="go">1  b        C      4</span>
<span class="go">2  c        C      6</span>

<span class="go">If you have multi-index columns:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;DEF&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   A  B  C</span>
<span class="go">   D  E  F</span>
<span class="go">0  a  1  2</span>
<span class="go">1  b  3  4</span>
<span class="go">2  c  5  6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">col_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="go">   A variable  value</span>
<span class="go">0  a        B      1</span>
<span class="go">1  b        B      3</span>
<span class="go">2  c        B      5</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)],</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="go">  (A, D) variable_0 variable_1  value</span>
<span class="go">0      a          B          E      1</span>
<span class="go">1      b          B          E      3</span>
<span class="go">2      c          B          E      5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.value_counts">
<span class="sig-name descname"><span class="pre">value_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropna</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.value_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.value_counts" title="Link to this definition">¶</a></dt>
<dd><p>Return a Series containing the frequency of each distinct row in the Dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subset</strong> (<em>label</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>labels</em><em>, </em><em>optional</em>) – Columns to use when counting unique combinations.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Return proportions rather than frequencies.</p></li>
<li><p><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Sort by frequencies when True. Sort by DeferredDataFrame column values when False.</p></li>
<li><p><strong>ascending</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Sort in ascending order.</p></li>
<li><p><strong>dropna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – <p>Don’t include counts of rows that contain NA values.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.3.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p><code class="docutils literal notranslate"><span class="pre">sort</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default, and <code class="docutils literal notranslate"><span class="pre">sort=True</span></code> is not supported
because it imposes an ordering on the dataset which likely will not be
preserved.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.value_counts" title="apache_beam.dataframe.frames.DeferredSeries.value_counts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.value_counts</span></code></a></dt><dd><p>Equivalent method on DeferredSeries.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The returned DeferredSeries will have a MultiIndex with one level per input
column but an Index (non-multi) for a single label. By default, rows
that contain any NA values are omitted from the result. By default,
the resulting DeferredSeries will be in descending order so that the first
element is the most frequently-occurring row.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;num_legs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;num_wings&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;ant&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        num_legs  num_wings</span>
<span class="go">falcon         2          2</span>
<span class="go">dog            4          0</span>
<span class="go">cat            4          0</span>
<span class="go">ant            6          0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="go">num_legs  num_wings</span>
<span class="go">4         0            2</span>
<span class="go">2         2            1</span>
<span class="go">6         0            1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">num_legs  num_wings</span>
<span class="go">2         2            1</span>
<span class="go">4         0            2</span>
<span class="go">6         0            1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">num_legs  num_wings</span>
<span class="go">2         2            1</span>
<span class="go">6         0            1</span>
<span class="go">4         0            2</span>
<span class="go">Name: count, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">num_legs  num_wings</span>
<span class="go">4         0            0.50</span>
<span class="go">2         2            0.25</span>
<span class="go">6         0            0.25</span>
<span class="go">Name: proportion, dtype: float64</span>

<span class="go">With `dropna` set to `False` we can also count rows with NA values.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Anne&#39;</span><span class="p">,</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Beth&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;middle_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Smith&#39;</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span><span class="p">,</span> <span class="s1">&#39;Louise&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  first_name middle_name</span>
<span class="go">0       John       Smith</span>
<span class="go">1       Anne        &lt;NA&gt;</span>
<span class="go">2       John        &lt;NA&gt;</span>
<span class="go">3       Beth      Louise</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="go">first_name  middle_name</span>
<span class="go">Beth        Louise         1</span>
<span class="go">John        Smith          1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">first_name  middle_name</span>
<span class="go">Anne        NaN            1</span>
<span class="go">Beth        Louise         1</span>
<span class="go">John        Smith          1</span>
<span class="go">            NaN            1</span>
<span class="go">Name: count, dtype: int64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span>
<span class="go">first_name</span>
<span class="go">John    2</span>
<span class="go">Anne    1</span>
<span class="go">Beth    1</span>
<span class="go">Name: count, dtype: int64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.compare" title="Link to this definition">¶</a></dt>
<dd><p>Compare to another DataFrame and show the differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Object to compare with.</p></li>
<li><p><strong>align_axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 1</em>) – <p>Determine which axis to align the comparison on.</p>
<ul>
<li><dl class="simple">
<dt>0, or ‘index’<span class="classifier">Resulting differences are stacked vertically</span></dt><dd><p>with rows drawn alternately from self and other.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>1, or ‘columns’<span class="classifier">Resulting differences are aligned horizontally</span></dt><dd><p>with columns drawn alternately from self and other.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>keep_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If true, all rows and columns are kept.
Otherwise, only the ones with different values are kept.</p></li>
<li><p><strong>keep_equal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If true, the result keeps values that are equal.
Otherwise, equal values are shown as NaNs.</p></li>
<li><p><strong>result_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>default</em><em> (</em><em>'self'</em><em>, </em><em>'other'</em><em>)</em>) – <p>Set the dataframes names in the comparison.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>DeferredDataFrame that shows the differences stacked side by side.</p>
<p>The resulting index will be a MultiIndex with ‘self’ and ‘other’
stacked alternately at the inner level.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – When the two DeferredDataFrames don’t have identical labels or shape.</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>The default values <code class="docutils literal notranslate"><span class="pre">align_axis=1</span> <span class="pre">and</span> <span class="pre">``keep_shape=False</span></code>
are not supported, because the output columns depend on the data.
To use <code class="docutils literal notranslate"><span class="pre">align_axis=1</span></code>, please specify <code class="docutils literal notranslate"><span class="pre">keep_shape=True</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.compare" title="apache_beam.dataframe.frames.DeferredSeries.compare"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.compare</span></code></a></dt><dd><p>Compare with another DeferredSeries and show differences.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.equals</span></code></dt><dd><p>Test whether two objects contain the same elements.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Matching NaNs will not appear as a difference.</p>
<p>Can only compare identically-labeled
(i.e. same shape, identical row and column labels) DeferredDataFrames</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;col2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;col3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  col1  col2  col3</span>
<span class="go">0    a   1.0   1.0</span>
<span class="go">1    a   2.0   2.0</span>
<span class="go">2    b   3.0   3.0</span>
<span class="go">3    b   NaN   4.0</span>
<span class="go">4    a   5.0   5.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;col1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;c&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;col3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span>
<span class="go">  col1  col2  col3</span>
<span class="go">0    c   1.0   1.0</span>
<span class="go">1    a   2.0   2.0</span>
<span class="go">2    b   3.0   4.0</span>
<span class="go">3    b   NaN   4.0</span>
<span class="go">4    a   5.0   5.0</span>

<span class="go">Align the differences on columns</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="go">  col1       col3</span>
<span class="go">  self other self other</span>
<span class="go">0    a     c  NaN   NaN</span>
<span class="go">2  NaN   NaN  3.0   4.0</span>

<span class="go">Assign result_names</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">result_names</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">))</span>
<span class="go">  col1       col3</span>
<span class="go">  left right left right</span>
<span class="go">0    a     c  NaN   NaN</span>
<span class="go">2  NaN   NaN  3.0   4.0</span>

<span class="go">Stack the differences on rows</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">align_axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">        col1  col3</span>
<span class="go">0 self     a   NaN</span>
<span class="go">  other    c   NaN</span>
<span class="go">2 self   NaN   3.0</span>
<span class="go">  other  NaN   4.0</span>

<span class="go">Keep the equal values</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">keep_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  col1       col3</span>
<span class="go">  self other self other</span>
<span class="go">0    a     c  1.0   1.0</span>
<span class="go">2    b     b  3.0   4.0</span>

<span class="go">Keep all original rows and columns</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">keep_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  col1       col2       col3</span>
<span class="go">  self other self other self other</span>
<span class="go">0    a     c  NaN   NaN  NaN   NaN</span>
<span class="go">1  NaN   NaN  NaN   NaN  NaN   NaN</span>
<span class="go">2  NaN   NaN  NaN   NaN  3.0   4.0</span>
<span class="go">3  NaN   NaN  NaN   NaN  NaN   NaN</span>
<span class="go">4  NaN   NaN  NaN   NaN  NaN   NaN</span>

<span class="go">Keep all original rows and columns and also all original values</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">keep_shape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_equal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">  col1       col2       col3</span>
<span class="go">  self other self other self other</span>
<span class="go">0    a     c  1.0   1.0  1.0   1.0</span>
<span class="go">1    a     a  2.0   2.0  2.0   2.0</span>
<span class="go">2    b     b  3.0   3.0  3.0   4.0</span>
<span class="go">3    b     b  NaN   NaN  4.0   4.0</span>
<span class="go">4    a     a  5.0   5.0  5.0   5.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.idxmin">
<span class="sig-name descname"><span class="pre">idxmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.idxmin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmin" title="Link to this definition">¶</a></dt>
<dd><p>Return index of first occurrence of minimum over requested axis.</p>
<p>NA/null values are excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to use. 0 or ‘index’ for row-wise, 1 or ‘columns’ for column-wise.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Indexes of minima along the specified axis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If the row/column is empty</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmin" title="apache_beam.dataframe.frames.DeferredSeries.idxmin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmin</span></code></a></dt><dd><p>Return index of the minimum element.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method is the DeferredDataFrame version of <code class="docutils literal notranslate"><span class="pre">ndarray.argmin</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Consider a dataset containing food consumption in Argentina.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;consumption&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.51</span><span class="p">,</span> <span class="mf">103.11</span><span class="p">,</span> <span class="mf">55.48</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="s1">&#39;co2_emissions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">37.2</span><span class="p">,</span> <span class="mf">19.66</span><span class="p">,</span> <span class="mi">1712</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pork&#39;</span><span class="p">,</span> <span class="s1">&#39;Wheat Products&#39;</span><span class="p">,</span> <span class="s1">&#39;Beef&#39;</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">                consumption  co2_emissions</span>
<span class="go">Pork                  10.51         37.20</span>
<span class="go">Wheat Products       103.11         19.66</span>
<span class="go">Beef                  55.48       1712.00</span>

<span class="go">By default, it returns the index for the minimum value in each column.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="go">consumption                Pork</span>
<span class="go">co2_emissions    Wheat Products</span>
<span class="go">dtype: object</span>

<span class="go">To return the index for the minimum value in each row, use ``axis=&quot;columns&quot;``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="go">Pork                consumption</span>
<span class="go">Wheat Products    co2_emissions</span>
<span class="go">Beef                consumption</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.idxmax">
<span class="sig-name descname"><span class="pre">idxmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/apache_beam/dataframe/frames.html#DeferredDataFrame.idxmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.idxmax" title="Link to this definition">¶</a></dt>
<dd><p>Return index of first occurrence of maximum over requested axis.</p>
<p>NA/null values are excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 0</em>) – The axis to use. 0 or ‘index’ for row-wise, 1 or ‘columns’ for column-wise.</p></li>
<li><p><strong>skipna</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Exclude NA/null values. If an entire row/column is NA, the result
will be NA.</p></li>
<li><p><strong>numeric_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – <p>Include only <cite>float</cite>, <cite>int</cite> or <cite>boolean</cite> data.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Indexes of maxima along the specified axis.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries">DeferredSeries</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>If the row/column is empty</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries.idxmax" title="apache_beam.dataframe.frames.DeferredSeries.idxmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredSeries.idxmax</span></code></a></dt><dd><p>Return index of the maximum element.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This method is the DeferredDataFrame version of <code class="docutils literal notranslate"><span class="pre">ndarray.argmax</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Consider a dataset containing food consumption in Argentina.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;consumption&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.51</span><span class="p">,</span> <span class="mf">103.11</span><span class="p">,</span> <span class="mf">55.48</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="s1">&#39;co2_emissions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">37.2</span><span class="p">,</span> <span class="mf">19.66</span><span class="p">,</span> <span class="mi">1712</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Pork&#39;</span><span class="p">,</span> <span class="s1">&#39;Wheat Products&#39;</span><span class="p">,</span> <span class="s1">&#39;Beef&#39;</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">                consumption  co2_emissions</span>
<span class="go">Pork                  10.51         37.20</span>
<span class="go">Wheat Products       103.11         19.66</span>
<span class="go">Beef                  55.48       1712.00</span>

<span class="go">By default, it returns the index for the maximum value in each column.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="go">consumption     Wheat Products</span>
<span class="go">co2_emissions             Beef</span>
<span class="go">dtype: object</span>

<span class="go">To return the index for the maximum value in each row, use ``axis=&quot;columns&quot;``.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="go">Pork              co2_emissions</span>
<span class="go">Wheat Products     consumption</span>
<span class="go">Beef              co2_emissions</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="Link to this definition">¶</a></dt>
<dd><p>Get Addition of dataframe and other, element-wise (binary operator <cite>add</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">+</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>radd</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.apply" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.apply.html#pandas.DataFrame.apply" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.apply()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘apply’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.asfreq">
<span class="sig-name descname"><span class="pre">asfreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.asfreq" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.asfreq.html#pandas.DataFrame.asfreq" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.asfreq()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘asfreq’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.at">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">at</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.at" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.at()</span></code> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘at’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.boxplot">
<span class="sig-name descname"><span class="pre">boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.boxplot" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.boxplot.html#pandas.DataFrame.boxplot" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.boxplot()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘boxplot’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.convert_dtypes">
<span class="sig-name descname"><span class="pre">convert_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.convert_dtypes" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.convert_dtypes.html#pandas.DataFrame.convert_dtypes" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.convert_dtypes()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘convert_dtypes’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.div">
<span class="sig-name descname"><span class="pre">div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="Link to this definition">¶</a></dt>
<dd><p>Get Floating division of dataframe and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rtruediv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.divide">
<span class="sig-name descname"><span class="pre">divide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.divide" title="Link to this definition">¶</a></dt>
<dd><p>Get Floating division of dataframe and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rtruediv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.eq">
<span class="sig-name descname"><span class="pre">eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="Link to this definition">¶</a></dt>
<dd><p>Get Equal to of dataframe and other, element-wise (binary operator <cite>eq</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.filter" title="Link to this definition">¶</a></dt>
<dd><p>Subset the dataframe rows or columns according to the specified index labels.</p>
<p>Note that this routine does not filter a dataframe on its
contents. The filter is applied to the labels of the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>list-like</em>) – Keep labels from axis which are in items.</p></li>
<li><p><strong>like</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Keep labels from axis for which “like in label == True”.</p></li>
<li><p><strong>regex</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> (</em><em>regular expression</em><em>)</em>) – Keep labels from axis for which re.search(regex, label) == True.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'</em><em>, </em><em>None}</em><em>, </em><em>default None</em>) – The axis to filter on, expressed either as an index (int)
or axis name (str). By default this is the info axis, ‘columns’ for
DeferredDataFrame. For <cite>DeferredSeries</cite> this parameter is unused and defaults to <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>same type as input object</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.loc</span></code></dt><dd><p>Access a group of rows and columns by label(s) or a boolean array.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">items</span></code>, <code class="docutils literal notranslate"><span class="pre">like</span></code>, and <code class="docutils literal notranslate"><span class="pre">regex</span></code> parameters are
enforced to be mutually exclusive.</p>
<p><code class="docutils literal notranslate"><span class="pre">axis</span></code> defaults to the info axis that is used when indexing
with <code class="docutils literal notranslate"><span class="pre">[]</span></code>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])),</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mouse&#39;</span><span class="p">,</span> <span class="s1">&#39;rabbit&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">        one  two  three</span>
<span class="go">mouse     1    2      3</span>
<span class="go">rabbit    4    5      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select columns by name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">items</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="go">         one  three</span>
<span class="go">mouse     1      3</span>
<span class="go">rabbit    4      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select columns by regular expression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="s1">&#39;e$&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">         one  three</span>
<span class="go">mouse     1      3</span>
<span class="go">rabbit    4      6</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># select rows containing &#39;bbi&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="s1">&#39;bbi&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">         one  two  three</span>
<span class="go">rabbit    4    5      6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.flags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flags</span></span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.flags" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.flags()</span></code> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘flags’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.floordiv">
<span class="sig-name descname"><span class="pre">floordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="Link to this definition">¶</a></dt>
<dd><p>Get Integer division of dataframe and other, element-wise (binary operator <cite>floordiv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">//</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rfloordiv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.ge">
<span class="sig-name descname"><span class="pre">ge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="Link to this definition">¶</a></dt>
<dd><p>Get Greater than or equal to of dataframe and other, element-wise (binary operator <cite>ge</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.gt">
<span class="sig-name descname"><span class="pre">gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="Link to this definition">¶</a></dt>
<dd><p>Get Greater than of dataframe and other, element-wise (binary operator <cite>gt</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.infer_objects">
<span class="sig-name descname"><span class="pre">infer_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.infer_objects" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.infer_objects.html#pandas.DataFrame.infer_objects" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.infer_objects()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘infer_objects’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.isetitem">
<span class="sig-name descname"><span class="pre">isetitem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.isetitem" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.isetitem.html#pandas.DataFrame.isetitem" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.isetitem()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘isetitem’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.le">
<span class="sig-name descname"><span class="pre">le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="Link to this definition">¶</a></dt>
<dd><p>Get Less than or equal to of dataframe and other, element-wise (binary operator <cite>le</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.lt">
<span class="sig-name descname"><span class="pre">lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="Link to this definition">¶</a></dt>
<dd><p>Get Less than of dataframe and other, element-wise (binary operator <cite>lt</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.mod">
<span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="Link to this definition">¶</a></dt>
<dd><p>Get Modulo of dataframe and other, element-wise (binary operator <cite>mod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">%</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rmod</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.mul">
<span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="Link to this definition">¶</a></dt>
<dd><p>Get Multiplication of dataframe and other, element-wise (binary operator <cite>mul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">*</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rmul</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.multiply">
<span class="sig-name descname"><span class="pre">multiply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.multiply" title="Link to this definition">¶</a></dt>
<dd><p>Get Multiplication of dataframe and other, element-wise (binary operator <cite>mul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">*</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rmul</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.ne">
<span class="sig-name descname"><span class="pre">ne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="Link to this definition">¶</a></dt>
<dd><p>Get Not equal to of dataframe and other, element-wise (binary operator <cite>ne</cite>).</p>
<p>Among flexible wrappers (<cite>eq</cite>, <cite>ne</cite>, <cite>le</cite>, <cite>lt</cite>, <cite>ge</cite>, <cite>gt</cite>) to comparison
operators.</p>
<p>Equivalent to <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite> with support to choose axis
(rows or columns) and level for comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em><em>, </em><em>default 'columns'</em>) – Whether to compare by the index (0 or ‘index’) or columns
(1 or ‘columns’).</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the passed
MultiIndex level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the comparison.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.eq" title="apache_beam.dataframe.frames.DeferredDataFrame.eq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.eq</span></code></a></dt><dd><p>Compare DeferredDataFrames for equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ne" title="apache_beam.dataframe.frames.DeferredDataFrame.ne"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ne</span></code></a></dt><dd><p>Compare DeferredDataFrames for inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.le" title="apache_beam.dataframe.frames.DeferredDataFrame.le"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.le</span></code></a></dt><dd><p>Compare DeferredDataFrames for less than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.lt" title="apache_beam.dataframe.frames.DeferredDataFrame.lt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.lt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly less than inequality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.ge" title="apache_beam.dataframe.frames.DeferredDataFrame.ge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.ge</span></code></a></dt><dd><p>Compare DeferredDataFrames for greater than inequality or equality elementwise.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.gt" title="apache_beam.dataframe.frames.DeferredDataFrame.gt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.gt</span></code></a></dt><dd><p>Compare DeferredDataFrames for strictly greater than inequality elementwise.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.
<cite>NaN</cite> values are considered different (i.e. <cite>NaN</cite> != <cite>NaN</cite>).</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">   cost  revenue</span>
<span class="go">A   250      100</span>
<span class="go">B   150      250</span>
<span class="go">C   100      300</span>

<span class="go">Comparison with a scalar, using either the operator or method:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="mi">100</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False     True</span>
<span class="go">B  False    False</span>
<span class="go">C   True    False</span>

<span class="go">When `other` is a :class:`Series`, the columns of a DataFrame are aligned</span>
<span class="go">with the index of `other` and broadcast:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">!=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;cost&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue&quot;</span><span class="p">])</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B   True    False</span>
<span class="go">C  False     True</span>

<span class="go">Use the method to control the broadcast axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">   cost  revenue</span>
<span class="go">A  True    False</span>
<span class="go">B  True     True</span>
<span class="go">C  True     True</span>
<span class="go">D  True     True</span>

<span class="go">When comparing to an arbitrary sequence, the number of columns must</span>
<span class="go">match the number elements in `other`:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">==</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True     True</span>
<span class="go">B  False    False</span>
<span class="go">C  False    False</span>

<span class="go">Use the method to control the axis:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">eq</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A   True    False</span>
<span class="go">B  False     True</span>
<span class="go">C   True    False</span>

<span class="go">Compare to a DataFrame of different shape.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">   revenue</span>
<span class="go">A      300</span>
<span class="go">B      250</span>
<span class="go">C      100</span>
<span class="go">D      150</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
<span class="go">    cost  revenue</span>
<span class="go">A  False    False</span>
<span class="go">B  False    False</span>
<span class="go">C  False     True</span>
<span class="go">D  False    False</span>

<span class="go">Compare to a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;revenue&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">225</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q1&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">      cost  revenue</span>
<span class="go">Q1 A   250      100</span>
<span class="go">   B   150      250</span>
<span class="go">   C   100      300</span>
<span class="go">Q2 A   150      200</span>
<span class="go">   B   300      175</span>
<span class="go">   C   220      225</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">       cost  revenue</span>
<span class="go">Q1 A   True     True</span>
<span class="go">   B   True     True</span>
<span class="go">   C   True     True</span>
<span class="go">Q2 A  False     True</span>
<span class="go">   B   True    False</span>
<span class="go">   C   True    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.pivot_table">
<span class="sig-name descname"><span class="pre">pivot_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.pivot_table" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.pivot_table.html#pandas.DataFrame.pivot_table" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.pivot_table()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘pivot_table’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.pow">
<span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="Link to this definition">¶</a></dt>
<dd><p>Get Exponential power of dataframe and other, element-wise (binary operator <cite>pow</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">**</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rpow</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.radd">
<span class="sig-name descname"><span class="pre">radd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.radd" title="Link to this definition">¶</a></dt>
<dd><p>Get Addition of dataframe and other, element-wise (binary operator <cite>radd</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">+</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>add</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rank">
<span class="sig-name descname"><span class="pre">rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rank" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.rank.html#pandas.DataFrame.rank" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.rank()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘rank’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rdiv">
<span class="sig-name descname"><span class="pre">rdiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rdiv" title="Link to this definition">¶</a></dt>
<dd><p>Get Floating division of dataframe and other, element-wise (binary operator <cite>rtruediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">/</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>truediv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.reindex_like">
<span class="sig-name descname"><span class="pre">reindex_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.reindex_like" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.reindex_like.html#pandas.DataFrame.reindex_like" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.reindex_like()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘reindex_like’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rfloordiv">
<span class="sig-name descname"><span class="pre">rfloordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rfloordiv" title="Link to this definition">¶</a></dt>
<dd><p>Get Integer division of dataframe and other, element-wise (binary operator <cite>rfloordiv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">//</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>floordiv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rmod">
<span class="sig-name descname"><span class="pre">rmod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rmod" title="Link to this definition">¶</a></dt>
<dd><p>Get Modulo of dataframe and other, element-wise (binary operator <cite>rmod</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">%</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>mod</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rmul">
<span class="sig-name descname"><span class="pre">rmul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rmul" title="Link to this definition">¶</a></dt>
<dd><p>Get Multiplication of dataframe and other, element-wise (binary operator <cite>rmul</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">*</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>mul</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rpow">
<span class="sig-name descname"><span class="pre">rpow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rpow" title="Link to this definition">¶</a></dt>
<dd><p>Get Exponential power of dataframe and other, element-wise (binary operator <cite>rpow</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">**</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>pow</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rsub">
<span class="sig-name descname"><span class="pre">rsub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rsub" title="Link to this definition">¶</a></dt>
<dd><p>Get Subtraction of dataframe and other, element-wise (binary operator <cite>rsub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">-</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>sub</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.rtruediv">
<span class="sig-name descname"><span class="pre">rtruediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.rtruediv" title="Link to this definition">¶</a></dt>
<dd><p>Get Floating division of dataframe and other, element-wise (binary operator <cite>rtruediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">other</span> <span class="pre">/</span> <span class="pre">dataframe</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>truediv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.set_flags">
<span class="sig-name descname"><span class="pre">set_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.set_flags" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.set_flags.html#pandas.DataFrame.set_flags" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.set_flags()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘set_flags’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.squeeze">
<span class="sig-name descname"><span class="pre">squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.squeeze" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.squeeze.html#pandas.DataFrame.squeeze" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.squeeze()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘squeeze’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.sub">
<span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="Link to this definition">¶</a></dt>
<dd><p>Get Subtraction of dataframe and other, element-wise (binary operator <cite>sub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">-</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rsub</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.subtract">
<span class="sig-name descname"><span class="pre">subtract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.subtract" title="Link to this definition">¶</a></dt>
<dd><p>Get Subtraction of dataframe and other, element-wise (binary operator <cite>sub</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">-</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rsub</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_clipboard">
<span class="sig-name descname"><span class="pre">to_clipboard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_clipboard" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_clipboard.html#pandas.DataFrame.to_clipboard" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_clipboard()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_clipboard’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_csv">
<span class="sig-name descname"><span class="pre">to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="Link to this definition">¶</a></dt>
<dd><p>Write object to a comma-separated values (csv) file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_or_buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – <p>String, path object (implementing os.PathLike[str]), or file-like
object implementing a write() function. If None, the result is
returned as a string. If a non-binary file object is passed, it should
be opened with <cite>newline=’’</cite>, disabling universal newlines. If a binary
file object is passed, <cite>mode</cite> might need to contain a <cite>‘b’</cite>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Support for binary file objects was introduced.</p>
</div>
</p></li>
<li><p><strong>sep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '</em><em>,</em><em>'</em>) – String of length 1. Field delimiter for the output file.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Missing data representation.</p></li>
<li><p><strong>float_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Callable</em><em>, </em><em>default None</em>) – Format string for floating point numbers. If a Callable is given, it takes
precedence over other numeric formatting parameters, like decimal.</p></li>
<li><p><strong>columns</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Columns to write.</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default True</em>) – Write out the column names. If a list of strings is given it is
assumed to be aliases for the column names.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write row names (index).</p></li>
<li><p><strong>index_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>sequence</em><em>, or </em><em>False</em><em>, </em><em>default None</em>) – Column label for index column(s) if desired. If None is given, and
<cite>header</cite> and <cite>index</cite> are True, then the index names are used. A
sequence should be given if the object uses MultiIndex. If
False do not print fields for index names. Use index_label=False
for easier importing in R.</p></li>
<li><p><strong>mode</strong> (<em>{'w'</em><em>, </em><em>'x'</em><em>, </em><em>'a'}</em><em>, </em><em>default 'w'</em>) – <p>Forwarded to either <cite>open(mode=)</cite> or <cite>fsspec.open(mode=)</cite> to control
the file opening. Typical values include:</p>
<ul>
<li><p>’w’, truncate the file first.</p></li>
<li><p>’x’, exclusive creation, failing if the file already exists.</p></li>
<li><p>’a’, append to the end of file if it exists.</p></li>
</ul>
</p></li>
<li><p><strong>encoding</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A string representing the encoding to use in the output file,
defaults to ‘utf-8’. <cite>encoding</cite> is not supported if <cite>path_or_buf</cite>
is a non-binary file object.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path_or_buf’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
<p>May be a dict with key ‘method’ as compression mode
and other entries as additional compression options if
compression mode is ‘zip’.</p>
<p>Passing compression options as keys in dict is
supported for compression modes ‘gzip’, ‘bz2’, ‘zstd’, and ‘zip’.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Compression is supported for binary file objects.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0: </span>Previous versions forwarded dict entries for ‘gzip’ to
<cite>gzip.open</cite> instead of <cite>gzip.GzipFile</cite> which prevented
setting <cite>mtime</cite>.</p>
</div>
</p></li>
<li><p><strong>quoting</strong> (<em>optional constant from csv module</em>) – Defaults to csv.QUOTE_MINIMAL. If you have set a <cite>float_format</cite>
then floats are converted to strings and thus csv.QUOTE_NONNUMERIC
will treat them as non-numeric.</p></li>
<li><p><strong>quotechar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '&quot;'</em>) – String of length 1. Character used to quote fields.</p></li>
<li><p><strong>lineterminator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – <p>The newline character or character sequence to use in the output
file. Defaults to <cite>os.linesep</cite>, which depends on the OS in which
this method is called (’\n’ for linux, ‘\r\n’ for Windows, i.e.).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.5.0: </span>Previously was line_terminator, changed for consistency with
read_csv and the standard library ‘csv’ module.</p>
</div>
</p></li>
<li><p><strong>chunksize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>None</em>) – Rows to write at a time.</p></li>
<li><p><strong>date_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – Format string for datetime objects.</p></li>
<li><p><strong>doublequote</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Control quoting of <cite>quotechar</cite> inside a field.</p></li>
<li><p><strong>escapechar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – String of length 1. Character used to escape <cite>sep</cite> and <cite>quotechar</cite>
when appropriate.</p></li>
<li><p><strong>decimal</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '.'</em>) – Character recognized as decimal separator. E.g. use ‘,’ for
European data.</p></li>
<li><p><strong>errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'strict'</em>) – Specifies how encoding and decoding errors are to be handled.
See the errors argument for <a class="reference external" href="https://docs.python.org/3/library/functions.html#open" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> for a full list
of options.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If path_or_buf is None, returns the resulting csv format as a
string. Otherwise returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_csv</span></code></dt><dd><p>Load a CSV file into a DeferredDataFrame.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_excel" title="apache_beam.dataframe.frames.DeferredDataFrame.to_excel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_excel</span></code></a></dt><dd><p>Write DeferredDataFrame to an Excel file.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Raphael&#39;</span><span class="p">,</span> <span class="s1">&#39;Donatello&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;mask&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;weapon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sai&#39;</span><span class="p">,</span> <span class="s1">&#39;bo staff&#39;</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;name,mask,weapon\nRaphael,red,sai\nDonatello,purple,bo staff\n&#39;</span>

<span class="go">Create &#39;out.zip&#39; containing &#39;out.csv&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">compression_opts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;zip&#39;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">archive_name</span><span class="o">=</span><span class="s1">&#39;out.csv&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;out.zip&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">compression</span><span class="o">=</span><span class="n">compression_opts</span><span class="p">)</span>  

<span class="go">To write a csv file to a new folder or nested folder you will first</span>
<span class="go">need to create it using either Pathlib or os:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;folder/subfolder/out.csv&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>  

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;folder/subfolder&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;folder/subfolder/out.csv&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_excel">
<span class="sig-name descname"><span class="pre">to_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_excel" title="Link to this definition">¶</a></dt>
<dd><p>Write object to an Excel sheet.</p>
<p>To write a single object to an Excel .xlsx file it is only necessary to
specify a target file name. To write to multiple sheets it is necessary to
create an <cite>ExcelWriter</cite> object with a target file name, and specify a sheet
in the file to write to.</p>
<p>Multiple sheets may be written to by specifying unique <cite>sheet_name</cite>.
With all data written to the file it is necessary to save the changes.
Note that creating an <cite>ExcelWriter</cite> object with a file name that already
exists will result in the contents of the existing file being erased.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>excel_writer</strong> (<em>path-like</em><em>, </em><em>file-like</em><em>, or </em><em>ExcelWriter object</em>) – File path or existing ExcelWriter.</p></li>
<li><p><strong>sheet_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'Sheet1'</em>) – Name of sheet which will contain DeferredDataFrame.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default ''</em>) – Missing data representation.</p></li>
<li><p><strong>float_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Format string for floating point numbers. For example
<code class="docutils literal notranslate"><span class="pre">float_format=&quot;%.2f&quot;</span></code> will format 0.1234 to 0.12.</p></li>
<li><p><strong>columns</strong> (<em>sequence</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Columns to write.</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default True</em>) – Write out the column names. If a list of string is given it is
assumed to be aliases for the column names.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write row names (index).</p></li>
<li><p><strong>index_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Column label for index column(s) if desired. If not specified, and
<cite>header</cite> and <cite>index</cite> are True, then the index names are used. A
sequence should be given if the DeferredDataFrame uses MultiIndex.</p></li>
<li><p><strong>startrow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – Upper left cell row to dump data frame.</p></li>
<li><p><strong>startcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 0</em>) – Upper left cell column to dump data frame.</p></li>
<li><p><strong>engine</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Write engine to use, ‘openpyxl’ or ‘xlsxwriter’. You can also set this
via the options <code class="docutils literal notranslate"><span class="pre">io.excel.xlsx.writer</span></code> or
<code class="docutils literal notranslate"><span class="pre">io.excel.xlsm.writer</span></code>.</p></li>
<li><p><strong>merge_cells</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Write MultiIndex and Hierarchical Rows as merged cells.</p></li>
<li><p><strong>inf_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'inf'</em>) – Representation for infinity (there is no native representation for
infinity in Excel).</p></li>
<li><p><strong>freeze_panes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> (</em><em>length 2</em><em>)</em><em>, </em><em>optional</em>) – Specifies the one-based bottommost row and rightmost column that
is to be frozen.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>engine_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Arbitrary keyword arguments passed to excel engine.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="apache_beam.dataframe.frames.DeferredDataFrame.to_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_csv</span></code></a></dt><dd><p>Write DeferredDataFrame to a comma-separated values (csv) file.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ExcelWriter</span></code></dt><dd><p>Class for writing DeferredDataFrame objects into excel sheets.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_excel</span></code></dt><dd><p>Read an Excel file into a pandas DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_csv</span></code></dt><dd><p>Read a comma-separated values (csv) file into DeferredDataFrame.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.formats.style.Styler.to_excel</span></code></dt><dd><p>Add styles to Excel sheet.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For compatibility with <a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="apache_beam.dataframe.frames.DeferredDataFrame.to_csv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_csv()</span></code></a>,
to_excel serializes lists and dicts to strings before writing.</p>
<p>Once a workbook has been saved it is not possible to write further
data without rewriting the whole workbook.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Create, write to and save a workbook:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;row 1&#39;</span><span class="p">,</span> <span class="s1">&#39;row 2&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;col 1&#39;</span><span class="p">,</span> <span class="s1">&#39;col 2&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;output.xlsx&quot;</span><span class="p">)</span>  

<span class="go">To specify the sheet name:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s2">&quot;output.xlsx&quot;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_1&#39;</span><span class="p">)</span>  

<span class="go">If you wish to write to more than one sheet in the workbook, it is</span>
<span class="go">necessary to specify an ExcelWriter object:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>  
<span class="gp">... </span>    <span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_1&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_2&#39;</span><span class="p">)</span>

<span class="go">ExcelWriter can also be used to append to an existing Excel file:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>  
<span class="gp">... </span>    <span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet_name_3&#39;</span><span class="p">)</span>

<span class="go">To set the library that is used to write the Excel file,</span>
<span class="go">you can pass the `engine` keyword (the default engine is</span>
<span class="go">automatically chosen depending on the file extension):</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;output1.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_feather">
<span class="sig-name descname"><span class="pre">to_feather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_feather" title="Link to this definition">¶</a></dt>
<dd><p>Write a DataFrame to the binary Feather format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em>) – String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function. If a string or a path,
it will be used as Root Directory path when writing a partitioned dataset.</p></li>
<li><p><strong>**kwargs</strong> – Additional keywords passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.feather.write_feather()</span></code>.
This includes the <cite>compression</cite>, <cite>compression_level</cite>, <cite>chunksize</cite>
and <cite>version</cite> keywords.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<p class="rubric">Notes</p>
<p>This function writes the dataframe as a <a class="reference external" href="https://arrow.apache.org/docs/python/feather.html">feather file</a>. Requires a default
index. For saving the DeferredDataFrame with your custom index use a method that
supports custom indices e.g. <cite>to_parquet</cite>.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_feather</span><span class="p">(</span><span class="s2">&quot;file.feather&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_gbq">
<span class="sig-name descname"><span class="pre">to_gbq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_gbq" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_gbq()</span></code> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_gbq’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_hdf">
<span class="sig-name descname"><span class="pre">to_hdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_hdf" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_hdf.html#pandas.DataFrame.to_hdf" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_hdf()</span></code></a> is not yet supported in the Beam DataFrame API because HDF5 is a random access file format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_html">
<span class="sig-name descname"><span class="pre">to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_html" title="Link to this definition">¶</a></dt>
<dd><p>Render a DataFrame as an HTML table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em> or </em><em>StringIO-like</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – Buffer to write to. If None, the output is returned as a string.</p></li>
<li><p><strong>columns</strong> (<em>array-like</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – The subset of columns to write. Writes all columns by default.</p></li>
<li><p><strong>col_space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The minimum width of each column in CSS length units.  An int is assumed to be px units..</p></li>
<li><p><strong>header</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print column labels, default True.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Whether to print index (row) labels.</p></li>
<li><p><strong>na_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default 'NaN'</em>) – String representation of <code class="docutils literal notranslate"><span class="pre">NaN</span></code> to use.</p></li>
<li><p><strong>formatters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>one-param. functions</em><em>, </em><em>optional</em>) – Formatter functions to apply to columns’ elements by position or
name.
The result of each function must be a unicode string.
List/tuple must be of length equal to the number of columns.</p></li>
<li><p><strong>float_format</strong> (<em>one-parameter function</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – <p>Formatter function to apply to columns’ elements if they are
floats. This function must return a unicode string and will be
applied only to the non-<code class="docutils literal notranslate"><span class="pre">NaN</span></code> elements, with <code class="docutils literal notranslate"><span class="pre">NaN</span></code> being
handled by <code class="docutils literal notranslate"><span class="pre">na_rep</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>sparsify</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Set to False for a DeferredDataFrame with a hierarchical index to print
every multiindex key at each row.</p></li>
<li><p><strong>index_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default True</em>) – Prints the names of the indexes.</p></li>
<li><p><strong>justify</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default None</em>) – <p>How to justify the column labels. If None uses the option from
the print configuration (controlled by set_option), ‘right’ out
of the box. Valid values are</p>
<ul>
<li><p>left</p></li>
<li><p>right</p></li>
<li><p>center</p></li>
<li><p>justify</p></li>
<li><p>justify-all</p></li>
<li><p>start</p></li>
<li><p>end</p></li>
<li><p>inherit</p></li>
<li><p>match-parent</p></li>
<li><p>initial</p></li>
<li><p>unset.</p></li>
</ul>
</p></li>
<li><p><strong>max_rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of rows to display in the console.</p></li>
<li><p><strong>max_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of columns to display in the console.</p></li>
<li><p><strong>show_dimensions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Display DeferredDataFrame dimensions (number of rows by number of columns).</p></li>
<li><p><strong>decimal</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default '.'</em>) – Character recognized as decimal separator, e.g. ‘,’ in Europe.</p></li>
<li><p><strong>bold_rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Make the row labels bold in the output.</p></li>
<li><p><strong>classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>, </em><em>default None</em>) – CSS class(es) to apply to the resulting html table.</p></li>
<li><p><strong>escape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Convert the characters &lt;, &gt;, and &amp; to HTML-safe sequences.</p></li>
<li><p><strong>notebook</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>default False</em>) – Whether the generated HTML is for IPython Notebook.</p></li>
<li><p><strong>border</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – A <code class="docutils literal notranslate"><span class="pre">border=border</span></code> attribute is included in the opening
<cite>&lt;table&gt;</cite> tag. Default <code class="docutils literal notranslate"><span class="pre">pd.options.display.html.border</span></code>.</p></li>
<li><p><strong>table_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A css id is included in the opening <cite>&lt;table&gt;</cite> tag if specified.</p></li>
<li><p><strong>render_links</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – Convert URLs to HTML links.</p></li>
<li><p><strong>encoding</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default &quot;utf-8&quot;</em>) – Set character encoding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If buf is None, returns the result as a string. Otherwise returns
None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> or None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_string" title="apache_beam.dataframe.frames.DeferredDataFrame.to_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_string</span></code></a></dt><dd><p>Convert DeferredDataFrame to a string.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">html_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;thead&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr style=&quot;text-align: right;&quot;&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;col1&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;col2&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;/thead&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;tbody&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;0&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;1&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;4&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;tr&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;th&gt;1&lt;/th&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;2&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">      &lt;td&gt;3&lt;/td&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/tr&gt;</span>
<span class="gp">... </span><span class="s1">  &lt;/tbody&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/table&gt;&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">html_string</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_json" title="Link to this definition">¶</a></dt>
<dd><p>Convert the object to a JSON string.</p>
<p>Note NaN’s and None will be converted to null and datetime objects
will be converted to UNIX timestamps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_or_buf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – String, path object (implementing os.PathLike[str]), or file-like
object implementing a write() function. If None, the result is
returned as a string.</p></li>
<li><p><strong>orient</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Indication of expected JSON string format.</p>
<ul>
<li><p>DeferredSeries:</p>
<blockquote>
<div><ul class="simple">
<li><p>default is ‘index’</p></li>
<li><p>allowed values are: {‘split’, ‘records’, ‘index’, ‘table’}.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>DeferredDataFrame:</p>
<blockquote>
<div><ul class="simple">
<li><p>default is ‘columns’</p></li>
<li><p>allowed values are: {‘split’, ‘records’, ‘index’, ‘columns’,
‘values’, ‘table’}.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The format of the JSON string:</p>
<blockquote>
<div><ul class="simple">
<li><p>’split’ : dict like {‘index’ -&gt; [index], ‘columns’ -&gt; [columns],
‘data’ -&gt; [values]}</p></li>
<li><p>’records’ : list like [{column -&gt; value}, … , {column -&gt; value}]</p></li>
<li><p>’index’ : dict like {index -&gt; {column -&gt; value}}</p></li>
<li><p>’columns’ : dict like {column -&gt; {index -&gt; value}}</p></li>
<li><p>’values’ : just the values array</p></li>
<li><p>’table’ : dict like {‘schema’: {schema}, ‘data’: {data}}</p></li>
</ul>
<p>Describing the data, where data component is like <code class="docutils literal notranslate"><span class="pre">orient='records'</span></code>.</p>
</div></blockquote>
</li>
</ul>
</p></li>
<li><p><strong>date_format</strong> (<em>{None</em><em>, </em><em>'epoch'</em><em>, </em><em>'iso'}</em>) – Type of date conversion. ‘epoch’ = epoch milliseconds,
‘iso’ = ISO8601. The default depends on the <cite>orient</cite>. For
<code class="docutils literal notranslate"><span class="pre">orient='table'</span></code>, the default is ‘iso’. For all other orients,
the default is ‘epoch’.</p></li>
<li><p><strong>double_precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default 10</em>) – The number of decimal places to use when encoding
floating point values. The possible maximal value is 15.
Passing double_precision greater than 15 will raise a ValueError.</p></li>
<li><p><strong>force_ascii</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default True</em>) – Force encoded string to be ASCII.</p></li>
<li><p><strong>date_unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'ms'</em><em> (</em><em>milliseconds</em><em>)</em>) – The time unit to encode to, governs timestamp and ISO8601
precision.  One of ‘s’, ‘ms’, ‘us’, ‘ns’ for second, millisecond,
microsecond, and nanosecond respectively.</p></li>
<li><p><strong>default_handler</strong> (<em>callable</em><em>, </em><em>default None</em>) – Handler to call if object cannot otherwise be converted to a
suitable format for JSON. Should receive a single argument which is
the object to convert and return a serialisable object.</p></li>
<li><p><strong>lines</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default False</em>) – If ‘orient’ is ‘records’ write out line-delimited json format. Will
throw ValueError if incorrect ‘orient’ since others are not
list-like.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path_or_buf’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>Zstandard support.</p>
</div>
</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – The index is only used when ‘orient’ is ‘split’, ‘index’, ‘column’,
or ‘table’. Of these, ‘index’ and ‘column’ do not support
<cite>index=False</cite>.</p></li>
<li><p><strong>indent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Length of whitespace used to indent each record.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default 'w'</em><em> (</em><em>writing</em><em>)</em>) – Specify the IO mode for output when supplying a path_or_buf.
Accepted args are ‘w’ (writing) and ‘a’ (append) only.
mode=’a’ is only supported when lines is True and orient is ‘records’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If path_or_buf is None, returns the resulting json format as a
string. Otherwise returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_json</span></code></dt><dd><p>Convert a JSON string to pandas object.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The behavior of <code class="docutils literal notranslate"><span class="pre">indent=0</span></code> varies from the stdlib, which does not
indent the output but does insert newlines. Currently, <code class="docutils literal notranslate"><span class="pre">indent=0</span></code>
and the default <code class="docutils literal notranslate"><span class="pre">indent=None</span></code> are equivalent in pandas, though this
may change in a future release.</p>
<p><code class="docutils literal notranslate"><span class="pre">orient='table'</span></code> contains a ‘pandas_version’ field under ‘schema’.
This stores the version of <cite>pandas</cite> used in the latest revision of the
schema.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">loads</span><span class="p">,</span> <span class="n">dumps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;row 1&quot;</span><span class="p">,</span> <span class="s2">&quot;row 2&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col 1&quot;</span><span class="p">,</span> <span class="s2">&quot;col 2&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;split&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;columns&quot;: [</span>
<span class="go">        &quot;col 1&quot;,</span>
<span class="go">        &quot;col 2&quot;</span>
<span class="go">    ],</span>
<span class="go">    &quot;index&quot;: [</span>
<span class="go">        &quot;row 1&quot;,</span>
<span class="go">        &quot;row 2&quot;</span>
<span class="go">    ],</span>
<span class="go">    &quot;data&quot;: [</span>
<span class="go">        [</span>
<span class="go">            &quot;a&quot;,</span>
<span class="go">            &quot;b&quot;</span>
<span class="go">        ],</span>
<span class="go">        [</span>
<span class="go">            &quot;c&quot;,</span>
<span class="go">            &quot;d&quot;</span>
<span class="go">        ]</span>
<span class="go">    ]</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;records&#39;`` formatted JSON.</span>
<span class="go">Note that index labels are not preserved with this encoding.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">]</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;index&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;row 1&quot;: {</span>
<span class="go">        &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;row 2&quot;: {</span>
<span class="go">        &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">        &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;columns&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;col 1&quot;: {</span>
<span class="go">        &quot;row 1&quot;: &quot;a&quot;,</span>
<span class="go">        &quot;row 2&quot;: &quot;c&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;col 2&quot;: {</span>
<span class="go">        &quot;row 1&quot;: &quot;b&quot;,</span>
<span class="go">        &quot;row 2&quot;: &quot;d&quot;</span>
<span class="go">    }</span>
<span class="go">}</span>

<span class="go">Encoding/decoding a Dataframe using ``&#39;values&#39;`` formatted JSON:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;values&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">[</span>
<span class="go">    [</span>
<span class="go">        &quot;a&quot;,</span>
<span class="go">        &quot;b&quot;</span>
<span class="go">    ],</span>
<span class="go">    [</span>
<span class="go">        &quot;c&quot;,</span>
<span class="go">        &quot;d&quot;</span>
<span class="go">    ]</span>
<span class="go">]</span>

<span class="go">Encoding with Table Schema:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;table&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parsed</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dumps</span><span class="p">(</span><span class="n">parsed</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  
<span class="go">{</span>
<span class="go">    &quot;schema&quot;: {</span>
<span class="go">        &quot;fields&quot;: [</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;index&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            },</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;col 1&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            },</span>
<span class="go">            {</span>
<span class="go">                &quot;name&quot;: &quot;col 2&quot;,</span>
<span class="go">                &quot;type&quot;: &quot;string&quot;</span>
<span class="go">            }</span>
<span class="go">        ],</span>
<span class="go">        &quot;primaryKey&quot;: [</span>
<span class="go">            &quot;index&quot;</span>
<span class="go">        ],</span>
<span class="go">        &quot;pandas_version&quot;: &quot;1.4.0&quot;</span>
<span class="go">    },</span>
<span class="go">    &quot;data&quot;: [</span>
<span class="go">        {</span>
<span class="go">            &quot;index&quot;: &quot;row 1&quot;,</span>
<span class="go">            &quot;col 1&quot;: &quot;a&quot;,</span>
<span class="go">            &quot;col 2&quot;: &quot;b&quot;</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &quot;index&quot;: &quot;row 2&quot;,</span>
<span class="go">            &quot;col 1&quot;: &quot;c&quot;,</span>
<span class="go">            &quot;col 2&quot;: &quot;d&quot;</span>
<span class="go">        }</span>
<span class="go">    ]</span>
<span class="go">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_latex">
<span class="sig-name descname"><span class="pre">to_latex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_latex" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_latex.html#pandas.DataFrame.to_latex" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_latex()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_latex’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_markdown">
<span class="sig-name descname"><span class="pre">to_markdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_markdown" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_markdown.html#pandas.DataFrame.to_markdown" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_markdown()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_markdown’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_msgpack">
<span class="sig-name descname"><span class="pre">to_msgpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_msgpack" title="Link to this definition">¶</a></dt>
<dd><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_msgpack()</span></code> is not yet supported in the Beam DataFrame API because it is deprecated in pandas.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_orc">
<span class="sig-name descname"><span class="pre">to_orc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_orc" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_orc.html#pandas.DataFrame.to_orc" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_orc()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_orc’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_parquet">
<span class="sig-name descname"><span class="pre">to_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Write a DataFrame to the binary parquet format.</p>
<p>This function writes the dataframe as a <a class="reference external" href="https://parquet.apache.org/">parquet file</a>. You can choose different parquet
backends, and have the option of compression. See
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/io.html#io-parquet" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">the user guide</span></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, </em><em>file-like object</em><em>, or </em><em>None</em><em>, </em><em>default None</em>) – <p>String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function. If None, the result is
returned as bytes. If a string or path, it will be used as Root Directory
path when writing a partitioned dataset.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2.0.</span></p>
</div>
<p>Previously this was “fname”</p>
</p></li>
<li><p><strong>engine</strong> (<em>{'auto'</em><em>, </em><em>'pyarrow'</em><em>, </em><em>'fastparquet'}</em><em>, </em><em>default 'auto'</em>) – Parquet library to use. If ‘auto’, then the option
<code class="docutils literal notranslate"><span class="pre">io.parquet.engine</span></code> is used. The default <code class="docutils literal notranslate"><span class="pre">io.parquet.engine</span></code>
behavior is to try ‘pyarrow’, falling back to ‘fastparquet’ if
‘pyarrow’ is unavailable.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><em>None</em><em>, </em><em>default 'snappy'</em>) – Name of the compression to use. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Supported options: ‘snappy’, ‘gzip’, ‘brotli’, ‘lz4’, ‘zstd’.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>default None</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, include the dataframe’s index(es) in the file output.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, they will not be written to the file.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, similar to <code class="docutils literal notranslate"><span class="pre">True</span></code> the dataframe’s index(es)
will be saved. However, instead of being saved as values,
the RangeIndex will be stored as a range in the metadata so it
doesn’t require much space and is faster. Other indexes will
be included as columns in the file output.</p></li>
<li><p><strong>partition_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em><em>, </em><em>default None</em>) – Column names by which to partition the dataset.
Columns are partitioned in the order they are given.
Must be None if path is not a string.</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments passed to the parquet library. See
<a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/user_guide/io.html#io-parquet" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><span class="xref std std-ref">pandas io</span></a> for more details.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes if no path argument is provided else None</p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_parquet</span></code></dt><dd><p>Read a parquet file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_orc" title="apache_beam.dataframe.frames.DeferredDataFrame.to_orc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_orc</span></code></a></dt><dd><p>Write an orc file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_csv" title="apache_beam.dataframe.frames.DeferredDataFrame.to_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_csv</span></code></a></dt><dd><p>Write a csv file.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_sql" title="apache_beam.dataframe.frames.DeferredDataFrame.to_sql"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_sql</span></code></a></dt><dd><p>Write to a sql table.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_hdf" title="apache_beam.dataframe.frames.DeferredDataFrame.to_hdf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.to_hdf</span></code></a></dt><dd><p>Write to hdf.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function requires either the <a class="reference external" href="https://pypi.org/project/fastparquet">fastparquet</a> or <a class="reference external" href="https://arrow.apache.org/docs/python/">pyarrow</a> library.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;col1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;df.parquet.gzip&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;df.parquet.gzip&#39;</span><span class="p">)</span>  
<span class="go">   col1  col2</span>
<span class="go">0     1     3</span>
<span class="go">1     2     4</span>

<span class="go">If you want to get a buffer to the parquet content you can use a io.BytesIO</span>
<span class="go">object, as long as you don&#39;t use partition_cols, which creates multiple files.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">io</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_period">
<span class="sig-name descname"><span class="pre">to_period</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_period" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_period.html#pandas.DataFrame.to_period" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_period()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_period’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_pickle">
<span class="sig-name descname"><span class="pre">to_pickle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_pickle" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_pickle.html#pandas.DataFrame.to_pickle" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_pickle()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_pickle’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_sql">
<span class="sig-name descname"><span class="pre">to_sql</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_sql" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_sql.html#pandas.DataFrame.to_sql" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_sql()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_sql’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_stata">
<span class="sig-name descname"><span class="pre">to_stata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_stata" title="Link to this definition">¶</a></dt>
<dd><p>Export DataFrame object to Stata dta format.</p>
<p>Writes the DataFrame to a Stata dataset file.
“dta” files contain a Stata dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>path object</em><em>, or </em><em>buffer</em>) – String, path object (implementing <code class="docutils literal notranslate"><span class="pre">os.PathLike[str]</span></code>), or file-like
object implementing a binary <code class="docutils literal notranslate"><span class="pre">write()</span></code> function.</p></li>
<li><p><strong>convert_dates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary mapping columns containing datetime types to stata
internal format to use when writing the dates. Options are ‘tc’,
‘td’, ‘tm’, ‘tw’, ‘th’, ‘tq’, ‘ty’. Column can be either an integer
or a name. Datetime columns that do not have a conversion type
specified will be converted to ‘tc’. Raises NotImplementedError if
a datetime column has timezone information.</p></li>
<li><p><strong>write_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Write the index to Stata dataset.</p></li>
<li><p><strong>byteorder</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Can be “&gt;”, “&lt;”, “little”, or “big”. default is <cite>sys.byteorder</cite>.</p></li>
<li><p><strong>time_stamp</strong> (<em>datetime</em>) – A datetime to use as file creation date.  Default is the current
time.</p></li>
<li><p><strong>data_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A label for the data set.  Must be 80 characters or smaller.</p></li>
<li><p><strong>variable_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – Dictionary containing columns as keys and variable labels as
values. Each label must be 80 characters or smaller.</p></li>
<li><p><strong>version</strong> (<em>{114</em><em>, </em><em>117</em><em>, </em><em>118</em><em>, </em><em>119</em><em>, </em><em>None}</em><em>, </em><em>default 114</em>) – <p>Version to use in the output dta file. Set to None to let pandas
decide between 118 or 119 formats depending on the number of
columns in the frame. pandas Version 114 can be read by Stata 10 and
later. pandas Version 117 can be read by Stata 13 or later. pandas Version 118
is supported in Stata 14 and later. pandas Version 119 is supported in
Stata 15 and later. pandas Version 114 limits string variables to 244
characters or fewer while versions 117 and later allow strings
with lengths up to 2,000,000 characters. Versions 118 and 119
support Unicode characters, and pandas version 119 supports more than
32,767 variables.</p>
<p>pandas Version 119 should usually only be used when the number of
variables exceeds the capacity of dta format 118. Exporting
smaller datasets in format 119 may have unintended consequences,
and, as of November 2020, Stata SE cannot read pandas version 119 files.</p>
</p></li>
<li><p><strong>convert_strl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>, </em><em>optional</em>) – List of column names to convert to string columns to Stata StrL
format. Only available if version is 117.  Storing strings in the
StrL format can produce smaller dta files if strings have more than
8 characters and values are repeated.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>default 'infer'</em>) – <p>For on-the-fly compression of the output data. If ‘infer’ and ‘path’ is
path-like, then detect compression from the following extensions: ‘.gz’,
‘.bz2’, ‘.zip’, ‘.xz’, ‘.zst’, ‘.tar’, ‘.tar.gz’, ‘.tar.xz’ or ‘.tar.bz2’
(otherwise no compression).
Set to <code class="docutils literal notranslate"><span class="pre">None</span></code> for no compression.
Can also be a dict with key <code class="docutils literal notranslate"><span class="pre">'method'</span></code> set
to one of {<code class="docutils literal notranslate"><span class="pre">'zip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'gzip'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bz2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'zstd'</span></code>, <code class="docutils literal notranslate"><span class="pre">'xz'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tar'</span></code>} and
other key-value pairs are forwarded to
<code class="docutils literal notranslate"><span class="pre">zipfile.ZipFile</span></code>, <code class="docutils literal notranslate"><span class="pre">gzip.GzipFile</span></code>,
<code class="docutils literal notranslate"><span class="pre">bz2.BZ2File</span></code>, <code class="docutils literal notranslate"><span class="pre">zstandard.ZstdCompressor</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma.LZMAFile</span></code> or
<code class="docutils literal notranslate"><span class="pre">tarfile.TarFile</span></code>, respectively.
As an example, the following could be passed for faster compression and to create
a reproducible gzip archive:
<code class="docutils literal notranslate"><span class="pre">compression={'method':</span> <span class="pre">'gzip',</span> <span class="pre">'compresslevel':</span> <span class="pre">1,</span> <span class="pre">'mtime':</span> <span class="pre">1}</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.5.0: </span>Added support for <cite>.tar</cite> files.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4.0: </span>Zstandard support.</p>
</div>
</p></li>
<li><p><strong>storage_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Extra options that make sense for a particular storage connection, e.g.
host, port, username, password, etc. For HTTP(S) URLs the key-value pairs
are forwarded to <code class="docutils literal notranslate"><span class="pre">urllib.request.Request</span></code> as header options. For other
URLs (e.g. starting with “s3://”, and “gcs://”) the key-value pairs are
forwarded to <code class="docutils literal notranslate"><span class="pre">fsspec.open</span></code>. Please see <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> and <code class="docutils literal notranslate"><span class="pre">urllib</span></code> for more
details, and for more examples on storage options refer <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/io.html?highlight=storage_options#reading-writing-remote-files">here</a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2.0.</span></p>
</div>
</p></li>
<li><p><strong>value_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> of </em><em>dicts</em>) – <p>Dictionary containing columns as keys and dictionaries of column value
to labels as values. Labels for a single variable must be 32,000
characters or smaller.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.4.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – <ul>
<li><p>If datetimes contain timezone information
    * Column dtype is not representable in Stata</p></li>
</ul>
</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – <ul>
<li><p>Columns listed in convert_dates are neither datetime64[ns]
      or datetime.datetime
    * Column listed in convert_dates is not in DeferredDataFrame
    * Categorical label contains more than 32,000 characters</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>This operation has no known divergences from the pandas API.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_stata</span></code></dt><dd><p>Import Stata data files.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.stata.StataWriter</span></code></dt><dd><p>Low-level writer for Stata data files.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.stata.StataWriter117</span></code></dt><dd><p>Low-level writer for pandas version 117 files.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;animal&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;falcon&#39;</span><span class="p">,</span> <span class="s1">&#39;parrot&#39;</span><span class="p">,</span> <span class="s1">&#39;falcon&#39;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="s1">&#39;parrot&#39;</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;speed&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">350</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">15</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">to_stata</span><span class="p">(</span><span class="s1">&#39;animals.dta&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_timestamp">
<span class="sig-name descname"><span class="pre">to_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_timestamp" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_timestamp.html#pandas.DataFrame.to_timestamp" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_timestamp()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_timestamp’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.to_xml">
<span class="sig-name descname"><span class="pre">to_xml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.to_xml" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.to_xml.html#pandas.DataFrame.to_xml" title="(in pandas v3.0.0.dev0+1579.g2a10e04a09)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.DataFrame.to_xml()</span></code></a> is not implemented yet in the Beam DataFrame API.</p>
<p>If support for ‘to_xml’ is important to you, please let the Beam community know by <a class="reference external" href="https://beam.apache.org/community/contact-us/">writing to user&#64;beam.apache.org</a> or commenting on <a class="reference external" href="https://github.com/apache/beam/issues/20318">20318</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="apache_beam.dataframe.frames.DeferredDataFrame.truediv">
<span class="sig-name descname"><span class="pre">truediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="Link to this definition">¶</a></dt>
<dd><p>Get Floating division of dataframe and other, element-wise (binary operator <cite>truediv</cite>).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">dataframe</span> <span class="pre">/</span> <span class="pre">other</span></code>, but with support to substitute a fill_value
for missing data in one of the inputs. With reverse version, <cite>rtruediv</cite>.</p>
<p>Among flexible wrappers (<cite>add</cite>, <cite>sub</cite>, <cite>mul</cite>, <cite>div</cite>, <cite>floordiv</cite>, <cite>mod</cite>, <cite>pow</cite>) to
arithmetic operators: <cite>+</cite>, <cite>-</cite>, <cite>*</cite>, <cite>/</cite>, <cite>//</cite>, <cite>%</cite>, <cite>**</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<em>scalar</em><em>, </em><em>sequence</em><em>, </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredSeries" title="apache_beam.dataframe.frames.DeferredSeries"><em>DeferredSeries</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em> or </em><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame"><em>DeferredDataFrame</em></a>) – Any single or multiple element data structure, or list-like object.</p></li>
<li><p><strong>axis</strong> (<em>{0</em><em> or </em><em>'index'</em><em>, </em><em>1</em><em> or </em><em>'columns'}</em>) – Whether to compare by the index (0 or ‘index’) or columns.
(1 or ‘columns’). For DeferredSeries input, axis to match DeferredSeries index on.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><em>label</em>) – Broadcast across a level, matching Index values on the
passed MultiIndex level.</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>None</em><em>, </em><em>default None</em>) – Fill existing missing (NaN) values, and any new element needed for
successful DeferredDataFrame alignment, with this value before computation.
If data in both corresponding DeferredDataFrame locations is missing
the result will be missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result of the arithmetic operation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame" title="apache_beam.dataframe.frames.DeferredDataFrame">DeferredDataFrame</a></p>
</dd>
</dl>
<p class="rubric">Differences from pandas</p>
<p>Only level=None is supported</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.add" title="apache_beam.dataframe.frames.DeferredDataFrame.add"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.add</span></code></a></dt><dd><p>Add DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.sub" title="apache_beam.dataframe.frames.DeferredDataFrame.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.sub</span></code></a></dt><dd><p>Subtract DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mul" title="apache_beam.dataframe.frames.DeferredDataFrame.mul"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mul</span></code></a></dt><dd><p>Multiply DeferredDataFrames.</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.div" title="apache_beam.dataframe.frames.DeferredDataFrame.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.div</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.truediv" title="apache_beam.dataframe.frames.DeferredDataFrame.truediv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.truediv</span></code></a></dt><dd><p>Divide DeferredDataFrames (float division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.floordiv" title="apache_beam.dataframe.frames.DeferredDataFrame.floordiv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.floordiv</span></code></a></dt><dd><p>Divide DeferredDataFrames (integer division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.mod" title="apache_beam.dataframe.frames.DeferredDataFrame.mod"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.mod</span></code></a></dt><dd><p>Calculate modulo (remainder after division).</p>
</dd>
<dt><a class="reference internal" href="#apache_beam.dataframe.frames.DeferredDataFrame.pow" title="apache_beam.dataframe.frames.DeferredDataFrame.pow"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeferredDataFrame.pow</span></code></a></dt><dd><p>Calculate exponential power.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Mismatched indices will be unioned together.</p>
<p class="rubric">Examples</p>
<p><strong>NOTE:</strong> These examples are pulled directly from the pandas documentation for convenience. Usage of the Beam DataFrame API will look different because it is a deferred API. In addition, some arguments shown here may not be supported, see <strong>‘Differences from pandas’</strong> for details.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">]},</span>
<span class="gp">... </span>                  <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      360</span>
<span class="go">triangle        3      180</span>
<span class="go">rectangle       4      360</span>

<span class="go">Add a scalar with operator version which return the same</span>
<span class="go">results.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          1      361</span>
<span class="go">triangle        4      181</span>
<span class="go">rectangle       5      361</span>

<span class="go">Divide by constant with reverse version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle        0.0     36.0</span>
<span class="go">triangle      0.3     18.0</span>
<span class="go">rectangle     0.4     36.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">             angles   degrees</span>
<span class="go">circle          inf  0.027778</span>
<span class="go">triangle   3.333333  0.055556</span>
<span class="go">rectangle  2.500000  0.027778</span>

<span class="go">Subtract a list and Series by axis with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      358</span>
<span class="go">triangle        2      178</span>
<span class="go">rectangle       3      358</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">]),</span>
<span class="gp">... </span>       <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle         -1      359</span>
<span class="go">triangle        2      179</span>
<span class="go">rectangle       3      359</span>

<span class="go">Multiply a dictionary by axis.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0      720</span>
<span class="go">triangle         0      360</span>
<span class="go">rectangle        0      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">({</span><span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="go">            angles  degrees</span>
<span class="go">circle           0        0</span>
<span class="go">triangle         6      360</span>
<span class="go">rectangle       12     1080</span>

<span class="go">Multiply a DataFrame of different shape with operator version.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
<span class="gp">... </span>                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other</span>
<span class="go">           angles</span>
<span class="go">circle          0</span>
<span class="go">triangle        3</span>
<span class="go">rectangle       4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">*</span> <span class="n">other</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      NaN</span>
<span class="go">triangle        9      NaN</span>
<span class="go">rectangle      16      NaN</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">           angles  degrees</span>
<span class="go">circle          0      0.0</span>
<span class="go">triangle        9      0.0</span>
<span class="go">rectangle      16      0.0</span>

<span class="go">Divide by a MultiIndex by level.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="s1">&#39;degrees&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">360</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">540</span><span class="p">,</span> <span class="mi">720</span><span class="p">]},</span>
<span class="gp">... </span>                            <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="s1">&#39;rectangle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                    <span class="s1">&#39;square&#39;</span><span class="p">,</span> <span class="s1">&#39;pentagon&#39;</span><span class="p">,</span> <span class="s1">&#39;hexagon&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_multindex</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle          0      360</span>
<span class="go">  triangle        3      180</span>
<span class="go">  rectangle       4      360</span>
<span class="go">B square          4      360</span>
<span class="go">  pentagon        5      540</span>
<span class="go">  hexagon         6      720</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df_multindex</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">             angles  degrees</span>
<span class="go">A circle        NaN      1.0</span>
<span class="go">  triangle      1.0      1.0</span>
<span class="go">  rectangle     1.0      1.0</span>
<span class="go">B square        0.0      0.0</span>
<span class="go">  pentagon      0.0      0.0</span>
<span class="go">  hexagon       0.0      0.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="apache_beam.dataframe.frame_base.html" class="btn btn-neutral float-left" title="apache_beam.dataframe.frame_base module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="apache_beam.dataframe.io.html" class="btn btn-neutral float-right" title="apache_beam.dataframe.io module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>